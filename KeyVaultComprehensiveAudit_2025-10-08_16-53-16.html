<!DOCTYPE html>
<html>
<head>
    <title>Azure Key Vault Enhanced Security & Compliance Audit</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 20px; background-color: #f5f5f5; }
.header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
.test-mode-banner { background: #dc3545; color: white; padding: 15px; text-align: center; font-weight: bold; font-size: 1.4em; border-radius: 8px; margin: 20px 0; animation: bloom 2s infinite; }
.partial-results-banner { background: #e67e22; color: white; padding: 12px; text-align: center; font-weight: 600; font-size: 1.1em; border-radius: 6px; margin: 15px 0; border-left: 4px solid #d35400; opacity: 0.95; }
.summary { background: white; padding: 15px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
.compliant { color: #28a745; font-weight: bold; }
.non-compliant { color: #dc3545; font-weight: bold; }
.partially-compliant { color: #ffc107; font-weight: bold; }
.stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 15px 0; }
.stat-card { background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); text-align: center; position: relative; }
.stat-card:hover { transform: translateY(-2px); transition: transform 0.3s ease; }
.stat-number { font-size: 2em; font-weight: bold; color: #667eea; }
.stat-label { color: #666; margin-top: 5px; }
.stat-percentage { font-size: 0.9em; margin-top: 3px; font-weight: bold; }
.progress-bar { width: 100%; height: 8px; background: #e9ecef; border-radius: 4px; overflow: hidden; margin-top: 8px; }
.progress-fill { height: 100%; transition: width 0.8s ease; border-radius: 4px; }
.dual-framework { display: flex; gap: 10px; margin-top: 10px; }
.framework-score { flex: 1; padding: 8px; border-radius: 6px; text-align: center; font-size: 0.85em; }
.microsoft-framework { background: #e7f3ff; border: 1px solid #b8daff; }
.company-framework { background: #fff3cd; border: 1px solid #ffeaa7; }
table { width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin: 20px 0; font-size: 0.8em; }
th { background: #343a40; color: white; padding: 6px; text-align: left; font-weight: 600; cursor: pointer; position: sticky; top: 0; z-index: 10; font-size: 0.8em; }
td { padding: 4px; border-bottom: 1px solid #dee2e6; max-width: 120px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; font-size: 0.8em; }
tr:nth-child(even) { background-color: #f8f9fa; }
tr:hover { background-color: #e9ecef; }
.recommendations { background: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; border-radius: 8px; margin-top: 20px; }
.filter-input { width: 90%; padding: 3px; margin-bottom: 3px; border: 1px solid #ccc; border-radius: 4px; font-size: 0.75em; }
.identity-section { background: #e7f3ff; border: 1px solid #b8daff; padding: 15px; border-radius: 8px; margin: 20px 0; }
.security-section { background: #d4edda; border: 1px solid #c3e6cb; padding: 15px; border-radius: 8px; margin: 20px 0; }
.secrets-section { background: #fff3cd; border: 1px solid #ffeeba; padding: 15px; border-radius: 8px; margin: 20px 0; }
.quick-wins-section { background: #f8f9ff; border: 1px solid #e6e6ff; padding: 15px; border-radius: 8px; margin: 20px 0; }
.configuration-coverage-section { background: #f0f8ff; border: 1px solid #b8daff; padding: 15px; border-radius: 8px; margin: 20px 0; }
.compliance-legend-section { background: #f8f0ff; border: 1px solid #e6d7ff; padding: 15px; border-radius: 8px; margin: 20px 0; }
.action-link { color: #007bff; cursor: pointer; text-decoration: underline; font-size: 0.8em; }
.action-details { display: none; background: #f8f9fa; border: 1px solid #dee2e6; padding: 8px; margin-top: 3px; border-radius: 4px; font-size: 0.75em; }
.legend-section { background: #e9ecef; border: 1px solid #dee2e6; padding: 15px; border-radius: 8px; margin: 20px 0; }
.tooltip { position: relative; display: inline-block; cursor: help; color: #007bff; font-weight: bold; }
.tooltip .tooltiptext { visibility: hidden; width: 300px; background-color: #333; color: #fff; text-align: left; padding: 8px; border-radius: 6px; position: absolute; z-index: 1; bottom: 125%; left: 50%; margin-left: -150px; font-size: 0.8em; box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
.tooltip:hover .tooltiptext { visibility: visible; }
.enhancement-badge { display: inline-block; padding: 2px 8px; background: #667eea; color: white; border-radius: 12px; font-size: 0.7em; margin-left: 8px; }
.collapsible-toggle { cursor: pointer; padding: 5px 10px; background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 4px; font-size: 0.8em; margin-left: 10px; transition: all 0.3s ease; }
.collapsible-toggle:hover { background: #e9ecef; }
.collapsible-content { margin-top: 10px; }
@keyframes bloom { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }
@keyframes progressAnimation { from { width: 0%; } }

/* Enhanced Identity & Access Management Styles */
.identity-overview { margin: 20px 0; }
.pattern-analysis { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin: 20px 0; }
.pattern-card { background: white; border: 1px solid #b8daff; border-radius: 8px; padding: 15px; }
.pattern-card h4 { margin-top: 0; color: #0066cc; }
.pattern-content .metric { font-size: 1.5em; font-weight: bold; color: #667eea; margin-bottom: 5px; }
.pattern-content .description { color: #666; margin-bottom: 10px; }
.risk-indicator { padding: 5px 10px; border-radius: 15px; font-size: 0.9em; font-weight: bold; }
.risk-indicator.high-risk { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
.risk-indicator.medium-risk { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
.risk-indicator.low-risk { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }

/* RBAC Analysis Styles */
.rbac-analysis { margin: 25px 0; }
.rbac-comparison { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0; }
.rbac-card, .access-policy-card { background: white; border-radius: 8px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
.rbac-card { border-left: 4px solid #28a745; }
.access-policy-card { border-left: 4px solid #ffc107; }
.rbac-metric, .policy-metric { display: flex; justify-content: space-between; margin: 8px 0; padding: 5px 0; border-bottom: 1px solid #eee; }
.metric-label { font-weight: 600; }
.metric-value { color: #667eea; font-weight: bold; }
.rbac-benefits ul, .policy-limitations ul { margin: 10px 0; padding-left: 20px; }
.rbac-benefits li { color: #28a745; margin: 5px 0; }
.policy-limitations li { color: #856404; margin: 5px 0; }
.migration-recommendation { margin-top: 20px; }
.recommendation.urgent { background: #f8d7da; border: 1px solid #f5c6cb; border-radius: 8px; padding: 15px; }
.recommendation.moderate { background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 8px; padding: 15px; }
.recommendation.good { background: #d4edda; border: 1px solid #c3e6cb; border-radius: 8px; padding: 15px; }
.migration-steps ol { margin: 10px 0; padding-left: 20px; }

/* Identity Recommendations Styles */
.identity-recommendations { margin: 25px 0; }
.recommendations-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin: 20px 0; }
.recommendation-card { background: white; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); border-left: 4px solid #667eea; }
.recommendation-icon { font-size: 2em; text-align: center; margin-bottom: 10px; }
.recommendation-card h4 { margin: 10px 0; color: #333; }
.implementation-tip { background: #f8f9fa; border-radius: 4px; padding: 8px; margin-top: 10px; font-size: 0.9em; }

/* Secrets Management Styles */
.secrets-overview { margin: 20px 0; }
.secrets-stats { margin: 15px 0; }
.secrets-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
.secret-type-card { background: white; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); display: flex; align-items: center; }
.secret-icon { font-size: 2.5em; margin-right: 15px; }
.secret-count { font-size: 1.8em; font-weight: bold; color: #667eea; }
.secret-label { font-weight: 600; color: #333; margin: 5px 0; }
.secret-description { font-size: 0.9em; color: #666; }

/* Best Practices Styles */
.best-practices { margin: 25px 0; }
.practices-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0; }
.practice-card { background: white; border-radius: 8px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
.practice-header { display: flex; align-items: center; margin-bottom: 15px; }
.practice-icon { font-size: 2em; margin-right: 15px; }
.practice-header h4 { margin: 0; color: #333; }
.practice-description { margin-bottom: 15px; color: #666; font-size: 0.95em; }
.practice-recommendations h5 { margin: 10px 0 5px 0; color: #667eea; }
.practice-recommendations ul { margin: 0; padding-left: 20px; }
.practice-recommendations li { margin: 5px 0; }

/* Integration Patterns Styles */
.integration-patterns { margin: 25px 0; }
.patterns-showcase { margin: 20px 0; }
.pattern-showcase { background: white; border-radius: 8px; padding: 20px; margin: 15px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
.pattern-title { display: flex; align-items: center; margin-bottom: 15px; }
.pattern-icon { font-size: 2em; margin-right: 15px; }
.pattern-title h4 { margin: 0; color: #333; }
.pattern-examples h5 { margin: 10px 0 5px 0; color: #667eea; }
.pattern-examples ul { margin: 0; padding-left: 20px; }
.pattern-examples li { margin: 5px 0; }

/* Comprehensive Security Enhancement Styles */
.security-priority-section { margin: 30px 0; }
.security-recommendations-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin: 20px 0; }
.security-recommendation { background: white; border-radius: 8px; padding: 20px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
.security-recommendation.urgent { border-left: 6px solid #dc3545; }
.security-recommendation.moderate { border-left: 6px solid #ffc107; }
.recommendation-header { display: flex; align-items: center; margin-bottom: 15px; }
.priority-badge { padding: 4px 12px; border-radius: 12px; font-size: 0.8em; font-weight: bold; margin-right: 15px; }
.priority-badge.critical { background: #dc3545; color: white; }
.priority-badge.medium { background: #ffc107; color: #212529; }
.priority-badge.strategic { background: #6f42c1; color: white; }
.recommendation-header h4 { margin: 0; color: #333; }
.current-status { background: #f8f9fa; border-radius: 4px; padding: 10px; margin: 10px 0; }
.risk-impact { background: #fff3cd; border-radius: 4px; padding: 10px; margin: 10px 0; border-left: 4px solid #ffc107; }
.implementation-steps, .network-hardening-steps, .migration-strategy { margin: 15px 0; }
.implementation-steps h5, .network-hardening-steps h5, .migration-strategy h5 { margin: 10px 0 5px 0; color: #667eea; }
.implementation-steps ol, .network-hardening-steps ol, .migration-strategy ol { margin: 5px 0; padding-left: 20px; }
.implementation-steps li, .network-hardening-steps li, .migration-strategy li { margin: 5px 0; }
.compliance-note, .zero-trust-alignment { background: #d4edda; border-radius: 4px; padding: 8px; margin: 10px 0; border-left: 4px solid #28a745; font-size: 0.9em; }

/* Comparison Table Styles */
.comparison-table { margin: 15px 0; }
.comparison-row { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; padding: 8px; border-bottom: 1px solid #eee; }
.comparison-row:first-child { font-weight: bold; background: #f8f9fa; }
.feature { font-weight: 600; }
.rbac-value { color: #28a745; }
.policy-value { color: #856404; }

/* Strategic Recommendations Styles */
.strategic-recommendations { margin: 20px 0; }
.strategic-recommendation { background: white; border-radius: 8px; padding: 25px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border-left: 6px solid #6f42c1; }
.architecture-vision { margin: 20px 0; }
.architecture-components { margin: 15px 0; }
.architecture-layer { background: #f8f9fa; border-radius: 6px; padding: 15px; margin: 10px 0; border-left: 3px solid #667eea; }
.architecture-layer h6 { margin: 0 0 10px 0; color: #667eea; }
.architecture-layer ul { margin: 5px 0; padding-left: 20px; }
.implementation-roadmap { margin: 20px 0; }
.roadmap-timeline { margin: 15px 0; }
.roadmap-phase { background: #fff; border: 1px solid #dee2e6; border-radius: 6px; padding: 15px; margin: 10px 0; }
.phase-title { font-weight: bold; color: #6f42c1; margin-bottom: 10px; }

/* Security Metrics Styles */
.security-metrics-section { margin: 30px 0; }
.metrics-dashboard { margin: 20px 0; }
.metrics-category { background: white; border-radius: 8px; padding: 20px; margin: 15px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
.metrics-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 15px 0; }
.metric-card { background: #f8f9fa; border-radius: 6px; padding: 15px; text-align: center; border: 1px solid #dee2e6; }
.metric-name { font-size: 0.9em; color: #666; margin-bottom: 5px; }
.metric-value { font-size: 1.5em; font-weight: bold; color: #667eea; margin: 5px 0; }
.metric-target { font-size: 0.8em; color: #28a745; font-style: italic; }
.operational-metrics { margin: 15px 0; }
.metric-row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #eee; }
.metric-label { font-weight: 600; }

/* Governance Styles */
.governance-components { margin: 20px 0; }
.governance-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin: 15px 0; }
.governance-item { background: #f8f9fa; border-radius: 6px; padding: 15px; border-left: 3px solid #667eea; }
.governance-item h6 { margin: 0 0 10px 0; color: #667eea; }
.governance-item ul { margin: 5px 0; padding-left: 20px; }

/* Rotation Methods Styles */
.rotation-benefits, .rotation-implementation { margin: 15px 0; }
.rotation-methods { margin: 15px 0; }
.rotation-method { background: #f8f9fa; border-radius: 6px; padding: 12px; margin: 10px 0; border-left: 3px solid #667eea; }
.rotation-method h6 { margin: 0 0 8px 0; color: #667eea; }
.rotation-method code { background: #e9ecef; padding: 2px 6px; border-radius: 3px; font-size: 0.9em; }
.rotation-method ul { margin: 5px 0; padding-left: 20px; }

/* Section Descriptions */
.section-description { background: #f8f9fa; border-radius: 6px; padding: 15px; margin: 15px 0; border-left: 4px solid #667eea; }
.section-description p { margin: 0; color: #666; font-size: 0.95em; }

/* Access Analysis Styles */
.access-analysis { margin: 25px 0; }
.security-analysis { margin: 25px 0; }
.access-analysis h3, .security-analysis h3 { color: #333; margin-bottom: 15px; }
    </style>
    <script>
function filterTable(input, col) {
    var filter = input.value.toUpperCase();
    var table = document.getElementById("vaultTable");
    var trs = table.getElementsByTagName("tr");
    for (var i = 2; i < trs.length; i++) {
        var tds = trs[i].getElementsByTagName("td");
        if (tds.length > col) {
            var txt = tds[col].textContent || tds[col].innerText;
            trs[i].style.display = txt.toUpperCase().indexOf(filter) > -1 ? "" : "none";
        }
    }
}
    // Removed stray catch block from JavaScript

function sortTable(n) {
    var table = document.getElementById("vaultTable");
    var switching = true;
    var dir = "asc";
    var switchcount = 0;
    while (switching) {
        switching = false;
        var rows = table.rows;
        for (var i = 2; i < (rows.length - 1); i++) {
            var shouldSwitch = false;
            var x = rows[i].getElementsByTagName("TD")[n];
            var y = rows[i + 1].getElementsByTagName("TD")[n];
            if (dir == "asc") {
                if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                    shouldSwitch = true;
                    break;
                }
            } else if (dir == "desc") {
                if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
                    shouldSwitch = true;
                    break;
                }
            }
        }
        if (shouldSwitch) {
            rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
            switching = true;
            switchcount++;
        } else {
            if (switchcount == 0 && dir == "asc") {
                dir = "desc";
                switching = true;
            }
        }
    }
}

function toggleActionItems(id) {
    var element = document.getElementById(id);
    if (element.style.display === "none" || element.style.display === "") {
        element.style.display = "block";
    } else {
        element.style.display = "none";
    }
}

function toggleCollapsible(elementId) {
    var content = document.getElementById(elementId);
    var toggle = content.previousElementSibling.querySelector('.collapsible-toggle');
    
    if (content.style.display === "none" || content.style.display === "") {
        content.style.display = "block";
        toggle.textContent = "Hide Details";
        toggle.style.backgroundColor = "#007bff";
        toggle.style.color = "white";
    } else {
        content.style.display = "none";
        toggle.textContent = "Show Details";
        toggle.style.backgroundColor = "#f8f9fa";
        toggle.style.color = "#333";
    }
}
    </script>
</head>
<body>
    <div class="header">
        <h1>🔐 Azure Key Vault Enhanced Security & Compliance Audit</h1>
        <p><strong>Generated:</strong> 2025-10-08 16:55:56 UTC by curtus.regnier@intel.com</p>
        
        <p><strong>Script Version:</strong> 2.1 - Production Enterprise Edition</p>                
            </ul>
        </div>
        
        <div style="background: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; border-radius: 8px; margin-top: 15px;">
            <h4>🔄 Audit Resume Instructions:</h4>
            <p><strong>To complete the full organizational audit:</strong></p>
            <ol>
                <li><strong>Check for checkpoint files:</strong> Look for files matching <code>akv_audit_checkpoint_unknown_*.json</code> in your output directory</li>
                <li><strong>Resume from checkpoint:</strong> Run <code>Get-AKV_Roles&SecAuditCompliance.ps1 -Resume</code> and select the appropriate checkpoint</li>
                <li><strong>Alternative approach:</strong> Start a new complete audit with <code>Get-AKV_Roles&SecAuditCompliance.ps1</code> (full scan)</li>
                <li><strong>Test mode first:</strong> Use <code>Get-AKV_Roles&SecAuditCompliance.ps1 -TestMode</code> to validate setup before full scan</li>
            </ol>
            <p><strong>📝 Note:</strong> Resume functionality requires the original checkpoint files from the incomplete audit. If checkpoints are not available, a new full audit will be required.</p>
        </div>
        
        <div style="background: #f8d7da; border: 1px solid #f5c6cb; padding: 15px; border-radius: 8px; margin-top: 15px;">
            <h4>⚠️ Data Completeness Disclaimer:</h4>
            <p>This partial results report contains analysis for <strong>4 Key Vaults (100% of discovered infrastructure)</strong>. Statistics, percentages, and compliance metrics reflect only the processed subset and should not be extrapolated to represent complete organizational security posture.</p>
            <ul>
                <li><strong>Risk Assessment:</strong> Additional security risks may exist in unprocessed Key Vaults</li>
                <li><strong>Compliance Scoring:</strong> Organization-wide compliance rates may differ significantly</li>
                <li><strong>Resource Planning:</strong> Complete audit required for accurate capacity and resource planning</li>
                <li><strong>Executive Reporting:</strong> Full audit recommended for comprehensive executive dashboards</li>
            </ul>
        </div>
        
        <p><strong>📊 Analysis Summary:</strong> This report contains analysis results for 4 out of 4 discovered Key Vaults. The audit was generated from checkpoint data and represents a subset of the complete organizational analysis.</p>
    </div>    <div class="summary">
        <h2>📊 Partial Results Information</h2>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number">4</div>
                <div class="stat-label">Processed Vaults</div>
                <div class="stat-percentage">From Data Source</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">N/A</div>
                <div class="stat-label">Total Discovery</div>
                <div class="stat-percentage">Unknown</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">20251008...</div>
                <div class="stat-label">Report ID</div>
                <div class="stat-percentage">Current Generation</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">10-08</div>
                <div class="stat-label">Generated</div>
                <div class="stat-percentage">16:55 UTC</div>
            </div>
        </div>
        
        <div style="background: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; border-radius: 8px; margin-top: 20px;">
            <h4>📋 Data Source Information:</h4>
            <ul>
                <li><strong>Data Source:</strong> External data source</li>
                <li><strong>Records Processed:</strong> 4 Key Vaults</li>
                <li><strong>Report Generated:</strong> 2025-10-08 16:55:56 UTC by System</li>
                <li><strong>Completeness:</strong> Unknown - CSV data source does not provide total discovery scope</li>
            </ul>
        </div>
        
        <div style="background: #f8d7da; border: 1px solid #f5c6cb; padding: 15px; border-radius: 8px; margin-top: 15px;">
            <h4>⚠️ Important Limitations:</h4>
            <p>This report was generated from imported CSV data. The scope and completeness of the original data collection is unknown.</p>
            <ul>
                <li><strong>Statistical Accuracy:</strong> Percentages reflect only the provided dataset, not organizational totals</li>
                <li><strong>Discovery Scope:</strong> Unknown if all organizational Key Vaults are represented</li>
                <li><strong>Data Currency:</strong> CSV data age and accuracy cannot be verified</li>
                <li><strong>Compliance Assessment:</strong> Organizational compliance status requires complete audit</li>
            </ul>
        </div>
        
        <p><strong>📊 Analysis Summary:</strong> This report contains analysis results for 4 Key Vaults imported from external source. For complete organizational assessment, conduct a full live audit using the main script parameters.</p>
    </div></div>    
    <div class="test-mode-banner">
        🧪 TEST MODE ACTIVE - Limited subset for validation
    </div>    
    <div class="summary">
        <h2>🎯 Executive Summary</h2>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number">4</div>
                <div class="stat-label">Key Vaults Discovered</div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 100%; background: #667eea; animation: progressAnimation 1.5s ease-out;"></div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-number">0</div>
                <div class="stat-label">Fully Compliant</div>
                <div class='stat-percentage non-compliant'>0%</div>
                <div class="progress-bar">
                    <div class='progress-fill' style='width: 0%; background: #dc3545; animation: progressAnimation 2s ease-out;'></div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-number">0</div>
                <div class="stat-label">Average Score</div>
                <div class="stat-percentage">Microsoft Framework</div>
                <div class="dual-framework">
                    <div class="framework-score microsoft-framework">
                        <strong>MS:</strong> 0%
                    </div>
                    <div class="framework-score company-framework">
                        <strong>Company:</strong> 0%
                    </div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-number">0</div>
                <div class="stat-label">High Risk Vaults</div>
                <div class='stat-percentage compliant'>Require Attention</div>
                <div class="progress-bar">
                    <div class='progress-fill' style='width: 0%; background: #dc3545; animation: progressAnimation 2.5s ease-out;'></div>
                </div>
            </div>
        </div>
        
        <!-- Enhanced Workload and Content Analysis Section -->
        <div class="workload-analysis">
            <h3>📊 Workload Analysis</h3>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Total Secrets</div>
                    <div class="stat-percentage">Stored across all vaults</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Total Keys</div>
                    <div class="stat-percentage">Cryptographic operations</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Total Certificates</div>
                    <div class="stat-percentage">SSL/TLS management</div>
                </div>
            </div>
        </div>
        
        <!-- Enhanced Security Configuration Analysis -->
        <div class="security-analysis">
            <h3>🔒 Security Configuration</h3>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">4</div>
                    <div class="stat-label">With Diagnostics</div>
                    <div class='stat-percentage compliant'>100%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">0</div>
                    <div class="stat-label">With Private Endpoints</div>
                    <div class='stat-percentage non-compliant'>0%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">0</div>
                    <div class="stat-label">With Soft Delete</div>
                    <div class='stat-percentage non-compliant'>0%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">0</div>
                    <div class="stat-label">With Purge Protection</div>
                    <div class='stat-percentage non-compliant'>0%</div>
                </div>
            </div>
        </div>
        
        <!-- Enhanced Access Management Analysis -->
        <div class="access-analysis">
            <h3>👥 Access Management</h3>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Total Identities</div>
                    <div class="stat-percentage">Across all vaults</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">4</div>
                    <div class="stat-label">Using RBAC</div>
                    <div class='stat-percentage compliant'>100%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Managed Identities</div>
                    <div class="stat-percentage">System + User Assigned</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Over-Privileged</div>
                    <div class='stat-percentage compliant'>None Found</div>
                </div>
            </div>
        </div>        
        <!-- Comprehensive Identity & Access Management Analysis -->
        <div class="identity-section">
            <h2>🔐 Identity & Access Management Analysis</h2>
            <div class="section-description">
                <p>Comprehensive analysis of all identities with access to Key Vaults, including service principals, managed identities, and user accounts. This section provides detailed insights into access patterns, permissions distribution, and security recommendations.</p>
            </div>
            
            <!-- Identity Statistics Overview -->
            <div class="identity-overview">
                <h3>📊 Identity Distribution</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number">82</div>
                        <div class="stat-label">Service Principals</div>
                        <div class="stat-percentage">Application identities</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">0</div>
                        <div class="stat-label">Managed Identities</div>
                        <div class="stat-percentage">Azure-managed</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">6</div>
                        <div class="stat-label">User Accounts</div>
                        <div class="stat-percentage">Human identities</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">24</div>
                        <div class="stat-label">Security Groups</div>
                        <div class="stat-percentage">Group assignments</div>
                    </div>
                </div>
            </div>
            
            <!-- Access Patterns Analysis -->
            <div class="access-patterns">
                <h3>🎯 Access Patterns & Risk Analysis</h3>
                <div class="pattern-analysis">
                    <div class="pattern-card">
                        <h4>High-Privilege Assignments</h4>
                        <div class="pattern-content">
                            <div class="metric">107 assignments</div>
                            <div class="description">Identities with administrative access to Key Vaults</div>
                            <div class='risk-indicator high-risk'>⚠️ High Risk: Review administrative access</div>
                        </div>
                    </div>
                    
                    <div class="pattern-card">
                        <h4>Cross-Vault Access</h4>
                        <div class="pattern-content">
                            <div class="metric">106 identities</div>
                            <div class="description">Identities with access to multiple Key Vaults</div>
                            <div class='risk-indicator high-risk'>⚠️ High cross-vault access (80.9%)</div>
                        </div>
                    </div>
                    
                    <div class="pattern-card">
                        <h4>Orphaned Permissions</h4>
                        <div class="pattern-content">
                            <div class="metric">0 assignments</div>
                            <div class="description">Role assignments to deleted or invalid identities</div>
                            <div class='risk-indicator low-risk'>✅ No orphaned assignments detected</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- RBAC vs Access Policy Analysis -->
            <div class="rbac-analysis">
                <h3>🔄 RBAC vs Access Policy Comparison</h3>
                <div class="rbac-comparison">
                    <div class="rbac-card">
                        <h4>RBAC Model (Recommended)</h4>
                        <div class="rbac-stats">
                            <div class="rbac-metric">
                                <span class="metric-label">Vaults using RBAC:</span>
                                <span class="metric-value">4</span>
                            </div>
                            <div class="rbac-metric">
                                <span class="metric-label">RBAC Adoption:</span>
                                <span class="metric-value">100%</span>
                            </div>
                        </div>
                        <div class="rbac-benefits">
                            <h5>Benefits:</h5>
                            <ul>
                                <li>✅ Centralized access management</li>
                                <li>✅ Azure AD integration</li>
                                <li>✅ Conditional access support</li>
                                <li>✅ Fine-grained permissions</li>
                                <li>✅ Audit trail in Azure AD logs</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="access-policy-card">
                        <h4>Access Policy Model (Legacy)</h4>
                        <div class="policy-stats">
                            <div class="policy-metric">
                                <span class="metric-label">Vaults using Access Policies:</span>
                                <span class="metric-value">0</span>
                            </div>
                            <div class="policy-metric">
                                <span class="metric-label">Legacy Usage:</span>
                                <span class="metric-value">0%</span>
                            </div>
                        </div>
                        <div class="policy-limitations">
                            <h5>Limitations:</h5>
                            <ul>
                                <li>⚠️ Vault-specific configuration</li>
                                <li>⚠️ Limited conditional access</li>
                                <li>⚠️ No centralized management</li>
                                <li>⚠️ Coarse-grained permissions</li>
                                <li>⚠️ Limited audit capabilities</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="migration-recommendation">
                                        <div class="recommendation good">
                        <h4>✅ Excellent: High RBAC Adoption</h4>
                        <p>100% of your Key Vaults are using the modern RBAC model. This provides excellent security and centralized management.</p>
                    </div>
                </div>
            </div>
            
            <!-- Identity Security Recommendations -->
            <div class="identity-recommendations">
                <h3>🛡️ Identity Security Recommendations</h3>
                <div class="recommendations-grid">
                    <div class="recommendation-card">
                        <div class="recommendation-icon">🔍</div>
                        <h4>Regular Access Reviews</h4>
                        <p>Implement quarterly access reviews to ensure identities still require their assigned permissions.</p>
                        <div class="implementation-tip">
                            <strong>Implementation:</strong> Use Azure AD Access Reviews to automate this process.
                        </div>
                    </div>
                    
                    <div class="recommendation-card">
                        <div class="recommendation-icon">⏰</div>
                        <h4>Time-Limited Access</h4>
                        <p>Consider using Azure AD Privileged Identity Management (PIM) for just-in-time access to Key Vault administrative roles.</p>
                        <div class="implementation-tip">
                            <strong>Implementation:</strong> Configure PIM for Key Vault Administrator and Contributor roles.
                        </div>
                    </div>
                    
                    <div class="recommendation-card">
                        <div class="recommendation-icon">🤖</div>
                        <h4>Prefer Managed Identities</h4>
                        <p>Use managed identities instead of service principals where possible to eliminate credential management.</p>
                        <div class="implementation-tip">
                            <strong>Implementation:</strong> Enable system or user-assigned managed identities for Azure resources.
                        </div>
                    </div>
                    
                    <div class="recommendation-card">
                        <div class="recommendation-icon">📊</div>
                        <h4>Monitor Access Patterns</h4>
                        <p>Implement continuous monitoring of Key Vault access patterns to detect anomalous behavior.</p>
                        <div class="implementation-tip">
                            <strong>Implementation:</strong> Use Azure Sentinel or Log Analytics workbooks for monitoring.
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Secrets Management Insights Section -->
        <div class="secrets-section">
            <h2>🔑 Secrets Management Insights</h2>
            <div class="section-description">
                <p>Comprehensive analysis of secret, key, and certificate management practices across your Key Vault infrastructure, including rotation patterns, expiration monitoring, and security best practices.</p>
            </div>
            
            <!-- Secrets Overview -->
            <div class="secrets-overview">
                <h3>📈 Secrets Distribution & Health</h3>
                <div class="secrets-stats">
                    <div class="secrets-grid">
                        <div class="secret-type-card">
                            <div class="secret-icon">🔐</div>
                            <div class="secret-stats">
                                <div class="secret-count">0</div>
                                <div class="secret-label">Total Secrets</div>
                                <div class="secret-description">Application passwords, connection strings, API keys</div>
                            </div>
                        </div>
                        
                        <div class="secret-type-card">
                            <div class="secret-icon">🗝️</div>
                            <div class="secret-stats">
                                <div class="secret-count">0</div>
                                <div class="secret-label">Cryptographic Keys</div>
                                <div class="secret-description">RSA, EC, AES keys for encryption/signing</div>
                            </div>
                        </div>
                        
                        <div class="secret-type-card">
                            <div class="secret-icon">📜</div>
                            <div class="secret-stats">
                                <div class="secret-count">0</div>
                                <div class="secret-label">X.509 Certificates</div>
                                <div class="secret-description">SSL/TLS certificates for secure communications</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Best Practices Assessment -->
            <div class="best-practices">
                <h3>✅ Security Best Practices Assessment</h3>
                <div class="practices-grid">
                    <div class="practice-card">
                        <div class="practice-header">
                            <div class="practice-icon">🔄</div>
                            <h4>Secret Rotation</h4>
                        </div>
                        <div class="practice-content">
                            <div class="practice-description">
                                Regular rotation of secrets reduces the risk of credential compromise and ensures compliance with security policies.
                            </div>
                            <div class="practice-recommendations">
                                <h5>Recommendations:</h5>
                                <ul>
                                    <li>Implement automated rotation for database connection strings</li>
                                    <li>Set up rotation schedules for API keys (30-90 days)</li>
                                    <li>Use Azure Key Vault's auto-rotation for supported services</li>
                                    <li>Monitor rotation events and failures</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="practice-card">
                        <div class="practice-header">
                            <div class="practice-icon">📅</div>
                            <h4>Expiration Management</h4>
                        </div>
                        <div class="practice-content">
                            <div class="practice-description">
                                Proactive expiration monitoring prevents service disruptions and ensures continuous security coverage.
                            </div>
                            <div class="practice-recommendations">
                                <h5>Recommendations:</h5>
                                <ul>
                                    <li>Set up alerts for secrets expiring within 30 days</li>
                                    <li>Implement automated renewal for certificates</li>
                                    <li>Create runbooks for manual renewal processes</li>
                                    <li>Maintain an expiration calendar for critical secrets</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="practice-card">
                        <div class="practice-header">
                            <div class="practice-icon">🏷️</div>
                            <h4>Naming & Tagging</h4>
                        </div>
                        <div class="practice-content">
                            <div class="practice-description">
                                Consistent naming conventions and comprehensive tagging enable better organization and governance.
                            </div>
                            <div class="practice-recommendations">
                                <h5>Recommendations:</h5>
                                <ul>
                                    <li>Use descriptive names that indicate purpose and environment</li>
                                    <li>Implement version numbers for secret management</li>
                                    <li>Tag secrets with environment, application, and owner information</li>
                                    <li>Document naming conventions in governance policies</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="practice-card">
                        <div class="practice-header">
                            <div class="practice-icon">🔐</div>
                            <h4>Access Patterns</h4>
                        </div>
                        <div class="practice-content">
                            <div class="practice-description">
                                Monitoring access patterns helps identify potential security issues and optimization opportunities.
                            </div>
                            <div class="practice-recommendations">
                                <h5>Recommendations:</h5>
                                <ul>
                                    <li>Review access logs for unusual patterns</li>
                                    <li>Implement least-privilege access principles</li>
                                    <li>Monitor failed access attempts</li>
                                    <li>Set up alerts for administrative operations</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Integration Patterns -->
            <div class="integration-patterns">
                <h3>🔗 Common Integration Patterns</h3>
                <div class="patterns-showcase">
                    <div class="pattern-showcase">
                        <div class="pattern-title">
                            <div class="pattern-icon">🌐</div>
                            <h4>Application Integration</h4>
                        </div>
                        <div class="pattern-description">
                            <p>Best practices for integrating applications with Key Vault for secure secret retrieval.</p>
                            <div class="pattern-examples">
                                <h5>Common Scenarios:</h5>
                                <ul>
                                    <li><strong>ASP.NET Core:</strong> Use Key Vault configuration provider</li>
                                    <li><strong>Azure Functions:</strong> Leverage managed identity for seamless access</li>
                                    <li><strong>Docker Containers:</strong> Inject secrets at runtime using init containers</li>
                                    <li><strong>Kubernetes:</strong> Use Azure Key Vault Provider for Secrets Store CSI driver</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="pattern-showcase">
                        <div class="pattern-title">
                            <div class="pattern-icon">🔄</div>
                            <h4>DevOps Integration</h4>
                        </div>
                        <div class="pattern-description">
                            <p>Secure integration of Key Vault into CI/CD pipelines and infrastructure as code.</p>
                            <div class="pattern-examples">
                                <h5>Implementation Strategies:</h5>
                                <ul>
                                    <li><strong>Azure DevOps:</strong> Use Key Vault task for pipeline secret injection</li>
                                    <li><strong>GitHub Actions:</strong> Leverage Azure Key Vault action for secure access</li>
                                    <li><strong>Terraform:</strong> Reference Key Vault secrets in configuration</li>
                                    <li><strong>ARM/Bicep:</strong> Use Key Vault references in template parameters</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        # Continue with the rest of the comprehensive HTML report content
        # Add the enhanced detailed vault table section
        <!DOCTYPE html>
<html>
<head>
    <title>Azure Key Vault Enhanced Security & Compliance Audit</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 20px; background-color: #f5f5f5; }
.header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
.test-mode-banner { background: #dc3545; color: white; padding: 15px; text-align: center; font-weight: bold; font-size: 1.4em; border-radius: 8px; margin: 20px 0; animation: bloom 2s infinite; }
.partial-results-banner { background: #e67e22; color: white; padding: 12px; text-align: center; font-weight: 600; font-size: 1.1em; border-radius: 6px; margin: 15px 0; border-left: 4px solid #d35400; opacity: 0.95; }
.summary { background: white; padding: 15px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
.compliant { color: #28a745; font-weight: bold; }
.non-compliant { color: #dc3545; font-weight: bold; }
.partially-compliant { color: #ffc107; font-weight: bold; }
.stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 15px 0; }
.stat-card { background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); text-align: center; position: relative; }
.stat-card:hover { transform: translateY(-2px); transition: transform 0.3s ease; }
.stat-number { font-size: 2em; font-weight: bold; color: #667eea; }
.stat-label { color: #666; margin-top: 5px; }
.stat-percentage { font-size: 0.9em; margin-top: 3px; font-weight: bold; }
.progress-bar { width: 100%; height: 8px; background: #e9ecef; border-radius: 4px; overflow: hidden; margin-top: 8px; }
.progress-fill { height: 100%; transition: width 0.8s ease; border-radius: 4px; }
.dual-framework { display: flex; gap: 10px; margin-top: 10px; }
.framework-score { flex: 1; padding: 8px; border-radius: 6px; text-align: center; font-size: 0.85em; }
.microsoft-framework { background: #e7f3ff; border: 1px solid #b8daff; }
.company-framework { background: #fff3cd; border: 1px solid #ffeaa7; }
table { width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin: 20px 0; font-size: 0.8em; }
th { background: #343a40; color: white; padding: 6px; text-align: left; font-weight: 600; cursor: pointer; position: sticky; top: 0; z-index: 10; font-size: 0.8em; }
td { padding: 4px; border-bottom: 1px solid #dee2e6; max-width: 120px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; font-size: 0.8em; }
tr:nth-child(even) { background-color: #f8f9fa; }
tr:hover { background-color: #e9ecef; }
.recommendations { background: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; border-radius: 8px; margin-top: 20px; }
.filter-input { width: 90%; padding: 3px; margin-bottom: 3px; border: 1px solid #ccc; border-radius: 4px; font-size: 0.75em; }
.identity-section { background: #e7f3ff; border: 1px solid #b8daff; padding: 15px; border-radius: 8px; margin: 20px 0; }
.security-section { background: #d4edda; border: 1px solid #c3e6cb; padding: 15px; border-radius: 8px; margin: 20px 0; }
.secrets-section { background: #fff3cd; border: 1px solid #ffeeba; padding: 15px; border-radius: 8px; margin: 20px 0; }
.quick-wins-section { background: #f8f9ff; border: 1px solid #e6e6ff; padding: 15px; border-radius: 8px; margin: 20px 0; }
.configuration-coverage-section { background: #f0f8ff; border: 1px solid #b8daff; padding: 15px; border-radius: 8px; margin: 20px 0; }
.compliance-legend-section { background: #f8f0ff; border: 1px solid #e6d7ff; padding: 15px; border-radius: 8px; margin: 20px 0; }
.action-link { color: #007bff; cursor: pointer; text-decoration: underline; font-size: 0.8em; }
.action-details { display: none; background: #f8f9fa; border: 1px solid #dee2e6; padding: 8px; margin-top: 3px; border-radius: 4px; font-size: 0.75em; }
.legend-section { background: #e9ecef; border: 1px solid #dee2e6; padding: 15px; border-radius: 8px; margin: 20px 0; }
.tooltip { position: relative; display: inline-block; cursor: help; color: #007bff; font-weight: bold; }
.tooltip .tooltiptext { visibility: hidden; width: 300px; background-color: #333; color: #fff; text-align: left; padding: 8px; border-radius: 6px; position: absolute; z-index: 1; bottom: 125%; left: 50%; margin-left: -150px; font-size: 0.8em; box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
.tooltip:hover .tooltiptext { visibility: visible; }
.enhancement-badge { display: inline-block; padding: 2px 8px; background: #667eea; color: white; border-radius: 12px; font-size: 0.7em; margin-left: 8px; }
.collapsible-toggle { cursor: pointer; padding: 5px 10px; background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 4px; font-size: 0.8em; margin-left: 10px; transition: all 0.3s ease; }
.collapsible-toggle:hover { background: #e9ecef; }
.collapsible-content { margin-top: 10px; }
@keyframes bloom { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }
@keyframes progressAnimation { from { width: 0%; } }

/* Enhanced Identity & Access Management Styles */
.identity-overview { margin: 20px 0; }
.pattern-analysis { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin: 20px 0; }
.pattern-card { background: white; border: 1px solid #b8daff; border-radius: 8px; padding: 15px; }
.pattern-card h4 { margin-top: 0; color: #0066cc; }
.pattern-content .metric { font-size: 1.5em; font-weight: bold; color: #667eea; margin-bottom: 5px; }
.pattern-content .description { color: #666; margin-bottom: 10px; }
.risk-indicator { padding: 5px 10px; border-radius: 15px; font-size: 0.9em; font-weight: bold; }
.risk-indicator.high-risk { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
.risk-indicator.medium-risk { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
.risk-indicator.low-risk { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }

/* RBAC Analysis Styles */
.rbac-analysis { margin: 25px 0; }
.rbac-comparison { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0; }
.rbac-card, .access-policy-card { background: white; border-radius: 8px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
.rbac-card { border-left: 4px solid #28a745; }
.access-policy-card { border-left: 4px solid #ffc107; }
.rbac-metric, .policy-metric { display: flex; justify-content: space-between; margin: 8px 0; padding: 5px 0; border-bottom: 1px solid #eee; }
.metric-label { font-weight: 600; }
.metric-value { color: #667eea; font-weight: bold; }
.rbac-benefits ul, .policy-limitations ul { margin: 10px 0; padding-left: 20px; }
.rbac-benefits li { color: #28a745; margin: 5px 0; }
.policy-limitations li { color: #856404; margin: 5px 0; }
.migration-recommendation { margin-top: 20px; }
.recommendation.urgent { background: #f8d7da; border: 1px solid #f5c6cb; border-radius: 8px; padding: 15px; }
.recommendation.moderate { background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 8px; padding: 15px; }
.recommendation.good { background: #d4edda; border: 1px solid #c3e6cb; border-radius: 8px; padding: 15px; }
.migration-steps ol { margin: 10px 0; padding-left: 20px; }

/* Identity Recommendations Styles */
.identity-recommendations { margin: 25px 0; }
.recommendations-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin: 20px 0; }
.recommendation-card { background: white; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); border-left: 4px solid #667eea; }
.recommendation-icon { font-size: 2em; text-align: center; margin-bottom: 10px; }
.recommendation-card h4 { margin: 10px 0; color: #333; }
.implementation-tip { background: #f8f9fa; border-radius: 4px; padding: 8px; margin-top: 10px; font-size: 0.9em; }

/* Secrets Management Styles */
.secrets-overview { margin: 20px 0; }
.secrets-stats { margin: 15px 0; }
.secrets-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
.secret-type-card { background: white; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); display: flex; align-items: center; }
.secret-icon { font-size: 2.5em; margin-right: 15px; }
.secret-count { font-size: 1.8em; font-weight: bold; color: #667eea; }
.secret-label { font-weight: 600; color: #333; margin: 5px 0; }
.secret-description { font-size: 0.9em; color: #666; }

/* Best Practices Styles */
.best-practices { margin: 25px 0; }
.practices-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0; }
.practice-card { background: white; border-radius: 8px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
.practice-header { display: flex; align-items: center; margin-bottom: 15px; }
.practice-icon { font-size: 2em; margin-right: 15px; }
.practice-header h4 { margin: 0; color: #333; }
.practice-description { margin-bottom: 15px; color: #666; font-size: 0.95em; }
.practice-recommendations h5 { margin: 10px 0 5px 0; color: #667eea; }
.practice-recommendations ul { margin: 0; padding-left: 20px; }
.practice-recommendations li { margin: 5px 0; }

/* Integration Patterns Styles */
.integration-patterns { margin: 25px 0; }
.patterns-showcase { margin: 20px 0; }
.pattern-showcase { background: white; border-radius: 8px; padding: 20px; margin: 15px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
.pattern-title { display: flex; align-items: center; margin-bottom: 15px; }
.pattern-icon { font-size: 2em; margin-right: 15px; }
.pattern-title h4 { margin: 0; color: #333; }
.pattern-examples h5 { margin: 10px 0 5px 0; color: #667eea; }
.pattern-examples ul { margin: 0; padding-left: 20px; }
.pattern-examples li { margin: 5px 0; }

/* Comprehensive Security Enhancement Styles */
.security-priority-section { margin: 30px 0; }
.security-recommendations-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin: 20px 0; }
.security-recommendation { background: white; border-radius: 8px; padding: 20px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
.security-recommendation.urgent { border-left: 6px solid #dc3545; }
.security-recommendation.moderate { border-left: 6px solid #ffc107; }
.recommendation-header { display: flex; align-items: center; margin-bottom: 15px; }
.priority-badge { padding: 4px 12px; border-radius: 12px; font-size: 0.8em; font-weight: bold; margin-right: 15px; }
.priority-badge.critical { background: #dc3545; color: white; }
.priority-badge.medium { background: #ffc107; color: #212529; }
.priority-badge.strategic { background: #6f42c1; color: white; }
.recommendation-header h4 { margin: 0; color: #333; }
.current-status { background: #f8f9fa; border-radius: 4px; padding: 10px; margin: 10px 0; }
.risk-impact { background: #fff3cd; border-radius: 4px; padding: 10px; margin: 10px 0; border-left: 4px solid #ffc107; }
.implementation-steps, .network-hardening-steps, .migration-strategy { margin: 15px 0; }
.implementation-steps h5, .network-hardening-steps h5, .migration-strategy h5 { margin: 10px 0 5px 0; color: #667eea; }
.implementation-steps ol, .network-hardening-steps ol, .migration-strategy ol { margin: 5px 0; padding-left: 20px; }
.implementation-steps li, .network-hardening-steps li, .migration-strategy li { margin: 5px 0; }
.compliance-note, .zero-trust-alignment { background: #d4edda; border-radius: 4px; padding: 8px; margin: 10px 0; border-left: 4px solid #28a745; font-size: 0.9em; }

/* Comparison Table Styles */
.comparison-table { margin: 15px 0; }
.comparison-row { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; padding: 8px; border-bottom: 1px solid #eee; }
.comparison-row:first-child { font-weight: bold; background: #f8f9fa; }
.feature { font-weight: 600; }
.rbac-value { color: #28a745; }
.policy-value { color: #856404; }

/* Strategic Recommendations Styles */
.strategic-recommendations { margin: 20px 0; }
.strategic-recommendation { background: white; border-radius: 8px; padding: 25px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border-left: 6px solid #6f42c1; }
.architecture-vision { margin: 20px 0; }
.architecture-components { margin: 15px 0; }
.architecture-layer { background: #f8f9fa; border-radius: 6px; padding: 15px; margin: 10px 0; border-left: 3px solid #667eea; }
.architecture-layer h6 { margin: 0 0 10px 0; color: #667eea; }
.architecture-layer ul { margin: 5px 0; padding-left: 20px; }
.implementation-roadmap { margin: 20px 0; }
.roadmap-timeline { margin: 15px 0; }
.roadmap-phase { background: #fff; border: 1px solid #dee2e6; border-radius: 6px; padding: 15px; margin: 10px 0; }
.phase-title { font-weight: bold; color: #6f42c1; margin-bottom: 10px; }

/* Security Metrics Styles */
.security-metrics-section { margin: 30px 0; }
.metrics-dashboard { margin: 20px 0; }
.metrics-category { background: white; border-radius: 8px; padding: 20px; margin: 15px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
.metrics-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 15px 0; }
.metric-card { background: #f8f9fa; border-radius: 6px; padding: 15px; text-align: center; border: 1px solid #dee2e6; }
.metric-name { font-size: 0.9em; color: #666; margin-bottom: 5px; }
.metric-value { font-size: 1.5em; font-weight: bold; color: #667eea; margin: 5px 0; }
.metric-target { font-size: 0.8em; color: #28a745; font-style: italic; }
.operational-metrics { margin: 15px 0; }
.metric-row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #eee; }
.metric-label { font-weight: 600; }

/* Governance Styles */
.governance-components { margin: 20px 0; }
.governance-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin: 15px 0; }
.governance-item { background: #f8f9fa; border-radius: 6px; padding: 15px; border-left: 3px solid #667eea; }
.governance-item h6 { margin: 0 0 10px 0; color: #667eea; }
.governance-item ul { margin: 5px 0; padding-left: 20px; }

/* Rotation Methods Styles */
.rotation-benefits, .rotation-implementation { margin: 15px 0; }
.rotation-methods { margin: 15px 0; }
.rotation-method { background: #f8f9fa; border-radius: 6px; padding: 12px; margin: 10px 0; border-left: 3px solid #667eea; }
.rotation-method h6 { margin: 0 0 8px 0; color: #667eea; }
.rotation-method code { background: #e9ecef; padding: 2px 6px; border-radius: 3px; font-size: 0.9em; }
.rotation-method ul { margin: 5px 0; padding-left: 20px; }

/* Section Descriptions */
.section-description { background: #f8f9fa; border-radius: 6px; padding: 15px; margin: 15px 0; border-left: 4px solid #667eea; }
.section-description p { margin: 0; color: #666; font-size: 0.95em; }

/* Access Analysis Styles */
.access-analysis { margin: 25px 0; }
.security-analysis { margin: 25px 0; }
.access-analysis h3, .security-analysis h3 { color: #333; margin-bottom: 15px; }
    </style>
    <script>
function filterTable(input, col) {
    var filter = input.value.toUpperCase();
    var table = document.getElementById("vaultTable");
    var trs = table.getElementsByTagName("tr");
    for (var i = 2; i < trs.length; i++) {
        var tds = trs[i].getElementsByTagName("td");
        if (tds.length > col) {
            var txt = tds[col].textContent || tds[col].innerText;
            trs[i].style.display = txt.toUpperCase().indexOf(filter) > -1 ? "" : "none";
        }
    }
}
    // Removed stray catch block from JavaScript

function sortTable(n) {
    var table = document.getElementById("vaultTable");
    var switching = true;
    var dir = "asc";
    var switchcount = 0;
    while (switching) {
        switching = false;
        var rows = table.rows;
        for (var i = 2; i < (rows.length - 1); i++) {
            var shouldSwitch = false;
            var x = rows[i].getElementsByTagName("TD")[n];
            var y = rows[i + 1].getElementsByTagName("TD")[n];
            if (dir == "asc") {
                if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                    shouldSwitch = true;
                    break;
                }
            } else if (dir == "desc") {
                if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
                    shouldSwitch = true;
                    break;
                }
            }
        }
        if (shouldSwitch) {
            rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
            switching = true;
            switchcount++;
        } else {
            if (switchcount == 0 && dir == "asc") {
                dir = "desc";
                switching = true;
            }
        }
    }
}

function toggleActionItems(id) {
    var element = document.getElementById(id);
    if (element.style.display === "none" || element.style.display === "") {
        element.style.display = "block";
    } else {
        element.style.display = "none";
    }
}

function toggleCollapsible(elementId) {
    var content = document.getElementById(elementId);
    var toggle = content.previousElementSibling.querySelector('.collapsible-toggle');
    
    if (content.style.display === "none" || content.style.display === "") {
        content.style.display = "block";
        toggle.textContent = "Hide Details";
        toggle.style.backgroundColor = "#007bff";
        toggle.style.color = "white";
    } else {
        content.style.display = "none";
        toggle.textContent = "Show Details";
        toggle.style.backgroundColor = "#f8f9fa";
        toggle.style.color = "#333";
    }
}
    </script>
</head>
<body>
    <div class="header">
        <h1>🔐 Azure Key Vault Enhanced Security & Compliance Audit</h1>
        <p><strong>Generated:</strong> 2025-10-08 16:55:56 UTC by curtus.regnier@intel.com</p>
        
        <p><strong>Script Version:</strong> 2.1 - Production Enterprise Edition</p>                
            </ul>
        </div>
        
        <div style="background: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; border-radius: 8px; margin-top: 15px;">
            <h4>🔄 Audit Resume Instructions:</h4>
            <p><strong>To complete the full organizational audit:</strong></p>
            <ol>
                <li><strong>Check for checkpoint files:</strong> Look for files matching <code>akv_audit_checkpoint_unknown_*.json</code> in your output directory</li>
                <li><strong>Resume from checkpoint:</strong> Run <code>Get-AKV_Roles&SecAuditCompliance.ps1 -Resume</code> and select the appropriate checkpoint</li>
                <li><strong>Alternative approach:</strong> Start a new complete audit with <code>Get-AKV_Roles&SecAuditCompliance.ps1</code> (full scan)</li>
                <li><strong>Test mode first:</strong> Use <code>Get-AKV_Roles&SecAuditCompliance.ps1 -TestMode</code> to validate setup before full scan</li>
            </ol>
            <p><strong>📝 Note:</strong> Resume functionality requires the original checkpoint files from the incomplete audit. If checkpoints are not available, a new full audit will be required.</p>
        </div>
        
        <div style="background: #f8d7da; border: 1px solid #f5c6cb; padding: 15px; border-radius: 8px; margin-top: 15px;">
            <h4>⚠️ Data Completeness Disclaimer:</h4>
            <p>This partial results report contains analysis for <strong>4 Key Vaults (100% of discovered infrastructure)</strong>. Statistics, percentages, and compliance metrics reflect only the processed subset and should not be extrapolated to represent complete organizational security posture.</p>
            <ul>
                <li><strong>Risk Assessment:</strong> Additional security risks may exist in unprocessed Key Vaults</li>
                <li><strong>Compliance Scoring:</strong> Organization-wide compliance rates may differ significantly</li>
                <li><strong>Resource Planning:</strong> Complete audit required for accurate capacity and resource planning</li>
                <li><strong>Executive Reporting:</strong> Full audit recommended for comprehensive executive dashboards</li>
            </ul>
        </div>
        
        <p><strong>📊 Analysis Summary:</strong> This report contains analysis results for 4 out of 4 discovered Key Vaults. The audit was generated from checkpoint data and represents a subset of the complete organizational analysis.</p>
    </div>    <div class="summary">
        <h2>📊 Partial Results Information</h2>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number">4</div>
                <div class="stat-label">Processed Vaults</div>
                <div class="stat-percentage">From Data Source</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">N/A</div>
                <div class="stat-label">Total Discovery</div>
                <div class="stat-percentage">Unknown</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">20251008...</div>
                <div class="stat-label">Report ID</div>
                <div class="stat-percentage">Current Generation</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">10-08</div>
                <div class="stat-label">Generated</div>
                <div class="stat-percentage">16:55 UTC</div>
            </div>
        </div>
        
        <div style="background: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; border-radius: 8px; margin-top: 20px;">
            <h4>📋 Data Source Information:</h4>
            <ul>
                <li><strong>Data Source:</strong> External data source</li>
                <li><strong>Records Processed:</strong> 4 Key Vaults</li>
                <li><strong>Report Generated:</strong> 2025-10-08 16:55:56 UTC by System</li>
                <li><strong>Completeness:</strong> Unknown - CSV data source does not provide total discovery scope</li>
            </ul>
        </div>
        
        <div style="background: #f8d7da; border: 1px solid #f5c6cb; padding: 15px; border-radius: 8px; margin-top: 15px;">
            <h4>⚠️ Important Limitations:</h4>
            <p>This report was generated from imported CSV data. The scope and completeness of the original data collection is unknown.</p>
            <ul>
                <li><strong>Statistical Accuracy:</strong> Percentages reflect only the provided dataset, not organizational totals</li>
                <li><strong>Discovery Scope:</strong> Unknown if all organizational Key Vaults are represented</li>
                <li><strong>Data Currency:</strong> CSV data age and accuracy cannot be verified</li>
                <li><strong>Compliance Assessment:</strong> Organizational compliance status requires complete audit</li>
            </ul>
        </div>
        
        <p><strong>📊 Analysis Summary:</strong> This report contains analysis results for 4 Key Vaults imported from external source. For complete organizational assessment, conduct a full live audit using the main script parameters.</p>
    </div></div>    
    <div class="test-mode-banner">
        🧪 TEST MODE ACTIVE - Limited subset for validation
    </div>    
    <div class="summary">
        <h2>🎯 Executive Summary</h2>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number">4</div>
                <div class="stat-label">Key Vaults Discovered</div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 100%; background: #667eea; animation: progressAnimation 1.5s ease-out;"></div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-number">0</div>
                <div class="stat-label">Fully Compliant</div>
                <div class='stat-percentage non-compliant'>0%</div>
                <div class="progress-bar">
                    <div class='progress-fill' style='width: 0%; background: #dc3545; animation: progressAnimation 2s ease-out;'></div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-number">0</div>
                <div class="stat-label">Average Score</div>
                <div class="stat-percentage">Microsoft Framework</div>
                <div class="dual-framework">
                    <div class="framework-score microsoft-framework">
                        <strong>MS:</strong> 0%
                    </div>
                    <div class="framework-score company-framework">
                        <strong>Company:</strong> 0%
                    </div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-number">0</div>
                <div class="stat-label">High Risk Vaults</div>
                <div class='stat-percentage compliant'>Require Attention</div>
                <div class="progress-bar">
                    <div class='progress-fill' style='width: 0%; background: #dc3545; animation: progressAnimation 2.5s ease-out;'></div>
                </div>
            </div>
        </div>
        
        <!-- Enhanced Workload and Content Analysis Section -->
        <div class="workload-analysis">
            <h3>📊 Workload Analysis</h3>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Total Secrets</div>
                    <div class="stat-percentage">Stored across all vaults</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Total Keys</div>
                    <div class="stat-percentage">Cryptographic operations</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Total Certificates</div>
                    <div class="stat-percentage">SSL/TLS management</div>
                </div>
            </div>
        </div>
        
        <!-- Enhanced Security Configuration Analysis -->
        <div class="security-analysis">
            <h3>🔒 Security Configuration</h3>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">4</div>
                    <div class="stat-label">With Diagnostics</div>
                    <div class='stat-percentage compliant'>100%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">0</div>
                    <div class="stat-label">With Private Endpoints</div>
                    <div class='stat-percentage non-compliant'>0%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">0</div>
                    <div class="stat-label">With Soft Delete</div>
                    <div class='stat-percentage non-compliant'>0%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">0</div>
                    <div class="stat-label">With Purge Protection</div>
                    <div class='stat-percentage non-compliant'>0%</div>
                </div>
            </div>
        </div>
        
        <!-- Enhanced Access Management Analysis -->
        <div class="access-analysis">
            <h3>👥 Access Management</h3>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Total Identities</div>
                    <div class="stat-percentage">Across all vaults</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">4</div>
                    <div class="stat-label">Using RBAC</div>
                    <div class='stat-percentage compliant'>100%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Managed Identities</div>
                    <div class="stat-percentage">System + User Assigned</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Over-Privileged</div>
                    <div class='stat-percentage compliant'>None Found</div>
                </div>
            </div>
        </div> += @"
        </div>
    </div>
    
    <div class="summary">
        <h2>📋 Detailed Vault Analysis</h2>
        <p>Comprehensive analysis of all  Key Vaults with compliance scoring, security configurations, workload analysis, and actionable recommendations.</p>
        
        <table id="vaultTable">
            <thead>
                <tr>
                    <th onclick="sortTable(0)">Subscription</th>
                    <th onclick="sortTable(1)">Key Vault Name</th>
                    <th onclick="sortTable(2)">Location</th>
                    <th onclick="sortTable(3)">Resource Group</th>
                    <th onclick="sortTable(4)">Environment</th>
                    <th onclick="sortTable(5)">Primary Workload</th>
                    <th onclick="sortTable(6)">Secrets</th>
                    <th onclick="sortTable(7)">Keys</th>
                    <th onclick="sortTable(8)">Certificates</th>
                    <th onclick="sortTable(9)">MS Score</th>
                    <th onclick="sortTable(10)">Company Score</th>
                    <th onclick="sortTable(11)">Risk Level</th>
                    <th onclick="sortTable(12)">Compliance Status</th>
                    <th onclick="sortTable(13)">Diagnostics</th>
                    <th onclick="sortTable(14)">Log Analytics</th>
                    <th onclick="sortTable(15)">Event Hub</th>
                    <th onclick="sortTable(16)">Storage Account</th>
                    <th onclick="sortTable(17)">Access Policies</th>
                    <th onclick="sortTable(18)">RBAC Assignments</th>
                    <th onclick="sortTable(19)">Total Identities</th>
                    <th onclick="sortTable(20)">Managed Identities</th>
                    <th onclick="sortTable(21)">Over-Privileged</th>
                    <th onclick="sortTable(22)">Soft Delete</th>
                    <th onclick="sortTable(23)">Purge Protection</th>
                    <th onclick="sortTable(24)">Public Access</th>
                    <th onclick="sortTable(25)">Private Endpoints</th>
                    <th onclick="sortTable(26)">Network ACLs</th>
                    <th onclick="sortTable(27)">System Identity</th>
                    <th onclick="sortTable(28)">Security Insights</th>
                    <th onclick="sortTable(29)">Recommendations</th>
                </tr>
                <tr><th><input type='text' class='filter-input' onkeyup='filterTable(this, 0)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 1)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 2)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 3)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 4)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 5)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 6)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 7)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 8)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 9)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 10)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 11)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 12)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 13)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 14)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 15)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 16)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 17)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 18)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 19)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 20)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 21)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 22)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 23)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 24)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 25)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 26)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 27)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 28)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 29)' placeholder='Filter...'></th>                </tr>
            </thead>
            <tbody><tr><td title='dc8b9d9c-0cf9-446c-9177-12921182f54a'>1ci-preprod-metrics</td><td><strong>kv-adx-access</strong></td><td>westus</td><td>rg-1ci-metrics-data-analytics</td><td><span class='environment-Unknown'>Unknown</span></td><td title=''>Not Determined</td><td class='number-cell'>0</td><td class='number-cell'>0</td><td class='number-cell'>0</td><td><span style='color: #ffc107; font-weight: bold;'>85%</span></td><td><span style='color: #ffc107; font-weight: bold;'>82%</span></td><td><span style='color: #ffc107; font-weight: bold;'>Medium</span></td><td><span class='partially-compliant'>Compliant</span></td><td><span style='color: #ffc107; font-weight: bold;' title='Company Framework Score'>82%</span></td><td>True</td><td title='AuditEvent,AzurePolicyEvaluationDetails'>AuditEvent, AzurePolicyEvaluationDetails</td><td title='Workspace: '>False</td><td title='Namespace: InfoSecEventHubwestus, Hub: '>True</td><td title='Storage: '>False</td><td title=''>0</td><td title='aad_bbaang: Owner | aad_bbaang: User Access Administrator | aad_rmcarden: User Access Administrator | aad_rmcarden: Owner | aad_sbiton2: User Access Administrator | CSM Azure Admin Diego Sverdloff: User Access Administrator | CSM Azure Admin Shmuel Ber: User Access Administrator | cbroker_testsp: Owner | Admin Access to dc8b9d9c-0cf9-446c-9177-12921182f54a AZADCORP: Owner | Custom Access to dc8b9d9c-0cf9-446c-9177-12921182f54a AZADCORP: Contributor | Reader Access dc8b9d9c-0cf9-446c-9177-12921182f54a AZADCORP: Reader | Containers/securityOperators/DefenderForContainersSecurityOperator: Defender Kubernetes API Access | Microsoft Defender for Cloud Servers Scanner Resource Provider: VM Scanner Operator | Unknown Principal: Contributor | 1CICD Certification: Reader | 1CICD Image builder PRE: Contributor | Unknown Principal: Monitoring Reader | fa-github-webhook-router: EventGrid Data Sender | fa-workflow-event-consumer: Azure Event Hubs Data Owner | Unknown Principal: EventGrid EventSubscription Contributor | ui-fa-oso-notifier: Azure Event Hubs Data Receiver | ui-fa-oso-notifier: Azure Event Hubs Data Receiver | fa-sinker-proxy: EventGrid Data Receiver | fa-sinker-proxy: EventGrid Data Contributor | Github: EventGrid Contributor | Github: EventGrid Data Sender | fa-sinker-proxy: EventGrid EventSubscription Reader | Unknown Principal: EventGrid Data Contributor | Unknown Principal: EventGrid Data Receiver | oss-github: Azure Event Hubs Data Owner | oss-github: EventGrid Data Receiver | Metrics: EventGrid Data Contributor | metrics-ingest: EventGrid Data Contributor | Metrics: EventGrid Data Sender | metrics-ingest: EventGrid Data Receiver | Metrics: Azure Event Hubs Data Sender | Unknown Principal: EventGrid Data Receiver | github-org-events: EventGrid Data Receiver | Github: Azure Event Hubs Data Sender | metrics-nonprod-westus: Azure Event Hubs Data Sender | ci-metrics-pilot: Azure Event Hubs Data Receiver | Cloud Infrastructure Entitlement Management: Reader | CloudPosture/securityOperators/DefenderCSPMSecurityOperator: Defender CSPM Storage Scanner Operator | CloudPosture/securityOperators/DefenderCSPMSecurityOperator: Defender Kubernetes API Access | SqlVmAndArcSqlServersProtection: Virtual Machine Contributor | storageDataScanner: Storage Blob Data Reader | SqlVmAndArcSqlServersProtection: Managed Identity Operator | storageDataScanner: Storage File Data Privileged Reader | SqlVmAndArcSqlServersProtection: Log Analytics Contributor | 8e808fd726b24678aa6cebaf: SQL Security Manager | Azure_Admin: Owner | SIRT_IaaS_Security_Audit: Contributor | d84517051f3a436288bff9f7: Contributor | InfoSecAutomation_grBxdcGCKejpB2kI71OHzCPbPPhrWCK/TfeKLQbsNig=: Contributor | AAD Role - Security Reader: Security Reader | Cloud Brokers: Owner | Microsoft Azure Log Integration Service (azlog) - 9709e9ec-2cb5-4580-8ea8-157e522740ff: Reader | Azure Security Manager: Security Admin | Azure Security Manager: Reader | IT Billing Read Only for Azure: Billing Reader | Wiz for Azure: Management Group Reader | Wiz for Azure: WizCustomRole-2021-01-28-Intel-Devtest-IC-Hybrid | Wiz for Azure: Reader | Wiz for Azure: Azure Kubernetes Service RBAC Reader | Cloud Brokers Reader: Reader | Azure DNS Engineering: Reader | cbroker_testsp: Owner | Eco cost specialist in azure: Cost Management Reader | InfoSecAutomation: Contributor | Azure SEER automatic enforcement: SEER enforcement | Unknown Principal: Reader | Unknown Principal: Virtual Machine Contributor | Unknown Principal: Reader | Unknown Principal: Contributor | 56acafe94e754a5db6eda4ba: Contributor | InfoSecAutomation: Azure Kubernetes Service Cluster Admin Role | InfoSecAutomation: Azure Kubernetes Service RBAC Admin | ac6c4e43cba143689bb93343: Contributor | InfoSecAutomation: Azure Kubernetes Service RBAC Cluster Admin | WizKeyVaultFirewall: Key Vault Contributor | WizKeyVaultAccess: Key Vault Contributor | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Key Vault Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Key Vault Crypto Service Encryption User | 0db888b68baf42419da39dbd: Security Admin | e8ffd98c1d294021b0416ddd: Security Admin | Azure Public Cloud Hosting - Platform Reader: Reader | Azure Public Cloud Hosting - Platform Administrator: Owner | Azure Public Cloud Hosting - Platform Contributor: Contributor | Azure_Admin: Owner | IT Billing Read Only for Azure: Billing Reader | CBIC_Tenable_Reader: Reader | ECO_SPOT_IAP_16553: Cost Management Reader | Unknown Principal: Reader | CloudHealth_PR_IAP_34144: Reader | Unknown Principal: Reader | Men_and_Mice_PR_IAP_8445: Men and Mice Operator | Azure Security Read Only: Reader | Azure Security Admin: Owner | SDI Cloud Operations Azure: Owner | Densify-POC: Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: WizCustomRole1 | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Azure Kubernetes Service RBAC Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Azure Kubernetes Service Cluster User Role | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Storage Blob Data Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Cognitive Services OpenAI User | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: WizDataScanningRole | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: WizServerlessScanningRole | Cyber Defense Perimeter Pentesting: Reader | CrowdStrike TEST CID - Cloud Security Integration: Reader | CrowdStrike TEST CID - Cloud Security Integration: Security Reader | CrowdStrike TEST CID - Cloud Security Integration: Key Vault Reader | CrowdStrike TEST CID - Cloud Security Integration: Azure Kubernetes Service RBAC Reader | WizKeyVaultAccess: Key Vault Contributor | WizKeyVaultFirewall: Key Vault Contributor | Unknown Principal: WizRemediationCustomRole | rubrik_scan: Reader and Data Access | rubrik_scan: Reader | wizazurerr-fa: WizRemediationCustomRole | Azure-Infosecurity-Keyvault-Auditor: Key Vault Reader | Azure-Infosecurity-Keyvault-Auditor: Monitoring Reader | Praetorian Chariot: Security Reader | Praetorian Chariot: Reader | CloudHelper_IAP13321: Subscription Rename | Unknown Principal: WizRemediationCustomRole | RockSteady Cloud Azure: RockSteadyRole | RockSteady Cloud Azure: Azure Kubernetes Service RBAC Reader | RockSteady Cloud Azure: Reader | wiz-jfjcexu4-func: wiz-jfJceXu4-function-role | Azure Public Cloud Hosting - Platform Contributor: Owner | Azure Public Cloud Hosting - Platform Contributor: Contributor | enterprise-hosting-cloud-helper/slots/test: Subscription Rename | enterprise-hosting-cloud-helper: Subscription Rename | enterprise-hosting-cloud-helper/slots/staging: Subscription Rename | Unknown Principal: Reader'>135</td><td title='cbroker_testsp (115bc50e-f248-4244-a146-ade2a6348f07) - Owner [RBAC] | Containers/securityOperators/DefenderForContainersSecurityOperator (d813d1f5-f596-456c-b9ec-cdccaee8cb45) - Defender Kubernetes API Access [RBAC] | Microsoft Defender for Cloud Servers Scanner Resource Provider (f094a5f3-4396-4ed6-86c5-181c709d2c02) - VM Scanner Operator [RBAC] | 1CICD Certification (95f6b320-21ef-4a06-80b0-633ee345d790) - Reader [RBAC] | 1CICD Image builder PRE (24ae01ee-d5f4-4abc-82ed-6b9f4412fa6b) - Contributor [RBAC] | fa-github-webhook-router (d013372d-f839-49ed-a816-b21b61c552ca) - EventGrid Data Sender [RBAC] | fa-workflow-event-consumer (721ed319-62e1-48c0-9d13-2747364bd02c) - Azure Event Hubs Data Owner [RBAC] | ui-fa-oso-notifier (ac2e0d66-cf57-4e29-a09e-84722bc3d783) - Azure Event Hubs Data Receiver [RBAC] | ui-fa-oso-notifier (ac2e0d66-cf57-4e29-a09e-84722bc3d783) - Azure Event Hubs Data Receiver [RBAC] | fa-sinker-proxy (90014ad7-7e2a-48b0-941e-70d9b3914c0d) - EventGrid Data Receiver [RBAC] | fa-sinker-proxy (90014ad7-7e2a-48b0-941e-70d9b3914c0d) - EventGrid Data Contributor [RBAC] | Github (645046c3-f1f8-4c6f-8caf-92f3e2999692) - EventGrid Contributor [RBAC] | Github (645046c3-f1f8-4c6f-8caf-92f3e2999692) - EventGrid Data Sender [RBAC] | fa-sinker-proxy (90014ad7-7e2a-48b0-941e-70d9b3914c0d) - EventGrid EventSubscription Reader [RBAC] | oss-github (113bc23e-04a8-46dc-8de1-7d7aad7f3a8e) - Azure Event Hubs Data Owner [RBAC] | oss-github (113bc23e-04a8-46dc-8de1-7d7aad7f3a8e) - EventGrid Data Receiver [RBAC] | Metrics (c2867564-0616-4001-bd0f-c808cbf95454) - EventGrid Data Contributor [RBAC] | metrics-ingest (1a1f500e-b384-47db-8602-a3e29b6393bf) - EventGrid Data Contributor [RBAC] | Metrics (c2867564-0616-4001-bd0f-c808cbf95454) - EventGrid Data Sender [RBAC] | metrics-ingest (1a1f500e-b384-47db-8602-a3e29b6393bf) - EventGrid Data Receiver [RBAC] | Metrics (c2867564-0616-4001-bd0f-c808cbf95454) - Azure Event Hubs Data Sender [RBAC] | github-org-events (62be8d44-10a6-4ce5-9f35-5517776ad22a) - EventGrid Data Receiver [RBAC] | Github (645046c3-f1f8-4c6f-8caf-92f3e2999692) - Azure Event Hubs Data Sender [RBAC] | metrics-nonprod-westus (dd204f92-4501-4f67-b6cd-4b41501d3060) - Azure Event Hubs Data Sender [RBAC] | ci-metrics-pilot (37f6ba5d-2132-4d7b-bf32-231abfb56d43) - Azure Event Hubs Data Receiver [RBAC] | Cloud Infrastructure Entitlement Management (a2334596-f24d-4d12-be6e-2fee7b045547) - Reader [RBAC] | CloudPosture/securityOperators/DefenderCSPMSecurityOperator (3bf6d0f0-430a-456d-bd4b-c83a31482ae9) - Defender CSPM Storage Scanner Operator [RBAC] | CloudPosture/securityOperators/DefenderCSPMSecurityOperator (3bf6d0f0-430a-456d-bd4b-c83a31482ae9) - Defender Kubernetes API Access [RBAC] | SqlVmAndArcSqlServersProtection (40928c77-cfa0-441d-9116-f1b870371de1) - Virtual Machine Contributor [RBAC] | storageDataScanner (10c17777-2ecc-40ce-ab1c-aae96f3a212c) - Storage Blob Data Reader [RBAC] | SqlVmAndArcSqlServersProtection (40928c77-cfa0-441d-9116-f1b870371de1) - Managed Identity Operator [RBAC] | storageDataScanner (10c17777-2ecc-40ce-ab1c-aae96f3a212c) - Storage File Data Privileged Reader [RBAC] | SqlVmAndArcSqlServersProtection (40928c77-cfa0-441d-9116-f1b870371de1) - Log Analytics Contributor [RBAC] | 8e808fd726b24678aa6cebaf (55c82409-6b0b-445c-9510-84d081c95661) - SQL Security Manager [RBAC] | d84517051f3a436288bff9f7 (c7205b9b-0b19-48f8-abce-210f1b2369ee) - Contributor [RBAC] | InfoSecAutomation_grBxdcGCKejpB2kI71OHzCPbPPhrWCK/TfeKLQbsNig= (7c51ef53-655e-40aa-b15a-3a21cc304b53) - Contributor [RBAC] | Microsoft Azure Log Integration Service (azlog) - 9709e9ec-2cb5-4580-8ea8-157e522740ff (33476dc5-2e32-404a-8718-b5b2d5da0a01) - Reader [RBAC] | Wiz for Azure (65e77292-7652-4fc3-97b3-eaa0bad308ff) - Management Group Reader [RBAC] | Wiz for Azure (65e77292-7652-4fc3-97b3-eaa0bad308ff) - WizCustomRole-2021-01-28-Intel-Devtest-IC-Hybrid [RBAC] | Wiz for Azure (65e77292-7652-4fc3-97b3-eaa0bad308ff) - Reader [RBAC] | Wiz for Azure (65e77292-7652-4fc3-97b3-eaa0bad308ff) - Azure Kubernetes Service RBAC Reader [RBAC] | cbroker_testsp (115bc50e-f248-4244-a146-ade2a6348f07) - Owner [RBAC] | InfoSecAutomation (ff1fc891-cbf9-4b4e-9840-176fcf617fdd) - Contributor [RBAC] | Azure SEER automatic enforcement (cad9f67b-2be1-4059-949b-12fad0f0a151) - SEER enforcement [RBAC] | 56acafe94e754a5db6eda4ba (2b534f55-8944-4206-b358-2af006783ba7) - Contributor [RBAC] | InfoSecAutomation (ff1fc891-cbf9-4b4e-9840-176fcf617fdd) - Azure Kubernetes Service Cluster Admin Role [RBAC] | InfoSecAutomation (ff1fc891-cbf9-4b4e-9840-176fcf617fdd) - Azure Kubernetes Service RBAC Admin [RBAC] | ac6c4e43cba143689bb93343 (38493c83-c734-44e5-b2b5-fda0e2a8731f) - Contributor [RBAC] | InfoSecAutomation (ff1fc891-cbf9-4b4e-9840-176fcf617fdd) - Azure Kubernetes Service RBAC Cluster Admin [RBAC] | WizKeyVaultFirewall (e1e91feb-f49c-43d2-b225-6f59e8050192) - Key Vault Contributor [RBAC] | WizKeyVaultAccess (19fae7fa-1512-4546-bb9f-aa943bd9ba48) - Key Vault Contributor [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Key Vault Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Key Vault Crypto Service Encryption User [RBAC] | 0db888b68baf42419da39dbd (2a060361-e374-40d1-807d-b04bb5e8547f) - Security Admin [RBAC] | e8ffd98c1d294021b0416ddd (14fd31d8-7149-4371-b41a-292e18197327) - Security Admin [RBAC] | CBIC_Tenable_Reader (29b8b746-dc08-4c19-a0a1-3f653c40ecd3) - Reader [RBAC] | ECO_SPOT_IAP_16553 (bd123435-87ec-4fd1-b9d7-14dc67113604) - Cost Management Reader [RBAC] | CloudHealth_PR_IAP_34144 (5b8fb4af-0ad7-47e9-a6d6-27d3dba5aa2d) - Reader [RBAC] | Men_and_Mice_PR_IAP_8445 (1675703c-b517-4f03-a796-9668a390dcf7) - Men and Mice Operator [RBAC] | Densify-POC (e6a9b18f-b1bd-44c0-be64-ed3dc0aeb1df) - Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - WizCustomRole1 [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Azure Kubernetes Service RBAC Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Azure Kubernetes Service Cluster User Role [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Storage Blob Data Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Cognitive Services OpenAI User [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - WizDataScanningRole [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - WizServerlessScanningRole [RBAC] | Cyber Defense Perimeter Pentesting (1bf7fd2d-3100-438a-8341-e679afd5f9ae) - Reader [RBAC] | CrowdStrike TEST CID - Cloud Security Integration (508e7ffa-3c4b-4213-ada2-939d4ca91083) - Reader [RBAC] | CrowdStrike TEST CID - Cloud Security Integration (508e7ffa-3c4b-4213-ada2-939d4ca91083) - Security Reader [RBAC] | CrowdStrike TEST CID - Cloud Security Integration (508e7ffa-3c4b-4213-ada2-939d4ca91083) - Key Vault Reader [RBAC] | CrowdStrike TEST CID - Cloud Security Integration (508e7ffa-3c4b-4213-ada2-939d4ca91083) - Azure Kubernetes Service RBAC Reader [RBAC] | WizKeyVaultAccess (ccaf9819-a25d-4040-a403-c3f71b92bab4) - Key Vault Contributor [RBAC] | WizKeyVaultFirewall (46e69860-91e0-44d3-a2b5-1fe8777cfba1) - Key Vault Contributor [RBAC] | rubrik_scan (677a6233-f344-4f2c-960a-3df08bb36ef3) - Reader and Data Access [RBAC] | rubrik_scan (677a6233-f344-4f2c-960a-3df08bb36ef3) - Reader [RBAC] | wizazurerr-fa (c5a05c6b-3618-4b09-9664-03bef4ea7b67) - WizRemediationCustomRole [RBAC] | Praetorian Chariot (8115ad4c-1930-4f9f-8bc3-1befd822bf04) - Security Reader [RBAC] | Praetorian Chariot (8115ad4c-1930-4f9f-8bc3-1befd822bf04) - Reader [RBAC] | CloudHelper_IAP13321 (4875e471-1ab4-4656-b162-20b9c0bcc6de) - Subscription Rename [RBAC] | RockSteady Cloud Azure (005288a3-f653-4e8c-bcdf-ec797ae662f1) - RockSteadyRole [RBAC] | RockSteady Cloud Azure (005288a3-f653-4e8c-bcdf-ec797ae662f1) - Azure Kubernetes Service RBAC Reader [RBAC] | RockSteady Cloud Azure (005288a3-f653-4e8c-bcdf-ec797ae662f1) - Reader [RBAC] | wiz-jfjcexu4-func (cb7142af-92fe-43c4-a1d7-b7f9baa7d2b3) - wiz-jfJceXu4-function-role [RBAC] | enterprise-hosting-cloud-helper/slots/test (aa41a440-20bc-4a6d-8d03-338825dc12fb) - Subscription Rename [RBAC] | enterprise-hosting-cloud-helper (6c3796e5-908e-497a-b1ad-ff17813bad15) - Subscription Rename [RBAC] | enterprise-hosting-cloud-helper/slots/staging (1463e043-3f16-454d-93a7-e72fa5e108bd) - Subscription Rename [RBAC]'>88</td><td title='Connected: cbroker_testsp (Owner) | Connected: Containers/securityOperators/DefenderForContainersSecurityOperator (Defender Kubernetes API Access) | Connected: Microsoft Defender for Cloud Servers Scanner Resource Provider (VM Scanner Operator) | Connected: 1CICD Certification (Reader) | Connected: 1CICD Image builder PRE (Contributor) | Connected: fa-github-webhook-router (EventGrid Data Sender) | Connected: fa-workflow-event-consumer (Azure Event Hubs Data Owner) | Connected: ui-fa-oso-notifier (Azure Event Hubs Data Receiver) | Connected: ui-fa-oso-notifier (Azure Event Hubs Data Receiver) | Connected: fa-sinker-proxy (EventGrid Data Receiver) | Connected: fa-sinker-proxy (EventGrid Data Contributor) | Connected: Github (EventGrid Contributor) | Connected: Github (EventGrid Data Sender) | Connected: fa-sinker-proxy (EventGrid EventSubscription Reader) | Connected: oss-github (Azure Event Hubs Data Owner) | Connected: oss-github (EventGrid Data Receiver) | Connected: Metrics (EventGrid Data Contributor) | Connected: metrics-ingest (EventGrid Data Contributor) | Connected: Metrics (EventGrid Data Sender) | Connected: metrics-ingest (EventGrid Data Receiver) | Connected: Metrics (Azure Event Hubs Data Sender) | Connected: github-org-events (EventGrid Data Receiver) | Connected: Github (Azure Event Hubs Data Sender) | Connected: metrics-nonprod-westus (Azure Event Hubs Data Sender) | Connected: ci-metrics-pilot (Azure Event Hubs Data Receiver) | Connected: Cloud Infrastructure Entitlement Management (Reader) | Connected: CloudPosture/securityOperators/DefenderCSPMSecurityOperator (Defender CSPM Storage Scanner Operator) | Connected: CloudPosture/securityOperators/DefenderCSPMSecurityOperator (Defender Kubernetes API Access) | Connected: SqlVmAndArcSqlServersProtection (Virtual Machine Contributor) | Connected: storageDataScanner (Storage Blob Data Reader) | Connected: SqlVmAndArcSqlServersProtection (Managed Identity Operator) | Connected: storageDataScanner (Storage File Data Privileged Reader) | Connected: SqlVmAndArcSqlServersProtection (Log Analytics Contributor) | Connected: 8e808fd726b24678aa6cebaf (SQL Security Manager) | Connected: d84517051f3a436288bff9f7 (Contributor) | Connected: InfoSecAutomation_grBxdcGCKejpB2kI71OHzCPbPPhrWCK/TfeKLQbsNig= (Contributor) | Connected: Microsoft Azure Log Integration Service (azlog) - 9709e9ec-2cb5-4580-8ea8-157e522740ff (Reader) | Connected: Wiz for Azure (Management Group Reader) | Connected: Wiz for Azure (WizCustomRole-2021-01-28-Intel-Devtest-IC-Hybrid) | Connected: Wiz for Azure (Reader) | Connected: Wiz for Azure (Azure Kubernetes Service RBAC Reader) | Connected: cbroker_testsp (Owner) | Connected: InfoSecAutomation (Contributor) | Connected: Azure SEER automatic enforcement (SEER enforcement) | Connected: 56acafe94e754a5db6eda4ba (Contributor) | Connected: InfoSecAutomation (Azure Kubernetes Service Cluster Admin Role) | Connected: InfoSecAutomation (Azure Kubernetes Service RBAC Admin) | Connected: ac6c4e43cba143689bb93343 (Contributor) | Connected: InfoSecAutomation (Azure Kubernetes Service RBAC Cluster Admin) | Connected: WizKeyVaultFirewall (Key Vault Contributor) | Connected: WizKeyVaultAccess (Key Vault Contributor) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Key Vault Reader) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Key Vault Crypto Service Encryption User) | Connected: 0db888b68baf42419da39dbd (Security Admin) | Connected: e8ffd98c1d294021b0416ddd (Security Admin) | Connected: CBIC_Tenable_Reader (Reader) | Connected: ECO_SPOT_IAP_16553 (Cost Management Reader) | Connected: CloudHealth_PR_IAP_34144 (Reader) | Connected: Men_and_Mice_PR_IAP_8445 (Men and Mice Operator) | Connected: Densify-POC (Reader) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (WizCustomRole1) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Reader) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Azure Kubernetes Service RBAC Reader) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Azure Kubernetes Service Cluster User Role) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Storage Blob Data Reader) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Cognitive Services OpenAI User) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (WizDataScanningRole) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (WizServerlessScanningRole) | Connected: Cyber Defense Perimeter Pentesting (Reader) | Connected: CrowdStrike TEST CID - Cloud Security Integration (Reader) | Connected: CrowdStrike TEST CID - Cloud Security Integration (Security Reader) | Connected: CrowdStrike TEST CID - Cloud Security Integration (Key Vault Reader) | Connected: CrowdStrike TEST CID - Cloud Security Integration (Azure Kubernetes Service RBAC Reader) | Connected: WizKeyVaultAccess (Key Vault Contributor) | Connected: WizKeyVaultFirewall (Key Vault Contributor) | Connected: rubrik_scan (Reader and Data Access) | Connected: rubrik_scan (Reader) | Connected: wizazurerr-fa (WizRemediationCustomRole) | Connected: Praetorian Chariot (Security Reader) | Connected: Praetorian Chariot (Reader) | Connected: CloudHelper_IAP13321 (Subscription Rename) | Connected: RockSteady Cloud Azure (RockSteadyRole) | Connected: RockSteady Cloud Azure (Azure Kubernetes Service RBAC Reader) | Connected: RockSteady Cloud Azure (Reader) | Connected: wiz-jfjcexu4-func (wiz-jfJceXu4-function-role) | Connected: enterprise-hosting-cloud-helper/slots/test (Subscription Rename) | Connected: enterprise-hosting-cloud-helper (Subscription Rename) | Connected: enterprise-hosting-cloud-helper/slots/staging (Subscription Rename)'>88</td><td title='Principal ID: '>False</td><td title='User Assigned IDs: '>0</td><td>Unknown</td><td>Unknown</td><td title='Network ACLs: False'>Disabled</td><td>0</td><td style='text-align: center;'>0</td><td style='text-align: center;'>0</td><td style='text-align: center;'>0</td><td>Unknown</td><td title=''>Not Determined</td><td><span class='action-link' onclick='toggleActionItems("actions_1")'>View Actions</span><div id='actions_1' class='action-details'><h5>Priority Actions for kv-adx-access:</h5><ul><li>Vault analysis completed successfully - no major issues found</li></ul><p><strong>Impact:</strong> Implementing these recommendations will improve security posture and compliance score.</p></div></td></tr>
<tr><td title='dc8b9d9c-0cf9-446c-9177-12921182f54a'>1ci-preprod-metrics</td><td><strong>kv-pre-ghacts-clctr</strong></td><td>westus2</td><td>rg_ghactions-metrics-collector</td><td><span class='environment-Unknown'>Unknown</span></td><td title=''>Not Determined</td><td class='number-cell'>0</td><td class='number-cell'>0</td><td class='number-cell'>0</td><td><span style='color: #ffc107; font-weight: bold;'>85%</span></td><td><span style='color: #ffc107; font-weight: bold;'>82%</span></td><td><span style='color: #ffc107; font-weight: bold;'>Medium</span></td><td><span class='partially-compliant'>Compliant</span></td><td><span style='color: #ffc107; font-weight: bold;' title='Company Framework Score'>82%</span></td><td>True</td><td title='AuditEvent,AzurePolicyEvaluationDetails'>AuditEvent, AzurePolicyEvaluationDetails</td><td title='Workspace: '>False</td><td title='Namespace: InfoSecEventHubwestus2, Hub: '>True</td><td title='Storage: '>False</td><td title='Unknown: Unknown | Unknown: Unknown'>2</td><td title='aad_bbaang: Owner | aad_bbaang: User Access Administrator | aad_rmcarden: User Access Administrator | aad_rmcarden: Owner | aad_sbiton2: User Access Administrator | CSM Azure Admin Diego Sverdloff: User Access Administrator | CSM Azure Admin Shmuel Ber: User Access Administrator | cbroker_testsp: Owner | Admin Access to dc8b9d9c-0cf9-446c-9177-12921182f54a AZADCORP: Owner | Custom Access to dc8b9d9c-0cf9-446c-9177-12921182f54a AZADCORP: Contributor | Reader Access dc8b9d9c-0cf9-446c-9177-12921182f54a AZADCORP: Reader | Containers/securityOperators/DefenderForContainersSecurityOperator: Defender Kubernetes API Access | Microsoft Defender for Cloud Servers Scanner Resource Provider: VM Scanner Operator | Unknown Principal: Contributor | 1CICD Certification: Reader | 1CICD Image builder PRE: Contributor | Unknown Principal: Monitoring Reader | fa-github-webhook-router: EventGrid Data Sender | fa-workflow-event-consumer: Azure Event Hubs Data Owner | Unknown Principal: EventGrid EventSubscription Contributor | ui-fa-oso-notifier: Azure Event Hubs Data Receiver | fa-sinker-proxy: EventGrid Data Receiver | fa-sinker-proxy: EventGrid Data Contributor | Github: EventGrid Contributor | Github: EventGrid Data Sender | fa-sinker-proxy: EventGrid EventSubscription Reader | Unknown Principal: EventGrid Data Contributor | Unknown Principal: EventGrid Data Receiver | oss-github: Azure Event Hubs Data Owner | oss-github: EventGrid Data Receiver | Metrics: EventGrid Data Contributor | metrics-ingest: EventGrid Data Contributor | Metrics: EventGrid Data Sender | metrics-ingest: EventGrid Data Receiver | Metrics: Azure Event Hubs Data Sender | Unknown Principal: EventGrid Data Receiver | github-org-events: EventGrid Data Receiver | Github: Azure Event Hubs Data Sender | metrics-nonprod-westus: Azure Event Hubs Data Sender | ci-metrics-pilot: Azure Event Hubs Data Receiver | Cloud Infrastructure Entitlement Management: Reader | CloudPosture/securityOperators/DefenderCSPMSecurityOperator: Defender CSPM Storage Scanner Operator | CloudPosture/securityOperators/DefenderCSPMSecurityOperator: Defender Kubernetes API Access | SqlVmAndArcSqlServersProtection: Virtual Machine Contributor | storageDataScanner: Storage Blob Data Reader | SqlVmAndArcSqlServersProtection: Managed Identity Operator | storageDataScanner: Storage File Data Privileged Reader | SqlVmAndArcSqlServersProtection: Log Analytics Contributor | 8e808fd726b24678aa6cebaf: SQL Security Manager | Azure_Admin: Owner | SIRT_IaaS_Security_Audit: Contributor | d84517051f3a436288bff9f7: Contributor | InfoSecAutomation_grBxdcGCKejpB2kI71OHzCPbPPhrWCK/TfeKLQbsNig=: Contributor | AAD Role - Security Reader: Security Reader | Cloud Brokers: Owner | Microsoft Azure Log Integration Service (azlog) - 9709e9ec-2cb5-4580-8ea8-157e522740ff: Reader | Azure Security Manager: Security Admin | Azure Security Manager: Reader | IT Billing Read Only for Azure: Billing Reader | Wiz for Azure: Management Group Reader | Wiz for Azure: WizCustomRole-2021-01-28-Intel-Devtest-IC-Hybrid | Wiz for Azure: Reader | Wiz for Azure: Azure Kubernetes Service RBAC Reader | Cloud Brokers Reader: Reader | Azure DNS Engineering: Reader | cbroker_testsp: Owner | Eco cost specialist in azure: Cost Management Reader | InfoSecAutomation: Contributor | Azure SEER automatic enforcement: SEER enforcement | Unknown Principal: Reader | Unknown Principal: Virtual Machine Contributor | Unknown Principal: Reader | Unknown Principal: Contributor | 56acafe94e754a5db6eda4ba: Contributor | InfoSecAutomation: Azure Kubernetes Service Cluster Admin Role | InfoSecAutomation: Azure Kubernetes Service RBAC Admin | ac6c4e43cba143689bb93343: Contributor | InfoSecAutomation: Azure Kubernetes Service RBAC Cluster Admin | WizKeyVaultFirewall: Key Vault Contributor | WizKeyVaultAccess: Key Vault Contributor | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Key Vault Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Key Vault Crypto Service Encryption User | 0db888b68baf42419da39dbd: Security Admin | e8ffd98c1d294021b0416ddd: Security Admin | Azure Public Cloud Hosting - Platform Reader: Reader | Azure Public Cloud Hosting - Platform Administrator: Owner | Azure Public Cloud Hosting - Platform Contributor: Contributor | Azure_Admin: Owner | IT Billing Read Only for Azure: Billing Reader | CBIC_Tenable_Reader: Reader | ECO_SPOT_IAP_16553: Cost Management Reader | Unknown Principal: Reader | CloudHealth_PR_IAP_34144: Reader | Unknown Principal: Reader | Men_and_Mice_PR_IAP_8445: Men and Mice Operator | Azure Security Read Only: Reader | Azure Security Admin: Owner | SDI Cloud Operations Azure: Owner | Densify-POC: Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: WizCustomRole1 | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Azure Kubernetes Service RBAC Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Azure Kubernetes Service Cluster User Role | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Storage Blob Data Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Cognitive Services OpenAI User | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: WizDataScanningRole | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: WizServerlessScanningRole | Cyber Defense Perimeter Pentesting: Reader | CrowdStrike TEST CID - Cloud Security Integration: Reader | CrowdStrike TEST CID - Cloud Security Integration: Security Reader | CrowdStrike TEST CID - Cloud Security Integration: Key Vault Reader | CrowdStrike TEST CID - Cloud Security Integration: Azure Kubernetes Service RBAC Reader | WizKeyVaultAccess: Key Vault Contributor | WizKeyVaultFirewall: Key Vault Contributor | Unknown Principal: WizRemediationCustomRole | rubrik_scan: Reader and Data Access | rubrik_scan: Reader | wizazurerr-fa: WizRemediationCustomRole | Azure-Infosecurity-Keyvault-Auditor: Key Vault Reader | Azure-Infosecurity-Keyvault-Auditor: Monitoring Reader | Praetorian Chariot: Security Reader | Praetorian Chariot: Reader | CloudHelper_IAP13321: Subscription Rename | Unknown Principal: WizRemediationCustomRole | RockSteady Cloud Azure: RockSteadyRole | RockSteady Cloud Azure: Azure Kubernetes Service RBAC Reader | RockSteady Cloud Azure: Reader | wiz-jfjcexu4-func: wiz-jfJceXu4-function-role | Azure Public Cloud Hosting - Platform Contributor: Owner | Azure Public Cloud Hosting - Platform Contributor: Contributor | enterprise-hosting-cloud-helper/slots/test: Subscription Rename | enterprise-hosting-cloud-helper: Subscription Rename | enterprise-hosting-cloud-helper/slots/staging: Subscription Rename | Unknown Principal: Reader'>134</td><td title='cbroker_testsp (115bc50e-f248-4244-a146-ade2a6348f07) - Owner [RBAC] | Containers/securityOperators/DefenderForContainersSecurityOperator (d813d1f5-f596-456c-b9ec-cdccaee8cb45) - Defender Kubernetes API Access [RBAC] | Microsoft Defender for Cloud Servers Scanner Resource Provider (f094a5f3-4396-4ed6-86c5-181c709d2c02) - VM Scanner Operator [RBAC] | 1CICD Certification (95f6b320-21ef-4a06-80b0-633ee345d790) - Reader [RBAC] | 1CICD Image builder PRE (24ae01ee-d5f4-4abc-82ed-6b9f4412fa6b) - Contributor [RBAC] | fa-github-webhook-router (d013372d-f839-49ed-a816-b21b61c552ca) - EventGrid Data Sender [RBAC] | fa-workflow-event-consumer (721ed319-62e1-48c0-9d13-2747364bd02c) - Azure Event Hubs Data Owner [RBAC] | ui-fa-oso-notifier (ac2e0d66-cf57-4e29-a09e-84722bc3d783) - Azure Event Hubs Data Receiver [RBAC] | fa-sinker-proxy (90014ad7-7e2a-48b0-941e-70d9b3914c0d) - EventGrid Data Receiver [RBAC] | fa-sinker-proxy (90014ad7-7e2a-48b0-941e-70d9b3914c0d) - EventGrid Data Contributor [RBAC] | Github (645046c3-f1f8-4c6f-8caf-92f3e2999692) - EventGrid Contributor [RBAC] | Github (645046c3-f1f8-4c6f-8caf-92f3e2999692) - EventGrid Data Sender [RBAC] | fa-sinker-proxy (90014ad7-7e2a-48b0-941e-70d9b3914c0d) - EventGrid EventSubscription Reader [RBAC] | oss-github (113bc23e-04a8-46dc-8de1-7d7aad7f3a8e) - Azure Event Hubs Data Owner [RBAC] | oss-github (113bc23e-04a8-46dc-8de1-7d7aad7f3a8e) - EventGrid Data Receiver [RBAC] | Metrics (c2867564-0616-4001-bd0f-c808cbf95454) - EventGrid Data Contributor [RBAC] | metrics-ingest (1a1f500e-b384-47db-8602-a3e29b6393bf) - EventGrid Data Contributor [RBAC] | Metrics (c2867564-0616-4001-bd0f-c808cbf95454) - EventGrid Data Sender [RBAC] | metrics-ingest (1a1f500e-b384-47db-8602-a3e29b6393bf) - EventGrid Data Receiver [RBAC] | Metrics (c2867564-0616-4001-bd0f-c808cbf95454) - Azure Event Hubs Data Sender [RBAC] | github-org-events (62be8d44-10a6-4ce5-9f35-5517776ad22a) - EventGrid Data Receiver [RBAC] | Github (645046c3-f1f8-4c6f-8caf-92f3e2999692) - Azure Event Hubs Data Sender [RBAC] | metrics-nonprod-westus (dd204f92-4501-4f67-b6cd-4b41501d3060) - Azure Event Hubs Data Sender [RBAC] | ci-metrics-pilot (37f6ba5d-2132-4d7b-bf32-231abfb56d43) - Azure Event Hubs Data Receiver [RBAC] | Cloud Infrastructure Entitlement Management (a2334596-f24d-4d12-be6e-2fee7b045547) - Reader [RBAC] | CloudPosture/securityOperators/DefenderCSPMSecurityOperator (3bf6d0f0-430a-456d-bd4b-c83a31482ae9) - Defender CSPM Storage Scanner Operator [RBAC] | CloudPosture/securityOperators/DefenderCSPMSecurityOperator (3bf6d0f0-430a-456d-bd4b-c83a31482ae9) - Defender Kubernetes API Access [RBAC] | SqlVmAndArcSqlServersProtection (40928c77-cfa0-441d-9116-f1b870371de1) - Virtual Machine Contributor [RBAC] | storageDataScanner (10c17777-2ecc-40ce-ab1c-aae96f3a212c) - Storage Blob Data Reader [RBAC] | SqlVmAndArcSqlServersProtection (40928c77-cfa0-441d-9116-f1b870371de1) - Managed Identity Operator [RBAC] | storageDataScanner (10c17777-2ecc-40ce-ab1c-aae96f3a212c) - Storage File Data Privileged Reader [RBAC] | SqlVmAndArcSqlServersProtection (40928c77-cfa0-441d-9116-f1b870371de1) - Log Analytics Contributor [RBAC] | 8e808fd726b24678aa6cebaf (55c82409-6b0b-445c-9510-84d081c95661) - SQL Security Manager [RBAC] | d84517051f3a436288bff9f7 (c7205b9b-0b19-48f8-abce-210f1b2369ee) - Contributor [RBAC] | InfoSecAutomation_grBxdcGCKejpB2kI71OHzCPbPPhrWCK/TfeKLQbsNig= (7c51ef53-655e-40aa-b15a-3a21cc304b53) - Contributor [RBAC] | Microsoft Azure Log Integration Service (azlog) - 9709e9ec-2cb5-4580-8ea8-157e522740ff (33476dc5-2e32-404a-8718-b5b2d5da0a01) - Reader [RBAC] | Wiz for Azure (65e77292-7652-4fc3-97b3-eaa0bad308ff) - Management Group Reader [RBAC] | Wiz for Azure (65e77292-7652-4fc3-97b3-eaa0bad308ff) - WizCustomRole-2021-01-28-Intel-Devtest-IC-Hybrid [RBAC] | Wiz for Azure (65e77292-7652-4fc3-97b3-eaa0bad308ff) - Reader [RBAC] | Wiz for Azure (65e77292-7652-4fc3-97b3-eaa0bad308ff) - Azure Kubernetes Service RBAC Reader [RBAC] | cbroker_testsp (115bc50e-f248-4244-a146-ade2a6348f07) - Owner [RBAC] | InfoSecAutomation (ff1fc891-cbf9-4b4e-9840-176fcf617fdd) - Contributor [RBAC] | Azure SEER automatic enforcement (cad9f67b-2be1-4059-949b-12fad0f0a151) - SEER enforcement [RBAC] | 56acafe94e754a5db6eda4ba (2b534f55-8944-4206-b358-2af006783ba7) - Contributor [RBAC] | InfoSecAutomation (ff1fc891-cbf9-4b4e-9840-176fcf617fdd) - Azure Kubernetes Service Cluster Admin Role [RBAC] | InfoSecAutomation (ff1fc891-cbf9-4b4e-9840-176fcf617fdd) - Azure Kubernetes Service RBAC Admin [RBAC] | ac6c4e43cba143689bb93343 (38493c83-c734-44e5-b2b5-fda0e2a8731f) - Contributor [RBAC] | InfoSecAutomation (ff1fc891-cbf9-4b4e-9840-176fcf617fdd) - Azure Kubernetes Service RBAC Cluster Admin [RBAC] | WizKeyVaultFirewall (e1e91feb-f49c-43d2-b225-6f59e8050192) - Key Vault Contributor [RBAC] | WizKeyVaultAccess (19fae7fa-1512-4546-bb9f-aa943bd9ba48) - Key Vault Contributor [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Key Vault Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Key Vault Crypto Service Encryption User [RBAC] | 0db888b68baf42419da39dbd (2a060361-e374-40d1-807d-b04bb5e8547f) - Security Admin [RBAC] | e8ffd98c1d294021b0416ddd (14fd31d8-7149-4371-b41a-292e18197327) - Security Admin [RBAC] | CBIC_Tenable_Reader (29b8b746-dc08-4c19-a0a1-3f653c40ecd3) - Reader [RBAC] | ECO_SPOT_IAP_16553 (bd123435-87ec-4fd1-b9d7-14dc67113604) - Cost Management Reader [RBAC] | CloudHealth_PR_IAP_34144 (5b8fb4af-0ad7-47e9-a6d6-27d3dba5aa2d) - Reader [RBAC] | Men_and_Mice_PR_IAP_8445 (1675703c-b517-4f03-a796-9668a390dcf7) - Men and Mice Operator [RBAC] | Densify-POC (e6a9b18f-b1bd-44c0-be64-ed3dc0aeb1df) - Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - WizCustomRole1 [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Azure Kubernetes Service RBAC Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Azure Kubernetes Service Cluster User Role [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Storage Blob Data Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Cognitive Services OpenAI User [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - WizDataScanningRole [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - WizServerlessScanningRole [RBAC] | Cyber Defense Perimeter Pentesting (1bf7fd2d-3100-438a-8341-e679afd5f9ae) - Reader [RBAC] | CrowdStrike TEST CID - Cloud Security Integration (508e7ffa-3c4b-4213-ada2-939d4ca91083) - Reader [RBAC] | CrowdStrike TEST CID - Cloud Security Integration (508e7ffa-3c4b-4213-ada2-939d4ca91083) - Security Reader [RBAC] | CrowdStrike TEST CID - Cloud Security Integration (508e7ffa-3c4b-4213-ada2-939d4ca91083) - Key Vault Reader [RBAC] | CrowdStrike TEST CID - Cloud Security Integration (508e7ffa-3c4b-4213-ada2-939d4ca91083) - Azure Kubernetes Service RBAC Reader [RBAC] | WizKeyVaultAccess (ccaf9819-a25d-4040-a403-c3f71b92bab4) - Key Vault Contributor [RBAC] | WizKeyVaultFirewall (46e69860-91e0-44d3-a2b5-1fe8777cfba1) - Key Vault Contributor [RBAC] | rubrik_scan (677a6233-f344-4f2c-960a-3df08bb36ef3) - Reader and Data Access [RBAC] | rubrik_scan (677a6233-f344-4f2c-960a-3df08bb36ef3) - Reader [RBAC] | wizazurerr-fa (c5a05c6b-3618-4b09-9664-03bef4ea7b67) - WizRemediationCustomRole [RBAC] | Praetorian Chariot (8115ad4c-1930-4f9f-8bc3-1befd822bf04) - Security Reader [RBAC] | Praetorian Chariot (8115ad4c-1930-4f9f-8bc3-1befd822bf04) - Reader [RBAC] | CloudHelper_IAP13321 (4875e471-1ab4-4656-b162-20b9c0bcc6de) - Subscription Rename [RBAC] | RockSteady Cloud Azure (005288a3-f653-4e8c-bcdf-ec797ae662f1) - RockSteadyRole [RBAC] | RockSteady Cloud Azure (005288a3-f653-4e8c-bcdf-ec797ae662f1) - Azure Kubernetes Service RBAC Reader [RBAC] | RockSteady Cloud Azure (005288a3-f653-4e8c-bcdf-ec797ae662f1) - Reader [RBAC] | wiz-jfjcexu4-func (cb7142af-92fe-43c4-a1d7-b7f9baa7d2b3) - wiz-jfJceXu4-function-role [RBAC] | enterprise-hosting-cloud-helper/slots/test (aa41a440-20bc-4a6d-8d03-338825dc12fb) - Subscription Rename [RBAC] | enterprise-hosting-cloud-helper (6c3796e5-908e-497a-b1ad-ff17813bad15) - Subscription Rename [RBAC] | enterprise-hosting-cloud-helper/slots/staging (1463e043-3f16-454d-93a7-e72fa5e108bd) - Subscription Rename [RBAC]'>87</td><td title='Connected: cbroker_testsp (Owner) | Connected: Containers/securityOperators/DefenderForContainersSecurityOperator (Defender Kubernetes API Access) | Connected: Microsoft Defender for Cloud Servers Scanner Resource Provider (VM Scanner Operator) | Connected: 1CICD Certification (Reader) | Connected: 1CICD Image builder PRE (Contributor) | Connected: fa-github-webhook-router (EventGrid Data Sender) | Connected: fa-workflow-event-consumer (Azure Event Hubs Data Owner) | Connected: ui-fa-oso-notifier (Azure Event Hubs Data Receiver) | Connected: ui-fa-oso-notifier (Azure Event Hubs Data Receiver) | Connected: fa-sinker-proxy (EventGrid Data Receiver) | Connected: fa-sinker-proxy (EventGrid Data Contributor) | Connected: Github (EventGrid Contributor) | Connected: Github (EventGrid Data Sender) | Connected: fa-sinker-proxy (EventGrid EventSubscription Reader) | Connected: oss-github (Azure Event Hubs Data Owner) | Connected: oss-github (EventGrid Data Receiver) | Connected: Metrics (EventGrid Data Contributor) | Connected: metrics-ingest (EventGrid Data Contributor) | Connected: Metrics (EventGrid Data Sender) | Connected: metrics-ingest (EventGrid Data Receiver) | Connected: Metrics (Azure Event Hubs Data Sender) | Connected: github-org-events (EventGrid Data Receiver) | Connected: Github (Azure Event Hubs Data Sender) | Connected: metrics-nonprod-westus (Azure Event Hubs Data Sender) | Connected: ci-metrics-pilot (Azure Event Hubs Data Receiver) | Connected: Cloud Infrastructure Entitlement Management (Reader) | Connected: CloudPosture/securityOperators/DefenderCSPMSecurityOperator (Defender CSPM Storage Scanner Operator) | Connected: CloudPosture/securityOperators/DefenderCSPMSecurityOperator (Defender Kubernetes API Access) | Connected: SqlVmAndArcSqlServersProtection (Virtual Machine Contributor) | Connected: storageDataScanner (Storage Blob Data Reader) | Connected: SqlVmAndArcSqlServersProtection (Managed Identity Operator) | Connected: storageDataScanner (Storage File Data Privileged Reader) | Connected: SqlVmAndArcSqlServersProtection (Log Analytics Contributor) | Connected: 8e808fd726b24678aa6cebaf (SQL Security Manager) | Connected: d84517051f3a436288bff9f7 (Contributor) | Connected: InfoSecAutomation_grBxdcGCKejpB2kI71OHzCPbPPhrWCK/TfeKLQbsNig= (Contributor) | Connected: Microsoft Azure Log Integration Service (azlog) - 9709e9ec-2cb5-4580-8ea8-157e522740ff (Reader) | Connected: Wiz for Azure (Management Group Reader) | Connected: Wiz for Azure (WizCustomRole-2021-01-28-Intel-Devtest-IC-Hybrid) | Connected: Wiz for Azure (Reader) | Connected: Wiz for Azure (Azure Kubernetes Service RBAC Reader) | Connected: cbroker_testsp (Owner) | Connected: InfoSecAutomation (Contributor) | Connected: Azure SEER automatic enforcement (SEER enforcement) | Connected: 56acafe94e754a5db6eda4ba (Contributor) | Connected: InfoSecAutomation (Azure Kubernetes Service Cluster Admin Role) | Connected: InfoSecAutomation (Azure Kubernetes Service RBAC Admin) | Connected: ac6c4e43cba143689bb93343 (Contributor) | Connected: InfoSecAutomation (Azure Kubernetes Service RBAC Cluster Admin) | Connected: WizKeyVaultFirewall (Key Vault Contributor) | Connected: WizKeyVaultAccess (Key Vault Contributor) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Key Vault Reader) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Key Vault Crypto Service Encryption User) | Connected: 0db888b68baf42419da39dbd (Security Admin) | Connected: e8ffd98c1d294021b0416ddd (Security Admin) | Connected: CBIC_Tenable_Reader (Reader) | Connected: ECO_SPOT_IAP_16553 (Cost Management Reader) | Connected: CloudHealth_PR_IAP_34144 (Reader) | Connected: Men_and_Mice_PR_IAP_8445 (Men and Mice Operator) | Connected: Densify-POC (Reader) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (WizCustomRole1) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Reader) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Azure Kubernetes Service RBAC Reader) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Azure Kubernetes Service Cluster User Role) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Storage Blob Data Reader) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Cognitive Services OpenAI User) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (WizDataScanningRole) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (WizServerlessScanningRole) | Connected: Cyber Defense Perimeter Pentesting (Reader) | Connected: CrowdStrike TEST CID - Cloud Security Integration (Reader) | Connected: CrowdStrike TEST CID - Cloud Security Integration (Security Reader) | Connected: CrowdStrike TEST CID - Cloud Security Integration (Key Vault Reader) | Connected: CrowdStrike TEST CID - Cloud Security Integration (Azure Kubernetes Service RBAC Reader) | Connected: WizKeyVaultAccess (Key Vault Contributor) | Connected: WizKeyVaultFirewall (Key Vault Contributor) | Connected: rubrik_scan (Reader and Data Access) | Connected: rubrik_scan (Reader) | Connected: wizazurerr-fa (WizRemediationCustomRole) | Connected: Praetorian Chariot (Security Reader) | Connected: Praetorian Chariot (Reader) | Connected: CloudHelper_IAP13321 (Subscription Rename) | Connected: RockSteady Cloud Azure (RockSteadyRole) | Connected: RockSteady Cloud Azure (Azure Kubernetes Service RBAC Reader) | Connected: RockSteady Cloud Azure (Reader) | Connected: wiz-jfjcexu4-func (wiz-jfJceXu4-function-role) | Connected: enterprise-hosting-cloud-helper/slots/test (Subscription Rename) | Connected: enterprise-hosting-cloud-helper (Subscription Rename) | Connected: enterprise-hosting-cloud-helper/slots/staging (Subscription Rename)'>88</td><td title='Principal ID: '>False</td><td title='User Assigned IDs: '>0</td><td>Unknown</td><td>Unknown</td><td title='Network ACLs: False'>Enabled</td><td>0</td><td style='text-align: center;'>0</td><td style='text-align: center;'>0</td><td style='text-align: center;'>0</td><td>Unknown</td><td title=''>Not Determined</td><td><span class='action-link' onclick='toggleActionItems("actions_2")'>View Actions</span><div id='actions_2' class='action-details'><h5>Priority Actions for kv-pre-ghacts-clctr:</h5><ul><li>Vault analysis completed successfully - no major issues found</li></ul><p><strong>Impact:</strong> Implementing these recommendations will improve security posture and compliance score.</p></div></td></tr>
<tr><td title='9590a312-8cb4-433b-bf12-8897052f5d02'>1ci-prod-metrics</td><td><strong>kv-azure2cyberark</strong></td><td>westus</td><td>rg_azure2cyberark</td><td><span class='environment-Unknown'>Unknown</span></td><td title=''>Not Determined</td><td class='number-cell'>0</td><td class='number-cell'>0</td><td class='number-cell'>0</td><td><span style='color: #ffc107; font-weight: bold;'>85%</span></td><td><span style='color: #ffc107; font-weight: bold;'>82%</span></td><td><span style='color: #ffc107; font-weight: bold;'>Medium</span></td><td><span class='partially-compliant'>Compliant</span></td><td><span style='color: #ffc107; font-weight: bold;' title='Company Framework Score'>82%</span></td><td>True</td><td title='AuditEvent,AzurePolicyEvaluationDetails'>AuditEvent, AzurePolicyEvaluationDetails</td><td title='Workspace: '>False</td><td title='Namespace: InfoSecEventHubwestus, Hub: '>True</td><td title='Storage: '>False</td><td title='Unknown: Unknown | Unknown: Unknown'>2</td><td title='aad_bbaang: Owner | aad_bbaang: User Access Administrator | aad_rmcarden: User Access Administrator | aad_rmcarden: Owner | aad_sbiton2: User Access Administrator | CSM Azure Admin Diego Sverdloff: User Access Administrator | CSM Azure Admin Shmuel Ber: User Access Administrator | cbroker_testsp: Owner | Admin Access to 9590a312-8cb4-433b-bf12-8897052f5d02 AZADCORP: Owner | Custom Access to 9590a312-8cb4-433b-bf12-8897052f5d02 AZADCORP: Contributor | Reader Access 9590a312-8cb4-433b-bf12-8897052f5d02 AZADCORP: Reader | Microsoft Defender for Cloud Servers Scanner Resource Provider: VM Scanner Operator | Containers/securityOperators/DefenderForContainersSecurityOperator: Defender Kubernetes API Access | 1CICD Image builder PROD: Contributor | Unknown Principal: Contributor | 1CICD metrics packer: Contributor | 1CICD metrics github actions: Contributor | 1CICD Certification: Reader | Unknown Principal: Azure Event Hubs Data Receiver | Cloud Infrastructure Entitlement Management: Reader | CloudPosture/securityOperators/DefenderCSPMSecurityOperator: Defender CSPM Storage Scanner Operator | CloudPosture/securityOperators/DefenderCSPMSecurityOperator: Defender Kubernetes API Access | storageDataScanner: Storage Blob Data Reader | SqlVmAndArcSqlServersProtection: Virtual Machine Contributor | storageDataScanner: Storage File Data Privileged Reader | SqlVmAndArcSqlServersProtection: Managed Identity Operator | SqlVmAndArcSqlServersProtection: Log Analytics Contributor | 9ded5f0326994895b9225fc6: SQL Security Manager | Azure_Admin: Owner | Cloud Brokers: Owner | SIRT_IaaS_Security_Audit: Contributor | InfoSecAutomation_grBxdcGCKejpB2kI71OHzCPbPPhrWCK/TfeKLQbsNig=: Contributor | 223fb17b325340c6af5810d1: Contributor | Microsoft Azure Log Integration Service (azlog) - 9709e9ec-2cb5-4580-8ea8-157e522740ff: Reader | Azure Security Manager: Security Admin | Azure Security Manager: Reader | cbroker_testsp: Owner | Eco cost specialist in azure: Cost Management Reader | Cloud Brokers Reader: Reader | Azure DNS Engineering: Reader | Unknown Principal: Reader | Unknown Principal: Virtual Machine Contributor | Unknown Principal: Reader | Unknown Principal: Contributor | e5065094a832493786b7d254: Contributor | InfoSecAutomation: Contributor | Azure SEER automatic enforcement: SEER enforcement | InfoSecAutomation: Azure Kubernetes Service Cluster Admin Role | InfoSecAutomation: Azure Kubernetes Service RBAC Admin | 5b40164fa23b4cb7af13ac0f: Contributor | InfoSecAutomation: Azure Kubernetes Service RBAC Cluster Admin | WizKeyVaultAccess: Key Vault Contributor | WizKeyVaultFirewall: Key Vault Contributor | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Key Vault Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Key Vault Crypto Service Encryption User | Unknown Principal: Security Admin | 7287972431ab4d2f8e54b1b9: Security Admin | 6d55668aa3534cd4ad9b30d0: Security Admin | Unknown Principal: Security Admin | Azure Public Cloud Hosting - Platform Reader: Reader | Azure Public Cloud Hosting - Platform Administrator: Owner | Azure Public Cloud Hosting - Platform Contributor: Contributor | IT Billing Read Only for Azure: Billing Reader | Wiz for Azure: Management Group Reader | Wiz for Azure: WizCustomRole-2021-01-28-Intel-Production-IC-Hybrid | Wiz for Azure: Reader | Wiz for Azure: Azure Kubernetes Service RBAC Reader | Wiz for Azure: Azure Kubernetes Service Cluster User Role | Azure_Admin: Owner | IT Billing Read Only for Azure: Billing Reader | CBIC_Tenable_Reader: Reader | ECO_SPOT_IAP_16553: Cost Management Reader | Unknown Principal: Reader | CloudHealth_PR_IAP_34144: Reader | Unknown Principal: Reader | Men_and_Mice_PR_IAP_8445: Men and Mice Operator | Azure Security Read Only: Reader | Azure Security Admin: Owner | SDI Cloud Operations Azure: Owner | Densify-POC: Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: WizCustomRole1 | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Azure Kubernetes Service RBAC Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Azure Kubernetes Service Cluster User Role | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Storage Blob Data Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Cognitive Services OpenAI User | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: WizDataScanningRole | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: WizServerlessScanningRole | Cyber Defense Perimeter Pentesting: Reader | CrowdStrike TEST CID - Cloud Security Integration: Reader | CrowdStrike TEST CID - Cloud Security Integration: Security Reader | CrowdStrike TEST CID - Cloud Security Integration: Key Vault Reader | CrowdStrike TEST CID - Cloud Security Integration: Azure Kubernetes Service RBAC Reader | WizKeyVaultAccess: Key Vault Contributor | WizKeyVaultFirewall: Key Vault Contributor | Unknown Principal: WizRemediationCustomRole | rubrik_scan: Reader and Data Access | rubrik_scan: Reader | wizazurerr-fa: WizRemediationCustomRole | Azure-Infosecurity-Keyvault-Auditor: Key Vault Reader | Azure-Infosecurity-Keyvault-Auditor: Monitoring Reader | Praetorian Chariot: Security Reader | Praetorian Chariot: Reader | CloudHelper_IAP13321: Subscription Rename | Unknown Principal: WizRemediationCustomRole | RockSteady Cloud Azure: RockSteadyRole | RockSteady Cloud Azure: Azure Kubernetes Service RBAC Reader | RockSteady Cloud Azure: Reader | wiz-jfjcexu4-func: wiz-jfJceXu4-function-role | Azure Public Cloud Hosting - Platform Contributor: Owner | Azure Public Cloud Hosting - Platform Contributor: Contributor | enterprise-hosting-cloud-helper/slots/test: Subscription Rename | enterprise-hosting-cloud-helper: Subscription Rename | enterprise-hosting-cloud-helper/slots/staging: Subscription Rename | Unknown Principal: Reader'>115</td><td title='cbroker_testsp (115bc50e-f248-4244-a146-ade2a6348f07) - Owner [RBAC] | Microsoft Defender for Cloud Servers Scanner Resource Provider (f094a5f3-4396-4ed6-86c5-181c709d2c02) - VM Scanner Operator [RBAC] | Containers/securityOperators/DefenderForContainersSecurityOperator (124c2136-3efa-42cd-b522-a6f2833d915f) - Defender Kubernetes API Access [RBAC] | 1CICD Image builder PROD (27f2da85-2c46-462f-b2a7-cdb983c83350) - Contributor [RBAC] | 1CICD metrics packer (5b1c0e52-c18c-4f58-82b9-59b0912c53bd) - Contributor [RBAC] | 1CICD metrics github actions (0df3ad47-fbde-458a-a083-f46fd74fa08d) - Contributor [RBAC] | 1CICD Certification (95f6b320-21ef-4a06-80b0-633ee345d790) - Reader [RBAC] | Cloud Infrastructure Entitlement Management (a2334596-f24d-4d12-be6e-2fee7b045547) - Reader [RBAC] | CloudPosture/securityOperators/DefenderCSPMSecurityOperator (fe651f19-fb77-4966-b542-c36e8cbffdbf) - Defender CSPM Storage Scanner Operator [RBAC] | CloudPosture/securityOperators/DefenderCSPMSecurityOperator (fe651f19-fb77-4966-b542-c36e8cbffdbf) - Defender Kubernetes API Access [RBAC] | storageDataScanner (93c03091-d48d-43b3-9a02-bec65e86e006) - Storage Blob Data Reader [RBAC] | SqlVmAndArcSqlServersProtection (dd7f4718-7380-4fb1-a269-2206ea9dab6a) - Virtual Machine Contributor [RBAC] | storageDataScanner (93c03091-d48d-43b3-9a02-bec65e86e006) - Storage File Data Privileged Reader [RBAC] | SqlVmAndArcSqlServersProtection (dd7f4718-7380-4fb1-a269-2206ea9dab6a) - Managed Identity Operator [RBAC] | SqlVmAndArcSqlServersProtection (dd7f4718-7380-4fb1-a269-2206ea9dab6a) - Log Analytics Contributor [RBAC] | 9ded5f0326994895b9225fc6 (8e447718-6df5-45f2-a2ac-3af08887f909) - SQL Security Manager [RBAC] | InfoSecAutomation_grBxdcGCKejpB2kI71OHzCPbPPhrWCK/TfeKLQbsNig= (7c51ef53-655e-40aa-b15a-3a21cc304b53) - Contributor [RBAC] | 223fb17b325340c6af5810d1 (832409bf-6a04-455e-9b6d-c84b009bac66) - Contributor [RBAC] | Microsoft Azure Log Integration Service (azlog) - 9709e9ec-2cb5-4580-8ea8-157e522740ff (33476dc5-2e32-404a-8718-b5b2d5da0a01) - Reader [RBAC] | cbroker_testsp (115bc50e-f248-4244-a146-ade2a6348f07) - Owner [RBAC] | e5065094a832493786b7d254 (9c7ff493-8752-4226-a548-dac1bf7f300a) - Contributor [RBAC] | InfoSecAutomation (ff1fc891-cbf9-4b4e-9840-176fcf617fdd) - Contributor [RBAC] | Azure SEER automatic enforcement (cad9f67b-2be1-4059-949b-12fad0f0a151) - SEER enforcement [RBAC] | InfoSecAutomation (ff1fc891-cbf9-4b4e-9840-176fcf617fdd) - Azure Kubernetes Service Cluster Admin Role [RBAC] | InfoSecAutomation (ff1fc891-cbf9-4b4e-9840-176fcf617fdd) - Azure Kubernetes Service RBAC Admin [RBAC] | 5b40164fa23b4cb7af13ac0f (d6060f9e-26db-4108-b51b-49651969406a) - Contributor [RBAC] | InfoSecAutomation (ff1fc891-cbf9-4b4e-9840-176fcf617fdd) - Azure Kubernetes Service RBAC Cluster Admin [RBAC] | WizKeyVaultAccess (70809f53-421f-4045-8157-435b9a993609) - Key Vault Contributor [RBAC] | WizKeyVaultFirewall (99ed0593-5434-4a0e-a7af-948eeb0cd472) - Key Vault Contributor [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Key Vault Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Key Vault Crypto Service Encryption User [RBAC] | 7287972431ab4d2f8e54b1b9 (e8d36191-ed43-46a5-9740-46401067badd) - Security Admin [RBAC] | 6d55668aa3534cd4ad9b30d0 (e4d0aa84-1f01-4672-b4d6-74fd646344f8) - Security Admin [RBAC] | Wiz for Azure (65e77292-7652-4fc3-97b3-eaa0bad308ff) - Management Group Reader [RBAC] | Wiz for Azure (65e77292-7652-4fc3-97b3-eaa0bad308ff) - WizCustomRole-2021-01-28-Intel-Production-IC-Hybrid [RBAC] | Wiz for Azure (65e77292-7652-4fc3-97b3-eaa0bad308ff) - Reader [RBAC] | Wiz for Azure (65e77292-7652-4fc3-97b3-eaa0bad308ff) - Azure Kubernetes Service RBAC Reader [RBAC] | Wiz for Azure (65e77292-7652-4fc3-97b3-eaa0bad308ff) - Azure Kubernetes Service Cluster User Role [RBAC] | CBIC_Tenable_Reader (29b8b746-dc08-4c19-a0a1-3f653c40ecd3) - Reader [RBAC] | ECO_SPOT_IAP_16553 (bd123435-87ec-4fd1-b9d7-14dc67113604) - Cost Management Reader [RBAC] | CloudHealth_PR_IAP_34144 (5b8fb4af-0ad7-47e9-a6d6-27d3dba5aa2d) - Reader [RBAC] | Men_and_Mice_PR_IAP_8445 (1675703c-b517-4f03-a796-9668a390dcf7) - Men and Mice Operator [RBAC] | Densify-POC (e6a9b18f-b1bd-44c0-be64-ed3dc0aeb1df) - Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - WizCustomRole1 [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Azure Kubernetes Service RBAC Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Azure Kubernetes Service Cluster User Role [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Storage Blob Data Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Cognitive Services OpenAI User [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - WizDataScanningRole [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - WizServerlessScanningRole [RBAC] | Cyber Defense Perimeter Pentesting (1bf7fd2d-3100-438a-8341-e679afd5f9ae) - Reader [RBAC] | CrowdStrike TEST CID - Cloud Security Integration (508e7ffa-3c4b-4213-ada2-939d4ca91083) - Reader [RBAC] | CrowdStrike TEST CID - Cloud Security Integration (508e7ffa-3c4b-4213-ada2-939d4ca91083) - Security Reader [RBAC] | CrowdStrike TEST CID - Cloud Security Integration (508e7ffa-3c4b-4213-ada2-939d4ca91083) - Key Vault Reader [RBAC] | CrowdStrike TEST CID - Cloud Security Integration (508e7ffa-3c4b-4213-ada2-939d4ca91083) - Azure Kubernetes Service RBAC Reader [RBAC] | WizKeyVaultAccess (ccaf9819-a25d-4040-a403-c3f71b92bab4) - Key Vault Contributor [RBAC] | WizKeyVaultFirewall (46e69860-91e0-44d3-a2b5-1fe8777cfba1) - Key Vault Contributor [RBAC] | rubrik_scan (677a6233-f344-4f2c-960a-3df08bb36ef3) - Reader and Data Access [RBAC] | rubrik_scan (677a6233-f344-4f2c-960a-3df08bb36ef3) - Reader [RBAC] | wizazurerr-fa (c5a05c6b-3618-4b09-9664-03bef4ea7b67) - WizRemediationCustomRole [RBAC] | Praetorian Chariot (8115ad4c-1930-4f9f-8bc3-1befd822bf04) - Security Reader [RBAC] | Praetorian Chariot (8115ad4c-1930-4f9f-8bc3-1befd822bf04) - Reader [RBAC] | CloudHelper_IAP13321 (4875e471-1ab4-4656-b162-20b9c0bcc6de) - Subscription Rename [RBAC] | RockSteady Cloud Azure (005288a3-f653-4e8c-bcdf-ec797ae662f1) - RockSteadyRole [RBAC] | RockSteady Cloud Azure (005288a3-f653-4e8c-bcdf-ec797ae662f1) - Azure Kubernetes Service RBAC Reader [RBAC] | RockSteady Cloud Azure (005288a3-f653-4e8c-bcdf-ec797ae662f1) - Reader [RBAC] | wiz-jfjcexu4-func (cb7142af-92fe-43c4-a1d7-b7f9baa7d2b3) - wiz-jfJceXu4-function-role [RBAC] | enterprise-hosting-cloud-helper/slots/test (aa41a440-20bc-4a6d-8d03-338825dc12fb) - Subscription Rename [RBAC] | enterprise-hosting-cloud-helper (6c3796e5-908e-497a-b1ad-ff17813bad15) - Subscription Rename [RBAC] | enterprise-hosting-cloud-helper/slots/staging (1463e043-3f16-454d-93a7-e72fa5e108bd) - Subscription Rename [RBAC]'>71</td><td title='Connected: cbroker_testsp (Owner) | Connected: Containers/securityOperators/DefenderForContainersSecurityOperator (Defender Kubernetes API Access) | Connected: Microsoft Defender for Cloud Servers Scanner Resource Provider (VM Scanner Operator) | Connected: 1CICD Certification (Reader) | Connected: 1CICD Image builder PRE (Contributor) | Connected: fa-github-webhook-router (EventGrid Data Sender) | Connected: fa-workflow-event-consumer (Azure Event Hubs Data Owner) | Connected: ui-fa-oso-notifier (Azure Event Hubs Data Receiver) | Connected: fa-sinker-proxy (EventGrid Data Receiver) | Connected: fa-sinker-proxy (EventGrid Data Contributor) | Connected: Github (EventGrid Contributor) | Connected: Github (EventGrid Data Sender) | Connected: fa-sinker-proxy (EventGrid EventSubscription Reader) | Connected: oss-github (Azure Event Hubs Data Owner) | Connected: oss-github (EventGrid Data Receiver) | Connected: Metrics (EventGrid Data Contributor) | Connected: metrics-ingest (EventGrid Data Contributor) | Connected: Metrics (EventGrid Data Sender) | Connected: metrics-ingest (EventGrid Data Receiver) | Connected: Metrics (Azure Event Hubs Data Sender) | Connected: github-org-events (EventGrid Data Receiver) | Connected: Github (Azure Event Hubs Data Sender) | Connected: metrics-nonprod-westus (Azure Event Hubs Data Sender) | Connected: ci-metrics-pilot (Azure Event Hubs Data Receiver) | Connected: Cloud Infrastructure Entitlement Management (Reader) | Connected: CloudPosture/securityOperators/DefenderCSPMSecurityOperator (Defender CSPM Storage Scanner Operator) | Connected: CloudPosture/securityOperators/DefenderCSPMSecurityOperator (Defender Kubernetes API Access) | Connected: SqlVmAndArcSqlServersProtection (Virtual Machine Contributor) | Connected: storageDataScanner (Storage Blob Data Reader) | Connected: SqlVmAndArcSqlServersProtection (Managed Identity Operator) | Connected: storageDataScanner (Storage File Data Privileged Reader) | Connected: SqlVmAndArcSqlServersProtection (Log Analytics Contributor) | Connected: 8e808fd726b24678aa6cebaf (SQL Security Manager) | Connected: d84517051f3a436288bff9f7 (Contributor) | Connected: InfoSecAutomation_grBxdcGCKejpB2kI71OHzCPbPPhrWCK/TfeKLQbsNig= (Contributor) | Connected: Microsoft Azure Log Integration Service (azlog) - 9709e9ec-2cb5-4580-8ea8-157e522740ff (Reader) | Connected: Wiz for Azure (Management Group Reader) | Connected: Wiz for Azure (WizCustomRole-2021-01-28-Intel-Devtest-IC-Hybrid) | Connected: Wiz for Azure (Reader) | Connected: Wiz for Azure (Azure Kubernetes Service RBAC Reader) | Connected: cbroker_testsp (Owner) | Connected: InfoSecAutomation (Contributor) | Connected: Azure SEER automatic enforcement (SEER enforcement) | Connected: 56acafe94e754a5db6eda4ba (Contributor) | Connected: InfoSecAutomation (Azure Kubernetes Service Cluster Admin Role) | Connected: InfoSecAutomation (Azure Kubernetes Service RBAC Admin) | Connected: ac6c4e43cba143689bb93343 (Contributor) | Connected: InfoSecAutomation (Azure Kubernetes Service RBAC Cluster Admin) | Connected: WizKeyVaultFirewall (Key Vault Contributor) | Connected: WizKeyVaultAccess (Key Vault Contributor) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Key Vault Reader) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Key Vault Crypto Service Encryption User) | Connected: 0db888b68baf42419da39dbd (Security Admin) | Connected: e8ffd98c1d294021b0416ddd (Security Admin) | Connected: CBIC_Tenable_Reader (Reader) | Connected: ECO_SPOT_IAP_16553 (Cost Management Reader) | Connected: CloudHealth_PR_IAP_34144 (Reader) | Connected: Men_and_Mice_PR_IAP_8445 (Men and Mice Operator) | Connected: Densify-POC (Reader) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (WizCustomRole1) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Reader) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Azure Kubernetes Service RBAC Reader) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Azure Kubernetes Service Cluster User Role) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Storage Blob Data Reader) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Cognitive Services OpenAI User) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (WizDataScanningRole) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (WizServerlessScanningRole) | Connected: Cyber Defense Perimeter Pentesting (Reader) | Connected: CrowdStrike TEST CID - Cloud Security Integration (Reader) | Connected: CrowdStrike TEST CID - Cloud Security Integration (Security Reader) | Connected: CrowdStrike TEST CID - Cloud Security Integration (Key Vault Reader) | Connected: CrowdStrike TEST CID - Cloud Security Integration (Azure Kubernetes Service RBAC Reader) | Connected: WizKeyVaultAccess (Key Vault Contributor) | Connected: WizKeyVaultFirewall (Key Vault Contributor) | Connected: rubrik_scan (Reader and Data Access) | Connected: rubrik_scan (Reader) | Connected: wizazurerr-fa (WizRemediationCustomRole) | Connected: Praetorian Chariot (Security Reader) | Connected: Praetorian Chariot (Reader) | Connected: CloudHelper_IAP13321 (Subscription Rename) | Connected: RockSteady Cloud Azure (RockSteadyRole) | Connected: RockSteady Cloud Azure (Azure Kubernetes Service RBAC Reader) | Connected: RockSteady Cloud Azure (Reader) | Connected: wiz-jfjcexu4-func (wiz-jfJceXu4-function-role) | Connected: enterprise-hosting-cloud-helper/slots/test (Subscription Rename) | Connected: enterprise-hosting-cloud-helper (Subscription Rename) | Connected: enterprise-hosting-cloud-helper/slots/staging (Subscription Rename)'>87</td><td title='Principal ID: '>False</td><td title='User Assigned IDs: '>0</td><td>Unknown</td><td>Unknown</td><td title='Network ACLs: False'>Enabled</td><td>0</td><td style='text-align: center;'>0</td><td style='text-align: center;'>0</td><td style='text-align: center;'>0</td><td>Unknown</td><td title=''>Not Determined</td><td><span class='action-link' onclick='toggleActionItems("actions_3")'>View Actions</span><div id='actions_3' class='action-details'><h5>Priority Actions for kv-azure2cyberark:</h5><ul><li>Vault analysis completed successfully - no major issues found</li></ul><p><strong>Impact:</strong> Implementing these recommendations will improve security posture and compliance score.</p></div></td></tr>
<tr><td title='feff5c33-098d-41a4-b715-45431385fdb4'>1Source Pre-Production</td><td><strong>test-key-vault-fgalind1</strong></td><td>eastus</td><td>DefaultResourceGroup-WUS</td><td><span class='environment-Unknown'>Unknown</span></td><td title=''>Not Determined</td><td class='number-cell'>0</td><td class='number-cell'>0</td><td class='number-cell'>0</td><td><span style='color: #ffc107; font-weight: bold;'>85%</span></td><td><span style='color: #ffc107; font-weight: bold;'>82%</span></td><td><span style='color: #ffc107; font-weight: bold;'>Medium</span></td><td><span class='partially-compliant'>Compliant</span></td><td><span style='color: #ffc107; font-weight: bold;' title='Company Framework Score'>82%</span></td><td>True</td><td title='AuditEvent,AzurePolicyEvaluationDetails'>AuditEvent, AzurePolicyEvaluationDetails</td><td title='Workspace: '>False</td><td title='Namespace: InfoSecEventHubeastus, Hub: '>True</td><td title='Storage: '>False</td><td title='Unknown: Unknown | Unknown: Unknown | Unknown: Unknown | Unknown: Unknown'>4</td><td title='aad_bbaang: Owner | aad_bbaang: User Access Administrator | aad_rmcarden: User Access Administrator | aad_rmcarden: Owner | aad_sbiton2: User Access Administrator | CSM Azure Admin Diego Sverdloff: User Access Administrator | CSM Azure Admin Shmuel Ber: User Access Administrator | MoveCollection-eus-wus-eus2: User Access Administrator | MoveCollection-eus-wus-eus2: Contributor | Unknown Principal: Contributor | 1Source runner image builder: Contributor | azure-cli-2023-06-09-10-58-33: Contributor | 1Source-Bicep-Deployment: Contributor | 1Source_cd_IAP_23071: Contributor | 1Source Image builder PRE: Contributor | Microsoft Defender for Cloud Servers Scanner Resource Provider: VM Scanner Operator | 1SCM-AKS-Arc: Contributor | Unknown Principal: Owner | Unknown Principal: Azure Event Hubs Data Receiver | webhook pre: Contributor | webhook pre: Role Based Access Control Administrator | site-reco-etj-asr-automationaccount: Contributor | defaultva-vzi-asr-automationaccount: Contributor | Engineering splunk for 1source webhook event hub: Azure Event Hubs Data Receiver | Cloud Infrastructure Entitlement Management: Reader | CloudPosture/securityOperators/DefenderCSPMSecurityOperator: Defender CSPM Storage Scanner Operator | CloudPosture/securityOperators/DefenderCSPMSecurityOperator: Defender Kubernetes API Access | storageDataScanner: Storage Blob Data Reader | storageDataScanner: Storage File Data Privileged Reader | SqlVmAndArcSqlServersProtection: Virtual Machine Contributor | SqlVmAndArcSqlServersProtection: Managed Identity Operator | SqlVmAndArcSqlServersProtection: Log Analytics Contributor | Admin Access to feff5c33-098d-41a4-b715-45431385fdb4 AZADCORP: Owner | Custom Access to feff5c33-098d-41a4-b715-45431385fdb4 AZADCORP: Contributor | Read Only Access to feff5c33-098d-41a4-b715-45431385fdb4 AZADCORP: Reader | 1Source_Pre-Production_NewRelic_IAP_23071: Reader | 9ded5f0326994895b9225fc6: SQL Security Manager | Azure_Admin: Owner | Cloud Brokers: Owner | SIRT_IaaS_Security_Audit: Contributor | InfoSecAutomation_grBxdcGCKejpB2kI71OHzCPbPPhrWCK/TfeKLQbsNig=: Contributor | 223fb17b325340c6af5810d1: Contributor | Microsoft Azure Log Integration Service (azlog) - 9709e9ec-2cb5-4580-8ea8-157e522740ff: Reader | Azure Security Manager: Security Admin | Azure Security Manager: Reader | cbroker_testsp: Owner | Eco cost specialist in azure: Cost Management Reader | Cloud Brokers Reader: Reader | Azure DNS Engineering: Reader | Unknown Principal: Reader | Unknown Principal: Virtual Machine Contributor | Unknown Principal: Reader | Unknown Principal: Contributor | e5065094a832493786b7d254: Contributor | InfoSecAutomation: Contributor | Azure SEER automatic enforcement: SEER enforcement | InfoSecAutomation: Azure Kubernetes Service Cluster Admin Role | InfoSecAutomation: Azure Kubernetes Service RBAC Admin | 5b40164fa23b4cb7af13ac0f: Contributor | InfoSecAutomation: Azure Kubernetes Service RBAC Cluster Admin | WizKeyVaultAccess: Key Vault Contributor | WizKeyVaultFirewall: Key Vault Contributor | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Key Vault Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Key Vault Crypto Service Encryption User | Unknown Principal: Security Admin | 7287972431ab4d2f8e54b1b9: Security Admin | 6d55668aa3534cd4ad9b30d0: Security Admin | Unknown Principal: Security Admin | Azure Public Cloud Hosting - Platform Reader: Reader | Azure Public Cloud Hosting - Platform Administrator: Owner | Azure Public Cloud Hosting - Platform Contributor: Contributor | IT Billing Read Only for Azure: Billing Reader | Wiz for Azure: Management Group Reader | Wiz for Azure: WizCustomRole-2021-01-28-Intel-Production-IC-Hybrid | Wiz for Azure: Reader | Wiz for Azure: Azure Kubernetes Service RBAC Reader | Wiz for Azure: Azure Kubernetes Service Cluster User Role | Azure_Admin: Owner | IT Billing Read Only for Azure: Billing Reader | CBIC_Tenable_Reader: Reader | ECO_SPOT_IAP_16553: Cost Management Reader | Unknown Principal: Reader | CloudHealth_PR_IAP_34144: Reader | Unknown Principal: Reader | Men_and_Mice_PR_IAP_8445: Men and Mice Operator | Azure Security Read Only: Reader | Azure Security Admin: Owner | SDI Cloud Operations Azure: Owner | Densify-POC: Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: WizCustomRole1 | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Azure Kubernetes Service RBAC Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Azure Kubernetes Service Cluster User Role | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Storage Blob Data Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Cognitive Services OpenAI User | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: WizDataScanningRole | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: WizServerlessScanningRole | Cyber Defense Perimeter Pentesting: Reader | CrowdStrike TEST CID - Cloud Security Integration: Reader | CrowdStrike TEST CID - Cloud Security Integration: Security Reader | CrowdStrike TEST CID - Cloud Security Integration: Key Vault Reader | CrowdStrike TEST CID - Cloud Security Integration: Azure Kubernetes Service RBAC Reader | WizKeyVaultAccess: Key Vault Contributor | WizKeyVaultFirewall: Key Vault Contributor | Unknown Principal: WizRemediationCustomRole | rubrik_scan: Reader and Data Access | rubrik_scan: Reader | wizazurerr-fa: WizRemediationCustomRole | Azure-Infosecurity-Keyvault-Auditor: Key Vault Reader | Azure-Infosecurity-Keyvault-Auditor: Monitoring Reader | Praetorian Chariot: Security Reader | Praetorian Chariot: Reader | CloudHelper_IAP13321: Subscription Rename | Unknown Principal: WizRemediationCustomRole | RockSteady Cloud Azure: RockSteadyRole | RockSteady Cloud Azure: Azure Kubernetes Service RBAC Reader | RockSteady Cloud Azure: Reader | wiz-jfjcexu4-func: wiz-jfJceXu4-function-role | Azure Public Cloud Hosting - Platform Contributor: Owner | Azure Public Cloud Hosting - Platform Contributor: Contributor | enterprise-hosting-cloud-helper/slots/test: Subscription Rename | enterprise-hosting-cloud-helper: Subscription Rename | enterprise-hosting-cloud-helper/slots/staging: Subscription Rename | Unknown Principal: Reader'>124</td><td title='MoveCollection-eus-wus-eus2 (169f8227-6a80-41ba-9f31-6f4e8788eed8) - User Access Administrator [RBAC] | MoveCollection-eus-wus-eus2 (169f8227-6a80-41ba-9f31-6f4e8788eed8) - Contributor [RBAC] | 1Source runner image builder (9c2d5169-5828-43a3-a7f3-07fa9c94d375) - Contributor [RBAC] | azure-cli-2023-06-09-10-58-33 (e8a6a509-da43-45e5-92f6-d84b40e1169a) - Contributor [RBAC] | 1Source-Bicep-Deployment (eb9f6a4d-5449-4b01-a93b-d4550605d25d) - Contributor [RBAC] | 1Source_cd_IAP_23071 (aa4f248f-85e6-4707-9daf-4dc8e77d3ee4) - Contributor [RBAC] | 1Source Image builder PRE (756e67f1-217b-4182-9a3c-a3e9f1fecffc) - Contributor [RBAC] | Microsoft Defender for Cloud Servers Scanner Resource Provider (f094a5f3-4396-4ed6-86c5-181c709d2c02) - VM Scanner Operator [RBAC] | 1SCM-AKS-Arc (1341f577-5718-42ac-8500-edaf68227f08) - Contributor [RBAC] | webhook pre (1e5aadc7-1036-4849-b378-54eda5dd218c) - Contributor [RBAC] | webhook pre (1e5aadc7-1036-4849-b378-54eda5dd218c) - Role Based Access Control Administrator [RBAC] | site-reco-etj-asr-automationaccount (31abc266-66fe-4820-b98c-4767641ef446) - Contributor [RBAC] | defaultva-vzi-asr-automationaccount (82d85d56-691f-40ce-8fcc-851f63a4ce53) - Contributor [RBAC] | Engineering splunk for 1source webhook event hub (6d59a44b-0d6a-494b-bdc5-0c6ba6988cc4) - Azure Event Hubs Data Receiver [RBAC] | Cloud Infrastructure Entitlement Management (a2334596-f24d-4d12-be6e-2fee7b045547) - Reader [RBAC] | CloudPosture/securityOperators/DefenderCSPMSecurityOperator (cfa96d2b-afc3-4afe-8ae4-7ff7535464d4) - Defender CSPM Storage Scanner Operator [RBAC] | CloudPosture/securityOperators/DefenderCSPMSecurityOperator (cfa96d2b-afc3-4afe-8ae4-7ff7535464d4) - Defender Kubernetes API Access [RBAC] | storageDataScanner (dbf86340-484a-46c2-a803-1458699b8817) - Storage Blob Data Reader [RBAC] | storageDataScanner (dbf86340-484a-46c2-a803-1458699b8817) - Storage File Data Privileged Reader [RBAC] | SqlVmAndArcSqlServersProtection (745cef71-2241-4f7b-8ffc-14fa45d17a1a) - Virtual Machine Contributor [RBAC] | SqlVmAndArcSqlServersProtection (745cef71-2241-4f7b-8ffc-14fa45d17a1a) - Managed Identity Operator [RBAC] | SqlVmAndArcSqlServersProtection (745cef71-2241-4f7b-8ffc-14fa45d17a1a) - Log Analytics Contributor [RBAC] | 1Source_Pre-Production_NewRelic_IAP_23071 (35b1ff3c-aec2-459b-ba59-0eafc88c6dda) - Reader [RBAC] | 9ded5f0326994895b9225fc6 (8e447718-6df5-45f2-a2ac-3af08887f909) - SQL Security Manager [RBAC] | InfoSecAutomation_grBxdcGCKejpB2kI71OHzCPbPPhrWCK/TfeKLQbsNig= (7c51ef53-655e-40aa-b15a-3a21cc304b53) - Contributor [RBAC] | 223fb17b325340c6af5810d1 (832409bf-6a04-455e-9b6d-c84b009bac66) - Contributor [RBAC] | Microsoft Azure Log Integration Service (azlog) - 9709e9ec-2cb5-4580-8ea8-157e522740ff (33476dc5-2e32-404a-8718-b5b2d5da0a01) - Reader [RBAC] | cbroker_testsp (115bc50e-f248-4244-a146-ade2a6348f07) - Owner [RBAC] | e5065094a832493786b7d254 (9c7ff493-8752-4226-a548-dac1bf7f300a) - Contributor [RBAC] | InfoSecAutomation (ff1fc891-cbf9-4b4e-9840-176fcf617fdd) - Contributor [RBAC] | Azure SEER automatic enforcement (cad9f67b-2be1-4059-949b-12fad0f0a151) - SEER enforcement [RBAC] | InfoSecAutomation (ff1fc891-cbf9-4b4e-9840-176fcf617fdd) - Azure Kubernetes Service Cluster Admin Role [RBAC] | InfoSecAutomation (ff1fc891-cbf9-4b4e-9840-176fcf617fdd) - Azure Kubernetes Service RBAC Admin [RBAC] | 5b40164fa23b4cb7af13ac0f (d6060f9e-26db-4108-b51b-49651969406a) - Contributor [RBAC] | InfoSecAutomation (ff1fc891-cbf9-4b4e-9840-176fcf617fdd) - Azure Kubernetes Service RBAC Cluster Admin [RBAC] | WizKeyVaultAccess (70809f53-421f-4045-8157-435b9a993609) - Key Vault Contributor [RBAC] | WizKeyVaultFirewall (99ed0593-5434-4a0e-a7af-948eeb0cd472) - Key Vault Contributor [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Key Vault Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Key Vault Crypto Service Encryption User [RBAC] | 7287972431ab4d2f8e54b1b9 (e8d36191-ed43-46a5-9740-46401067badd) - Security Admin [RBAC] | 6d55668aa3534cd4ad9b30d0 (e4d0aa84-1f01-4672-b4d6-74fd646344f8) - Security Admin [RBAC] | Wiz for Azure (65e77292-7652-4fc3-97b3-eaa0bad308ff) - Management Group Reader [RBAC] | Wiz for Azure (65e77292-7652-4fc3-97b3-eaa0bad308ff) - WizCustomRole-2021-01-28-Intel-Production-IC-Hybrid [RBAC] | Wiz for Azure (65e77292-7652-4fc3-97b3-eaa0bad308ff) - Reader [RBAC] | Wiz for Azure (65e77292-7652-4fc3-97b3-eaa0bad308ff) - Azure Kubernetes Service RBAC Reader [RBAC] | Wiz for Azure (65e77292-7652-4fc3-97b3-eaa0bad308ff) - Azure Kubernetes Service Cluster User Role [RBAC] | CBIC_Tenable_Reader (29b8b746-dc08-4c19-a0a1-3f653c40ecd3) - Reader [RBAC] | ECO_SPOT_IAP_16553 (bd123435-87ec-4fd1-b9d7-14dc67113604) - Cost Management Reader [RBAC] | CloudHealth_PR_IAP_34144 (5b8fb4af-0ad7-47e9-a6d6-27d3dba5aa2d) - Reader [RBAC] | Men_and_Mice_PR_IAP_8445 (1675703c-b517-4f03-a796-9668a390dcf7) - Men and Mice Operator [RBAC] | Densify-POC (e6a9b18f-b1bd-44c0-be64-ed3dc0aeb1df) - Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - WizCustomRole1 [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Azure Kubernetes Service RBAC Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Azure Kubernetes Service Cluster User Role [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Storage Blob Data Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Cognitive Services OpenAI User [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - WizDataScanningRole [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - WizServerlessScanningRole [RBAC] | Cyber Defense Perimeter Pentesting (1bf7fd2d-3100-438a-8341-e679afd5f9ae) - Reader [RBAC] | CrowdStrike TEST CID - Cloud Security Integration (508e7ffa-3c4b-4213-ada2-939d4ca91083) - Reader [RBAC] | CrowdStrike TEST CID - Cloud Security Integration (508e7ffa-3c4b-4213-ada2-939d4ca91083) - Security Reader [RBAC] | CrowdStrike TEST CID - Cloud Security Integration (508e7ffa-3c4b-4213-ada2-939d4ca91083) - Key Vault Reader [RBAC] | CrowdStrike TEST CID - Cloud Security Integration (508e7ffa-3c4b-4213-ada2-939d4ca91083) - Azure Kubernetes Service RBAC Reader [RBAC] | WizKeyVaultAccess (ccaf9819-a25d-4040-a403-c3f71b92bab4) - Key Vault Contributor [RBAC] | WizKeyVaultFirewall (46e69860-91e0-44d3-a2b5-1fe8777cfba1) - Key Vault Contributor [RBAC] | rubrik_scan (677a6233-f344-4f2c-960a-3df08bb36ef3) - Reader and Data Access [RBAC] | rubrik_scan (677a6233-f344-4f2c-960a-3df08bb36ef3) - Reader [RBAC] | wizazurerr-fa (c5a05c6b-3618-4b09-9664-03bef4ea7b67) - WizRemediationCustomRole [RBAC] | Praetorian Chariot (8115ad4c-1930-4f9f-8bc3-1befd822bf04) - Security Reader [RBAC] | Praetorian Chariot (8115ad4c-1930-4f9f-8bc3-1befd822bf04) - Reader [RBAC] | CloudHelper_IAP13321 (4875e471-1ab4-4656-b162-20b9c0bcc6de) - Subscription Rename [RBAC] | RockSteady Cloud Azure (005288a3-f653-4e8c-bcdf-ec797ae662f1) - RockSteadyRole [RBAC] | RockSteady Cloud Azure (005288a3-f653-4e8c-bcdf-ec797ae662f1) - Azure Kubernetes Service RBAC Reader [RBAC] | RockSteady Cloud Azure (005288a3-f653-4e8c-bcdf-ec797ae662f1) - Reader [RBAC] | wiz-jfjcexu4-func (cb7142af-92fe-43c4-a1d7-b7f9baa7d2b3) - wiz-jfJceXu4-function-role [RBAC] | enterprise-hosting-cloud-helper/slots/test (aa41a440-20bc-4a6d-8d03-338825dc12fb) - Subscription Rename [RBAC] | enterprise-hosting-cloud-helper (6c3796e5-908e-497a-b1ad-ff17813bad15) - Subscription Rename [RBAC] | enterprise-hosting-cloud-helper/slots/staging (1463e043-3f16-454d-93a7-e72fa5e108bd) - Subscription Rename [RBAC]'>79</td><td title='Connected: cbroker_testsp (Owner) | Connected: Microsoft Defender for Cloud Servers Scanner Resource Provider (VM Scanner Operator) | Connected: Containers/securityOperators/DefenderForContainersSecurityOperator (Defender Kubernetes API Access) | Connected: 1CICD Image builder PROD (Contributor) | Connected: 1CICD metrics packer (Contributor) | Connected: 1CICD metrics github actions (Contributor) | Connected: 1CICD Certification (Reader) | Connected: Cloud Infrastructure Entitlement Management (Reader) | Connected: CloudPosture/securityOperators/DefenderCSPMSecurityOperator (Defender CSPM Storage Scanner Operator) | Connected: CloudPosture/securityOperators/DefenderCSPMSecurityOperator (Defender Kubernetes API Access) | Connected: storageDataScanner (Storage Blob Data Reader) | Connected: SqlVmAndArcSqlServersProtection (Virtual Machine Contributor) | Connected: storageDataScanner (Storage File Data Privileged Reader) | Connected: SqlVmAndArcSqlServersProtection (Managed Identity Operator) | Connected: SqlVmAndArcSqlServersProtection (Log Analytics Contributor) | Connected: 9ded5f0326994895b9225fc6 (SQL Security Manager) | Connected: InfoSecAutomation_grBxdcGCKejpB2kI71OHzCPbPPhrWCK/TfeKLQbsNig= (Contributor) | Connected: 223fb17b325340c6af5810d1 (Contributor) | Connected: Microsoft Azure Log Integration Service (azlog) - 9709e9ec-2cb5-4580-8ea8-157e522740ff (Reader) | Connected: cbroker_testsp (Owner) | Connected: e5065094a832493786b7d254 (Contributor) | Connected: InfoSecAutomation (Contributor) | Connected: Azure SEER automatic enforcement (SEER enforcement) | Connected: InfoSecAutomation (Azure Kubernetes Service Cluster Admin Role) | Connected: InfoSecAutomation (Azure Kubernetes Service RBAC Admin) | Connected: 5b40164fa23b4cb7af13ac0f (Contributor) | Connected: InfoSecAutomation (Azure Kubernetes Service RBAC Cluster Admin) | Connected: WizKeyVaultAccess (Key Vault Contributor) | Connected: WizKeyVaultFirewall (Key Vault Contributor) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Key Vault Reader) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Key Vault Crypto Service Encryption User) | Connected: 7287972431ab4d2f8e54b1b9 (Security Admin) | Connected: 6d55668aa3534cd4ad9b30d0 (Security Admin) | Connected: Wiz for Azure (Management Group Reader) | Connected: Wiz for Azure (WizCustomRole-2021-01-28-Intel-Production-IC-Hybrid) | Connected: Wiz for Azure (Reader) | Connected: Wiz for Azure (Azure Kubernetes Service RBAC Reader) | Connected: Wiz for Azure (Azure Kubernetes Service Cluster User Role) | Connected: CBIC_Tenable_Reader (Reader) | Connected: ECO_SPOT_IAP_16553 (Cost Management Reader) | Connected: CloudHealth_PR_IAP_34144 (Reader) | Connected: Men_and_Mice_PR_IAP_8445 (Men and Mice Operator) | Connected: Densify-POC (Reader) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (WizCustomRole1) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Reader) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Azure Kubernetes Service RBAC Reader) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Azure Kubernetes Service Cluster User Role) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Storage Blob Data Reader) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (Cognitive Services OpenAI User) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (WizDataScanningRole) | Connected: wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (WizServerlessScanningRole) | Connected: Cyber Defense Perimeter Pentesting (Reader) | Connected: CrowdStrike TEST CID - Cloud Security Integration (Reader) | Connected: CrowdStrike TEST CID - Cloud Security Integration (Security Reader) | Connected: CrowdStrike TEST CID - Cloud Security Integration (Key Vault Reader) | Connected: CrowdStrike TEST CID - Cloud Security Integration (Azure Kubernetes Service RBAC Reader) | Connected: WizKeyVaultAccess (Key Vault Contributor) | Connected: WizKeyVaultFirewall (Key Vault Contributor) | Connected: rubrik_scan (Reader and Data Access) | Connected: rubrik_scan (Reader) | Connected: wizazurerr-fa (WizRemediationCustomRole) | Connected: Praetorian Chariot (Security Reader) | Connected: Praetorian Chariot (Reader) | Connected: CloudHelper_IAP13321 (Subscription Rename) | Connected: RockSteady Cloud Azure (RockSteadyRole) | Connected: RockSteady Cloud Azure (Azure Kubernetes Service RBAC Reader) | Connected: RockSteady Cloud Azure (Reader) | Connected: wiz-jfjcexu4-func (wiz-jfJceXu4-function-role) | Connected: enterprise-hosting-cloud-helper/slots/test (Subscription Rename) | Connected: enterprise-hosting-cloud-helper (Subscription Rename) | Connected: enterprise-hosting-cloud-helper/slots/staging (Subscription Rename)'>71</td><td title='Principal ID: '>False</td><td title='User Assigned IDs: '>0</td><td>Unknown</td><td>Unknown</td><td title='Network ACLs: False'>Enabled</td><td>0</td><td style='text-align: center;'>0</td><td style='text-align: center;'>0</td><td style='text-align: center;'>0</td><td>Unknown</td><td title=''>Not Determined</td><td><span class='action-link' onclick='toggleActionItems("actions_4")'>View Actions</span><div id='actions_4' class='action-details'><h5>Priority Actions for test-key-vault-fgalind1:</h5><ul><li>Vault analysis completed successfully - no major issues found</li></ul><p><strong>Impact:</strong> Implementing these recommendations will improve security posture and compliance score.</p></div></td></tr>
            </tbody>
        </table>
    </div>
    
    <div class="quick-wins-section">
        <h3>🚀 Quick Wins Recommendations<span class="enhancement-badge">Enhanced</span></h3>
        <p>Prioritized action items for immediate security improvements:</p>
        <ul><li>[HIGH] Enable RBAC authorization model for all Key Vaults to leverage Azure AD for fine-grained access control<br><em>Example:</em> az keyvault update --name mykeyvault --enable-rbac-authorization true</li><li>[HIGH] Implement proper network access restrictions using virtual network service endpoints or private endpoints<br><em>Example:</em> Restrict DefaultAction to Deny, configure IP rules for authorized networks only</li><li>[MEDIUM] Enable diagnostic logging for all Key Vaults to capture access patterns and security events<br><em>Example:</em> Configure Log Analytics workspace integration, monitor AuditEvent and AllMetrics categories</li><li>[MEDIUM] Review and minimize access permissions - remove unused service principals and overprivileged assignments<br><em>Example:</em> Audit access policies quarterly, implement principle of least privilege with specific secret/key/certificate permissions</li><li>[MEDIUM] Replace hardcoded secrets with Key Vault references in application configurations<br><em>Example:</em> App Settings: @Microsoft.KeyVault(SecretUri=https://vault.vault.azure.net/secrets/connection-string/), ARM templates with KeyVault references</li><li>🟡 MEDIUM: Set up secret expiration monitoring and automated alerts for approaching expirations<br><em>Example:</em> Logic App triggered by Key Vault events, query for secrets expiring in 30 days, send Teams/email notifications with renewal instructions</li><li>🟢 LOW: Enable Key Vault notifications for secret access patterns and unauthorized changes<br><em>Example:</em> Configure Event Grid subscriptions for 'Microsoft.KeyVault.SecretNewVersion' and 'Microsoft.KeyVault.VaultAccessPolicyChanged' events, integrate with monitoring dashboards</li>        </ul>
    </div>
    
    <div class="identity-section">
        <h3>🔐 Identity & Access Management Insights</h3>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number">325</div>
                <div class="stat-label">Total Service Principals</div>
                
            </div>
            <div class="stat-card">
                <div class="stat-number">334</div>
                <div class="stat-label">Total Managed Identities</div>
                
            </div>
            <div class="stat-card">
                <div class="stat-number">0</div>
                <div class="stat-label">System-Assigned Identities</div>
                <div class="stat-percentage" style="color: #dc3545">0%</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">0</div>
                <div class="stat-label">User-Assigned Identities</div>
                
            </div>
            <div class="stat-card">
                <div class="stat-number">4</div>
                <div class="stat-label">Using RBAC</div>
                <div class="stat-percentage" style="color: #28a745">100%</div>
            </div>
        </div>
        
        <h4>Key Identity Recommendations:</h4>
        <ul>
            <li><strong>Migrate to Managed Identities:</strong> Replace service principals with managed identities where possible for enhanced security</li>
            <li><strong>Implement RBAC:</strong> Move from legacy access policies to Azure RBAC for fine-grained access control (100% currently using RBAC)</li>
            <li><strong>Apply Least Privilege:</strong> Review and reduce over-privileged role assignments</li>
            <li><strong>Enable System-Assigned Identities:</strong> Configure system-assigned managed identities on Key Vault resources (0 of 4 vaults have system-assigned identities)</li>
        </ul>
        
        <div style="margin-top: 15px; padding: 10px; background: #fff3cd; border-radius: 4px;">
            <h5>📝 Note on Service Principals vs System Identity:</h5>
            <p><strong>Total Service Principals</strong> refers to external service principals assigned RBAC roles to access Key Vaults.</p>
            <p><strong>System Identity</strong> refers to system-assigned managed identities directly on the Key Vault resource itself. These are separate concepts - a Key Vault can have external service principals accessing it while not having its own system-assigned identity enabled.</p>
            
        </div>
    </div>

    <div class="secrets-section">
        <h3>🔑 Secrets Management Insights</h3>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number">0</div>
                <div class="stat-label">Vaults Storing Secrets</div>
                <div class="stat-percentage" style="color: #667eea;">0%</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">4</div>
                <div class="stat-label">Secret Access Monitoring</div>
                <div class="stat-percentage" style="color: #28a745">100%</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">4</div>
                <div class="stat-label">Granular Secret Access</div>
                <div class="stat-percentage" style="color: #28a745">100%</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">0</div>
                <div class="stat-label">Secret Recovery Protection</div>
                <div class="stat-percentage" style="color: #dc3545">0%</div>
            </div>
        </div>
        
        <h4>🔐 Secrets Management Terms & Best Practices:</h4>
        <ul>
            <li><strong>Secret Access Monitoring:</strong> Comprehensive logging and auditing of all secret access attempts, including who accessed what secrets, when, and from where. This enables detection of unauthorized access patterns and compliance reporting.</li>
            <li><strong>Granular Secret Access:</strong> Fine-grained permissions using Azure RBAC instead of broad access policies. This allows specific roles like 'Key Vault Secrets User' for read access only, rather than full vault permissions.</li>
            <li><strong>Secret Recovery Protection:</strong> Soft delete functionality that allows recovery of accidentally deleted secrets within the retention period (7-90 days), preventing permanent data loss.</li>
            <li><strong>Secret Rotation:</strong> Microsoft recommends automated rotation every 90 days for high-value secrets. Consider implementing Azure Functions or Logic Apps for automated rotation workflows.</li>
            <li><strong>Secret Versioning:</strong> Key Vault automatically versions secrets. Leverage this for rollback capabilities and audit trails.</li>
            <li><strong>Application Integration:</strong> Use Key Vault references in Azure App Service and Azure Functions instead of hardcoding secrets in application configurations.</li>
        </ul>
        
        <h4>📊 Compliance & Security Insights:</h4>
        <ul>
            <li><strong>Audit Trail:</strong> 100% of vaults have diagnostic logging enabled, providing visibility into secret access patterns and potential security incidents.</li>
            <li><strong>Network Isolation:</strong> 0% of vaults use private endpoints, protecting secrets from unauthorized network access.</li>
            <li><strong>Identity-Based Access:</strong> 100% of vaults use RBAC for granular secret permissions instead of legacy access policies.</li>
            <li><strong>Secret Recovery:</strong> Soft delete is enabled on 0% of vaults, enabling secret recovery in case of accidental deletion.</li>
        </ul>
        
        <h4>⚠️ Common Secrets Management Risks:</h4>
        <ul>
            <li><strong>Hardcoded Secrets:</strong> Avoid storing secrets directly in application code, configuration files, or environment variables.</li>
            <li><strong>Over-Privileged Access:</strong> Applications with broad Key Vault permissions increase attack surface.</li>
            <li><strong>Stale Secrets:</strong> Unused or forgotten secrets should be regularly audited and removed.</li>
            <li><strong>Weak Secret Generation:</strong> Use cryptographically secure random generators for password and key generation.</li>
            <li><strong>Cross-Environment Leakage:</strong> Ensure proper isolation between development, staging, and production secrets.</li>
        </ul>
        
        
    </div>

    <div class="security-section">
        <h2>🛡️ Comprehensive Security Enhancement Recommendations</h2>
        <div class="section-description">
            <p>Expert-level security recommendations based on Microsoft Security Baseline v3.0, Azure Well-Architected Framework, and industry best practices. These recommendations are prioritized by risk level and implementation complexity.</p>
        </div>
        
        <!-- High Priority Security Enhancements -->
        <div class="security-priority-section">
            <h3>🚨 High Priority Actions (Immediate Implementation)</h3>
            <div class="security-recommendations-grid">
                <div class="security-recommendation urgent">
                    <div class="recommendation-header">
                        <div class="priority-badge critical">CRITICAL</div>
                        <h4>🔐 Enable Purge Protection</h4>
                    </div>
                    <div class="recommendation-content">
                        <div class="current-status">
                            Current Status: 0 of 4 vaults (0%) have purge protection enabled
                        </div>
                        <div class="risk-impact">
                            <strong>Risk:</strong> Without purge protection, malicious actors or insider threats can permanently delete Key Vault data, leading to complete loss of secrets, keys, and certificates.
                        </div>
                        <div class="implementation-steps">
                            <h5>Implementation Steps:</h5>
                            <ol>
                                <li>Review all Key Vaults without purge protection enabled</li>
                                <li>Enable purge protection via Azure CLI: <code>az keyvault update --name &lt;vault-name&gt; --enable-purge-protection true</code></li>
                                <li>Verify protection status in Azure Portal</li>
                                <li>Document protection status in change management</li>
                                <li>Set up Azure Policy to enforce purge protection on new vaults</li>
                            </ol>
                        </div>
                        <div class="compliance-note">
                            <strong>Compliance:</strong> Required by Microsoft Security Baseline and most regulatory frameworks (SOC 2, ISO 27001, PCI DSS)
                        </div>
                    </div>
                </div>
                
                <div class="security-recommendation urgent">
                    <div class="recommendation-header">
                        <div class="priority-badge critical">CRITICAL</div>
                        <h4>🔍 Implement Comprehensive Monitoring</h4>
                    </div>
                    <div class="recommendation-content">
                        <div class="current-status">
                            Current Status: 4 of 4 vaults (100%) have diagnostics enabled
                        </div>
                        <div class="risk-impact">
                            <strong>Risk:</strong> Without comprehensive monitoring, security incidents go undetected, compliance audits fail, and operational issues cannot be traced or resolved.
                        </div>
                        <div class="implementation-steps">
                            <h5>Complete Monitoring Stack:</h5>
                            <ol>
                                <li><strong>Diagnostic Settings:</strong> Enable all log categories (AuditEvent, AllLogs)</li>
                                <li><strong>Log Analytics:</strong> Configure centralized workspace for querying and alerting</li>
                                <li><strong>Azure Sentinel:</strong> Advanced threat detection and security orchestration</li>
                                <li><strong>Event Hub:</strong> Real-time streaming for SIEM integration</li>
                                <li><strong>Storage Account:</strong> Long-term retention for compliance</li>
                            </ol>
                        </div>
                        <div class="monitoring-benefits">
                            <h5>Benefits:</h5>
                            <ul>
                                <li>Real-time security event detection</li>
                                <li>Automated incident response capabilities</li>
                                <li>Compliance audit trail maintenance</li>
                                <li>Performance and usage optimization insights</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="security-recommendation urgent">
                    <div class="recommendation-header">
                        <div class="priority-badge critical">CRITICAL</div>
                        <h4>🌐 Network Security Hardening</h4>
                    </div>
                    <div class="recommendation-content">
                        <div class="current-status">
                            Current Status: 0 of 4 vaults (0%) have private endpoints configured
                        </div>
                        <div class="risk-impact">
                            <strong>Risk:</strong> Public internet exposure increases attack surface, enables reconnaissance attacks, and violates Zero Trust principles.
                        </div>
                        <div class="network-hardening-steps">
                            <h5>Network Security Implementation:</h5>
                            <ol>
                                <li><strong>Private Endpoints:</strong> Deploy in production VNets for zero internet exposure</li>
                                <li><strong>Network ACLs:</strong> Configure IP restrictions for development environments</li>
                                <li><strong>Service Endpoints:</strong> Enable for Azure services integration</li>
                                <li><strong>Firewall Rules:</strong> Implement allow-list based access control</li>
                                <li><strong>VNet Integration:</strong> Ensure proper DNS resolution and routing</li>
                            </ol>
                        </div>
                        <div class="zero-trust-alignment">
                            <strong>Zero Trust Alignment:</strong> Private endpoints eliminate public internet access, enforcing "never trust, always verify" principles
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Medium Priority Security Enhancements -->
        <div class="security-priority-section">
            <h3>⚡ Medium Priority Actions (30-60 Days)</h3>
            <div class="security-recommendations-grid">
                <div class="security-recommendation moderate">
                    <div class="recommendation-header">
                        <div class="priority-badge medium">MEDIUM</div>
                        <h4>🔄 Migrate to RBAC Authorization</h4>
                    </div>
                    <div class="recommendation-content">
                        <div class="current-status">
                            RBAC Adoption: 100% (4 of 4 vaults)
                        </div>
                        <div class="rbac-benefits">
                            <h5>RBAC vs Access Policy Benefits:</h5>
                            <div class="comparison-table">
                                <div class="comparison-row">
                                    <div class="feature">Centralized Management</div>
                                    <div class="rbac-value">✅ Azure AD integration</div>
                                    <div class="policy-value">❌ Vault-specific</div>
                                </div>
                                <div class="comparison-row">
                                    <div class="feature">Conditional Access</div>
                                    <div class="rbac-value">✅ Full support</div>
                                    <div class="policy-value">❌ Limited</div>
                                </div>
                                <div class="comparison-row">
                                    <div class="feature">Fine-grained Permissions</div>
                                    <div class="rbac-value">✅ 20+ built-in roles</div>
                                    <div class="policy-value">⚠️ Basic permissions</div>
                                </div>
                                <div class="comparison-row">
                                    <div class="feature">Audit Trail</div>
                                    <div class="rbac-value">✅ Azure AD logs</div>
                                    <div class="policy-value">⚠️ Limited logging</div>
                                </div>
                            </div>
                        </div>
                        <div class="migration-strategy">
                            <h5>Migration Strategy:</h5>
                            <ol>
                                <li>Inventory current access policies and map to RBAC roles</li>
                                <li>Enable RBAC authorization on Key Vault</li>
                                <li>Assign appropriate roles (Key Vault Secrets Officer, Key Vault Reader, etc.)</li>
                                <li>Test access with service accounts and users</li>
                                <li>Remove legacy access policies after validation</li>
                                <li>Update documentation and operational procedures</li>
                            </ol>
                        </div>
                    </div>
                </div>
                
                <div class="security-recommendation moderate">
                    <div class="recommendation-header">
                        <div class="priority-badge medium">MEDIUM</div>
                        <h4>🔐 Implement Secret Rotation Automation</h4>
                    </div>
                    <div class="recommendation-content">
                        <div class="rotation-benefits">
                            <h5>Automated Rotation Benefits:</h5>
                            <ul>
                                <li>Reduces credential compromise window</li>
                                <li>Ensures compliance with security policies</li>
                                <li>Eliminates manual rotation errors</li>
                                <li>Provides audit trail for rotations</li>
                            </ul>
                        </div>
                        <div class="rotation-implementation">
                            <h5>Implementation Approaches:</h5>
                            <div class="rotation-methods">
                                <div class="rotation-method">
                                    <h6>🔄 Native Auto-Rotation</h6>
                                    <p>For supported services (SQL Database, Storage Account, Cosmos DB)</p>
                                    <code>az keyvault secret set-attributes --vault-name MyVault --name MySecret --rotation-policy @policy.json</code>
                                </div>
                                <div class="rotation-method">
                                    <h6>🤖 Custom Automation</h6>
                                    <p>Azure Functions + Key Vault SDK for custom applications</p>
                                    <ul>
                                        <li>Timer-triggered functions for scheduled rotation</li>
                                        <li>Event-driven rotation based on expiration alerts</li>
                                        <li>Integration with application deployment pipelines</li>
                                    </ul>
                                </div>
                                <div class="rotation-method">
                                    <h6>🔗 Third-party Integration</h6>
                                    <p>HashiCorp Vault, CyberArk, or other secret management platforms</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="security-recommendation moderate">
                    <div class="recommendation-header">
                        <div class="priority-badge medium">MEDIUM</div>
                        <h4>👥 Implement Identity Governance</h4>
                    </div>
                    <div class="recommendation-content">
                        <div class="governance-components">
                            <h5>Identity Governance Framework:</h5>
                            <div class="governance-grid">
                                <div class="governance-item">
                                    <h6>🔍 Access Reviews</h6>
                                    <ul>
                                        <li>Quarterly reviews of all Key Vault access</li>
                                        <li>Automated access certification campaigns</li>
                                        <li>Manager attestation for direct reports</li>
                                        <li>Exception handling for service accounts</li>
                                    </ul>
                                </div>
                                <div class="governance-item">
                                    <h6>⏰ Privileged Identity Management</h6>
                                    <ul>
                                        <li>Just-in-time access for administrative roles</li>
                                        <li>Time-limited elevation for troubleshooting</li>
                                        <li>Approval workflows for sensitive operations</li>
                                        <li>Multi-factor authentication enforcement</li>
                                    </ul>
                                </div>
                                <div class="governance-item">
                                    <h6>🤖 Managed Identity Adoption</h6>
                                    <ul>
                                        <li>Replace service principals with managed identities</li>
                                        <li>System-assigned for single-resource scenarios</li>
                                        <li>User-assigned for multi-resource scenarios</li>
                                        <li>Eliminate credential management overhead</li>
                                    </ul>
                                </div>
                                <div class="governance-item">
                                    <h6>📊 Continuous Monitoring</h6>
                                    <ul>
                                        <li>Real-time access pattern analysis</li>
                                        <li>Anomaly detection for unusual access</li>
                                        <li>Automated alerting for policy violations</li>
                                        <li>Integration with SIEM platforms</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Long-term Strategic Enhancements -->
        <div class="security-priority-section">
            <h3>🎯 Strategic Enhancements (90+ Days)</h3>
            <div class="strategic-recommendations">
                <div class="strategic-recommendation">
                    <div class="recommendation-header">
                        <div class="priority-badge strategic">STRATEGIC</div>
                        <h4>🏛️ Enterprise Key Management Architecture</h4>
                    </div>
                    <div class="recommendation-content">
                        <div class="architecture-vision">
                            <h5>Future-State Architecture:</h5>
                            <div class="architecture-components">
                                <div class="architecture-layer">
                                    <h6>🌐 Global Key Management</h6>
                                    <ul>
                                        <li>Multi-region Key Vault deployment with geo-replication</li>
                                        <li>Cross-region backup and disaster recovery strategies</li>
                                        <li>Global policy enforcement and governance</li>
                                        <li>Unified monitoring and alerting across regions</li>
                                    </ul>
                                </div>
                                <div class="architecture-layer">
                                    <h6>🔐 Advanced Cryptographic Services</h6>
                                    <ul>
                                        <li>Hardware Security Module (HSM) integration</li>
                                        <li>Bring Your Own Key (BYOK) implementation</li>
                                        <li>Customer-managed encryption keys (CMEK)</li>
                                        <li>Quantum-resistant cryptography preparation</li>
                                    </ul>
                                </div>
                                <div class="architecture-layer">
                                    <h6>🤖 Intelligent Automation</h6>
                                    <ul>
                                        <li>Machine learning-based access pattern analysis</li>
                                        <li>Predictive expiration and rotation scheduling</li>
                                        <li>Automated compliance remediation</li>
                                        <li>Self-healing security configurations</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="implementation-roadmap">
                            <h5>Implementation Roadmap:</h5>
                            <div class="roadmap-timeline">
                                <div class="roadmap-phase">
                                    <div class="phase-title">Phase 1 (Months 1-3): Foundation</div>
                                    <ul>
                                        <li>Standardize Key Vault configurations</li>
                                        <li>Implement centralized monitoring</li>
                                        <li>Establish governance framework</li>
                                    </ul>
                                </div>
                                <div class="roadmap-phase">
                                    <div class="phase-title">Phase 2 (Months 4-6): Enhancement</div>
                                    <ul>
                                        <li>Deploy advanced security features</li>
                                        <li>Implement automation frameworks</li>
                                        <li>Enable cross-region capabilities</li>
                                    </ul>
                                </div>
                                <div class="roadmap-phase">
                                    <div class="phase-title">Phase 3 (Months 7-12): Optimization</div>
                                    <ul>
                                        <li>Advanced analytics and ML integration</li>
                                        <li>Quantum-ready cryptography assessment</li>
                                        <li>Continuous improvement processes</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Security Metrics and KPIs -->
        <div class="security-metrics-section">
            <h3>📊 Security Metrics & Key Performance Indicators</h3>
            <div class="metrics-dashboard">
                <div class="metrics-category">
                    <h4>🔒 Security Baseline Compliance</h4>
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-name">Purge Protection Coverage</div>
                            <div class="metric-value">0%</div>
                            <div class="metric-target">Target: 100%</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-name">Monitoring Coverage</div>
                            <div class="metric-value">100%</div>
                            <div class="metric-target">Target: 100%</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-name">RBAC Adoption</div>
                            <div class="metric-value">100%</div>
                            <div class="metric-target">Target: 100%</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-name">Network Isolation</div>
                            <div class="metric-value">0%</div>
                            <div class="metric-target">Target: 80% (Production)</div>
                        </div>
                    </div>
                </div>
                
                <div class="metrics-category">
                    <h4>🎯 Operational Excellence</h4>
                    <div class="operational-metrics">
                        <div class="metric-row">
                            <span class="metric-label">Average Compliance Score:</span>
                            <span class="metric-value">N/A</span>
                        </div>
                        <div class="metric-row">
                            <span class="metric-label">High-Risk Vaults:</span>
                            <span class="metric-value">4 vaults</span>
                        </div>
                        <div class="metric-row">
                            <span class="metric-label">Total Identities with Access:</span>
                            <span class="metric-value">131 identities</span>
                        </div>
                        <div class="metric-row">
                            <span class="metric-label">Automated Rotation Coverage:</span>
                            <span class="metric-value">To be implemented</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        
    </div>

    <div class="legend-section">
        <h3>📊 Compliance Score Calculation Legend</h3>
        <p>The compliance score is calculated based on Microsoft Security Baseline requirements:</p>
        
        <h4>🔒 Core Security Features (50 points total):</h4>
        <ul>
            <li><strong>Soft Delete Enabled:</strong> 10 points - Protects against accidental deletion</li>
            <li><strong>Purge Protection Enabled:</strong> 15 points - Critical security baseline requirement</li>
            <li><strong>Diagnostics Enabled:</strong> 15 points - Essential for monitoring and compliance</li>
            <li><strong>Event Hub Integration:</strong> 10 points - Real-time security monitoring capability</li>
        </ul>
        
        <h4>🔐 Access Control (30 points total):</h4>
        <ul>
            <li><strong>RBAC Enabled:</strong> 15 points - Modern role-based access control vs legacy policies</li>
            <li><strong>Private Endpoints:</strong> 15 points - Network security and zero-trust architecture</li>
        </ul>
        
        <h4>📊 Monitoring & Compliance (20 points total):</h4>
        <ul>
            <li><strong>Log Analytics Integration:</strong> 10 points - Advanced querying and alerting</li>
            <li><strong>Audit Event Logging:</strong> 5 points - Security event tracking</li>
            <li><strong>Policy Evaluation Logging:</strong> 5 points - Azure Policy compliance tracking</li>
        </ul>
        
        <h4>🎯 Compliance Thresholds:</h4>
        <ul>
            <li><strong class="compliant">Fully Compliant:</strong> 90-100 points - Meets Microsoft security baselines</li>
            <li><strong class="partially-compliant">Partially Compliant:</strong> 60-89 points - Some improvements needed</li>
            <li><strong class="non-compliant">Non-Compliant:</strong> 0-59 points - Immediate action required</li>
        </ul>
    </div>
    
    <div style="margin-top: 30px; padding: 15px; background: #e9ecef; border-radius: 8px; font-size: 0.9em;">
        <h3>📋 Enhanced Compliance Framework</h3>
        <p>This comprehensive audit evaluates Key Vault configurations against current Microsoft security standards:</p>
        <ul>
            <li><strong>Azure Security Benchmark v3.0</strong> - Latest Microsoft cloud security recommendations <a href="https://learn.microsoft.com/security/benchmark/azure/" target="_blank">[Learn More]</a></li>
            <li><strong>Key Vault Security Baseline 2024</strong> - Specific security controls and requirements <a href="https://learn.microsoft.com/azure/key-vault/general/security-baseline" target="_blank">[Learn More]</a></li>
            <li><strong>Microsoft Cloud Security Best Practices</strong> - Identity and access management standards <a href="https://learn.microsoft.com/azure/security/fundamentals/best-practices-and-patterns" target="_blank">[Learn More]</a></li>
            <li><strong>Zero Trust Architecture</strong> - Never trust, always verify principles <a href="https://learn.microsoft.com/security/zero-trust/" target="_blank">[Learn More]</a></li>
            <li><strong>NIST Cybersecurity Framework</strong> - Industry-standard security practices <a href="https://www.nist.gov/cyberframework" target="_blank">[Learn More]</a></li>
            <li><strong>Azure Well-Architected Framework</strong> - Security pillar recommendations <a href="https://learn.microsoft.com/azure/well-architected/security/" target="_blank">[Learn More]</a></li>
        </ul>
        
        <h4>📊 Audit Statistics:</h4>
        <ul>
            <li>Subscriptions analyzed: N/A</li>
            <li>Key Vaults discovered: 4</li>
            <li>Compliance rate: 0% (0 fully compliant)</li>
            <li>RBAC adoption: 100% (4 vaults using RBAC)</li>
            <li>Event Hub integration: 100% (4 vaults configured)</li>
            <li>Log Analytics integration: 0% (0 vaults configured)</li>
            <li>Storage Account logging: 0% (0 vaults configured)</li>
            <li>Private endpoint adoption: 0% (0 vaults secured)</li>
            <li>Total execution time: N/A</li>
            <li>Authentication refreshes: 0</li>
            
        </ul>
        
        <h4>📁 Generated Files:</h4>
        <ul>
            <li><strong>HTML Report:</strong> C:\Users\cregnier\Documents\KeyVaultAudit\KeyVaultComprehensiveAudit_2025-10-08_16-53-16.html</li>
            <li><strong>CSV Data:</strong> C:\Users\cregnier\Documents\KeyVaultAudit\KeyVaultComprehensiveAudit_2025-10-08_16-53-16.csv</li> <li><strong>Error Log:</strong> C:\Users\cregnier\Documents\KeyVaultAudit\KeyVaultAudit_errors_20251008_165558.log</li> <li><strong>Permissions Log:</strong> C:\Users\cregnier\Documents\KeyVaultAudit\KeyVaultAudit_permissions_20251008_165558.log</li> <li><strong>Data Issues Log:</strong> C:\Users\cregnier\Documents\KeyVaultAudit\KeyVaultAudit_dataissues_20251008_165558.log</li>
        </ul>
        
        <h4>🔍 Enhanced Features Implemented:</h4>
        <ul>
            <li>✅ Comprehensive managed identity detection and analysis (System: 0, User: 0)</li>
            <li>✅ Advanced service principal analysis with over-privilege detection</li>
            <li>✅ RBAC least-privilege recommendations based on current assignments</li>
            <li>✅ Real-time compliance scoring with Microsoft baseline alignment</li>
            <li>✅ Enhanced progress tracking with intelligent ETA calculations</li>
            <li>✅ Automatic token refresh and seamless re-authentication (Refreshes: N/A)</li>
            <li>✅ Comprehensive error handling and permissions logging</li>
            <li>✅ Network security assessment including private endpoint analysis</li>
            <li>✅ Complete diagnostic configuration analysis (Event Hub, Log Analytics, Storage)</li>
            <li>✅ Executive-level reporting with actionable insights and percentages</li>
            <li>✅ Secrets management insights with Microsoft best practices alignment</li>
            <li>✅ Color-coded sliding scale percentages for visual impact assessment</li>
            <li>✅ Reverse color logic for Non-Compliant metrics (0% = good, 100% = bad)</li>
            <li>✅ Dynamic user authentication tracking from Azure login context</li>
            
        </ul>
    </div>
    
    <div style="margin-top: 20px; padding: 15px; background: #fff3cd; border-radius: 8px; border: 1px solid #ffeaa7;">
        <h3>⚠️ Important Notes</h3>
        <ul>
            
            <li><strong>Permissions:</strong> Some data may be incomplete due to insufficient permissions. Check the permissions log for details.</li>
            <li><strong>Best Practices:</strong> This audit reflects current Microsoft recommendations as of October 2025.</li>
            <li><strong>Continuous Improvement:</strong> Regular audits are recommended to maintain security posture.</li>
            <li><strong>Authentication:</strong> Script performed 0 token refresh(es) to maintain connectivity.</li>
            
        </ul>
    </div>
    
    <footer style="margin-top: 40px; padding: 20px; background: #f8f9fa; border-radius: 8px; text-align: center; color: #6c757d; border-top: 3px solid #667eea;">
        <p><strong>Azure Key Vault Enhanced Security & Compliance Audit Report</strong></p>
        <p>Generated by Script v2.1 on 2025-10-08 16:55:58 UTC by curtus.regnier@intel.com</p>
        <p><strong>Execution ID:</strong> 20251008-165255</p>
        <p>For questions or support, contact your Azure security team.</p>
        
    </footer>
</body>
</html>
