<!DOCTYPE html>
<html>
<head>
    <title>Azure Key Vault Enhanced Security & Compliance Audit</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 20px; background-color: #f5f5f5; }
.header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
.test-mode-banner { background: #dc3545; color: white; padding: 15px; text-align: center; font-weight: bold; font-size: 1.4em; border-radius: 8px; margin: 20px 0; }
.partial-results-banner { background: #e67e22; color: white; padding: 12px; text-align: center; font-weight: 600; font-size: 1.1em; border-radius: 6px; margin: 15px 0; border-left: 4px solid #d35400; opacity: 0.95; }
.summary { background: white; padding: 15px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
.compliant { color: #28a745; font-weight: bold; }
.non-compliant { color: #dc3545; font-weight: bold; }
.partially-compliant { color: #ffc107; font-weight: bold; }
.stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 15px 0; }
.stat-card { background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); text-align: center; position: relative; }
.stat-card:hover { transform: translateY(-2px); transition: transform 0.3s ease; }
.stat-number { font-size: 2em; font-weight: bold; color: #667eea; }
.stat-label { color: #666; margin-top: 5px; }
.stat-percentage { font-size: 0.9em; margin-top: 3px; font-weight: bold; }
.progress-bar { width: 100%; height: 8px; background: #e9ecef; border-radius: 4px; overflow: hidden; margin-top: 8px; }
.progress-fill { height: 100%; transition: width 0.8s ease; border-radius: 4px; }
table { width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin: 20px 0; font-size: 0.8em; }
th { background: #343a40; color: white; padding: 6px; text-align: left; font-weight: 600; cursor: pointer; position: sticky; top: 0; z-index: 10; font-size: 0.8em; }
td { padding: 4px; border-bottom: 1px solid #dee2e6; max-width: 120px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; font-size: 0.8em; }
tr:nth-child(even) { background-color: #f8f9fa; }
tr:hover { background-color: #e9ecef; }
.filter-input { width: 90%; padding: 3px; margin-bottom: 3px; border: 1px solid #ccc; border-radius: 4px; font-size: 0.75em; }
.action-link { color: #007bff; cursor: pointer; text-decoration: underline; font-size: 0.8em; }
.action-details { display: none; background: #f8f9fa; border: 1px solid #dee2e6; padding: 8px; margin-top: 3px; border-radius: 4px; font-size: 0.75em; }
@keyframes progressAnimation { from { width: 0%; } }
    </style>
    <script>
function filterTable(input, col) {
    var filter = input.value.toUpperCase();
    var table = document.getElementById("vaultTable");
    var trs = table.getElementsByTagName("tr");
    for (var i = 2; i < trs.length; i++) {
        var tds = trs[i].getElementsByTagName("td");
        if (tds.length > col) {
            var txt = tds[col].textContent || tds[col].innerText;
            trs[i].style.display = txt.toUpperCase().indexOf(filter) > -1 ? "" : "none";
        }
    }
}

function sortTable(n) {
    var table = document.getElementById("vaultTable");
    var switching = true;
    var dir = "asc";
    var switchcount = 0;
    while (switching) {
        switching = false;
        var rows = table.rows;
        for (var i = 2; i < (rows.length - 1); i++) {
            var shouldSwitch = false;
            var x = rows[i].getElementsByTagName("TD")[n];
            var y = rows[i + 1].getElementsByTagName("TD")[n];
            if (dir == "asc") {
                if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                    shouldSwitch = true;
                    break;
                }
            } else if (dir == "desc") {
                if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
                    shouldSwitch = true;
                    break;
                }
            }
        }
        if (shouldSwitch) {
            rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
            switching = true;
            switchcount++;
        } else {
            if (switchcount == 0 && dir == "asc") {
                dir = "desc";
                switching = true;
            }
        }
    }
}

function toggleActionItems(id) {
    var element = document.getElementById(id);
    if (element.style.display === "none" || element.style.display === "") {
        element.style.display = "block";
    } else {
        element.style.display = "none";
    }
}
    </script>
</head>
<body>
    <div class="header">
        <h1>üîê Azure Key Vault Enhanced Security & Compliance Audit</h1>
        <p><strong>Generated:</strong> 2025-09-15 12:38:06 UTC by curtus.regnier@intel.com</p>
        <p><strong>Script Version:</strong> 2.2 - Production Enterprise Edition with Comprehensive Inline HTML Generator (Restored)</p>
    </div>
    
    <div class="summary">
        <h2>üéØ Executive Summary</h2>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number">1</div>
                <div class="stat-label">Key Vaults Discovered</div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 100%; background: #667eea; animation: progressAnimation 1.5s ease-out;"></div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-number">0</div>
                <div class="stat-label">Fully Compliant</div>
                <div class="stat-percentage">85%</div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 85%; background: #ffc107; animation: progressAnimation 2s ease-out;"></div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-number">85</div>
                <div class="stat-label">Average Score</div>
                <div class="stat-percentage">Microsoft Framework</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">0</div>
                <div class="stat-label">High Risk Vaults</div>
                <div class="stat-percentage">Require Attention</div>
            </div>
        </div>
    </div>
    
    <div class="summary">
        <h2>üìã Detailed Vault Analysis</h2>
        <p>Comprehensive analysis of all  Key Vaults with compliance scoring, security configurations, and actionable recommendations.</p>
        
        <table id="vaultTable">
            <thead>
                <tr>
                    <th onclick="sortTable(0)">Subscription</th>
                    <th onclick="sortTable(1)">Key Vault Name</th>
                    <th onclick="sortTable(2)">Location</th>
                    <th onclick="sortTable(3)">Resource Group</th>
                    <th onclick="sortTable(4)">Compliance Status</th>
                    <th onclick="sortTable(5)">MS Score</th>
                    <th onclick="sortTable(6)">Company Score</th>
                    <th onclick="sortTable(7)">Diagnostics</th>
                    <th onclick="sortTable(8)">Log Categories</th>
                    <th onclick="sortTable(9)">Log Analytics</th>
                    <th onclick="sortTable(10)">Event Hub</th>
                    <th onclick="sortTable(11)">Storage Account</th>
                    <th onclick="sortTable(12)">Access Policies</th>
                    <th onclick="sortTable(13)">RBAC Assignments</th>
                    <th onclick="sortTable(14)">Service Principals</th>
                    <th onclick="sortTable(15)">Managed Identities</th>
                    <th onclick="sortTable(16)">System Identity</th>
                    <th onclick="sortTable(17)">User Identities</th>
                    <th onclick="sortTable(18)">Soft Delete</th>
                    <th onclick="sortTable(19)">Purge Protection</th>
                    <th onclick="sortTable(20)">Public Access</th>
                    <th onclick="sortTable(21)">Private Endpoints</th>
                    <th onclick="sortTable(22)">Secrets</th>
                    <th onclick="sortTable(23)">Keys</th>
                    <th onclick="sortTable(24)">Certificates</th>
                    <th onclick="sortTable(25)">Environment</th>
                    <th onclick="sortTable(26)">Workload</th>
                    <th onclick="sortTable(27)">Action Items</th>
                </tr>
                <tr><th><input type='text' class='filter-input' onkeyup='filterTable(this, 0)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 1)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 2)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 3)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 4)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 5)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 6)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 7)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 8)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 9)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 10)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 11)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 12)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 13)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 14)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 15)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 16)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 17)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 18)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 19)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 20)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 21)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 22)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 23)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 24)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 25)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 26)' placeholder='Filter...'></th><th><input type='text' class='filter-input' onkeyup='filterTable(this, 27)' placeholder='Filter...'></th>                </tr>
            </thead>
            <tbody><tr><td title='d7f6f7a9-5a48-4d03-b9b8-c4848220203c'>skylightridge-prod</td><td><strong>prod-skr-cloud-key-vault</strong></td><td>West US 2</td><td>SKR-Cloud-Engineering-Production</td><td><span class='partially-compliant'>Partially Compliant</span></td><td><span style='color: #ffc107; font-weight: bold;'>85%</span></td><td><span style='color: #ffc107; font-weight: bold;' title='Company Framework Score'>85%</span></td><td>True</td><td title='AuditEvent,AzurePolicyEvaluationDetails,AuditEvent,AzurePolicyEvaluationDetails'>AuditEvent, AzurePolicyEvaluationDetails, AuditEvent, AzurePolicyEvaluationDetails</td><td title='Workspace: prod-skr-cloud-analytics-workspace'>True</td><td title='Namespace: InfoSecEventHubwestus2, Hub: '>True</td><td title='Storage: '>False</td><td title='prod-appgw-forcerts (0f664035-fe6d-4a7b-b2ae-4b9e12b6e27d): Secrets[Get,List], Certs[Get,List] | SKR Cloud GitHub (93d5f001-feae-4d0a-b3c7-8e8d8bf45bcc): Certs[Get,List,Import,Update] | prod-diskencryptset-identity (3973a332-681c-4ab1-aaa6-56d54c0ea7b8): Keys[Get,WrapKey,UnwrapKey] | prod-bt-cdn-profile (53649dc5-5777-4848-82c4-cde7161ff3f8): Secrets[Get,List], Certs[Get,List] | prod-containergroup-identity (aabc4068-65d4-4417-a179-caed31c6093c): Secrets[Get,List,Set] | prod-rawobject-skr-function-app (df377c54-19c8-44b4-9f1b-4e7f10f8e5c6): Secrets[Get,List] | prod-maxmind-skr-function-app (5a7fd468-24f9-4d15-9f01-11070773ff6a): Secrets[Get,List] | prod-management-skr-cloud-app-service (e4530d69-e61e-42d3-a5cd-242e11906285): Secrets[Get,List] | prod-dataaccess-skr-cloud-app-service (0aa6d2c9-bffb-4d46-b00f-1f4970ca276a): Secrets[Get,List] | prod-anon-skr-cloud-app-service (2af4bca7-9995-416e-8b48-efc325a9ead9): Secrets[Get,List] | prod-dbevents-containergroup-identity (338f45b5-7535-4ff4-9336-9226322d190c): Secrets[Get,List,Set] | Schmidlin, David (0fa4b8e9-c9a8-415f-b8d0-4529fab87277): Secrets[Get,List] | Bansal, Swati (5a4ec6af-dbbe-4ecc-847c-6820091d1353): Secrets[Get,List] | Chan-Pong, Michael (a943833a-b5c7-40f2-adf2-8d40c7a88199): Secrets[Get,List,Set,Delete,Recover,Backup,Restore]'>14</td><td title='aad_bbaang: Owner | aad_bbaang: User Access Administrator | aad_rmcarden: User Access Administrator | aad_rmcarden: Owner | aad_sbiton2: User Access Administrator | CSM Azure Admin Diego Sverdloff: User Access Administrator | CSM Azure Admin Shmuel Ber: User Access Administrator | cbroker_testsp: Owner | Admin Access to d7f6f7a9-5a48-4d03-b9b8-c4848220203c AZADCORP: Owner | Custom Access to d7f6f7a9-5a48-4d03-b9b8-c4848220203c AZADCORP: Contributor | Reader Access d7f6f7a9-5a48-4d03-b9b8-c4848220203c AZADCORP: Reader | SKR Cloud GitHub: SKR GitHub Automation | prod-vm-update-policy: Contributor | prod-dnszonetovnetlinkscript-uami: Private DNS Zone Contributor | Microsoft Defender for Cloud Servers Scanner Resource Provider: VM Scanner Operator | Cloud Infrastructure Entitlement Management: Reader | CloudPosture/securityOperators/DefenderCSPMSecurityOperator: Defender CSPM Storage Scanner Operator | CloudPosture/securityOperators/DefenderCSPMSecurityOperator: Kubernetes Agentless Operator | SqlVmAndArcSqlServersProtection: Virtual Machine Contributor | storageDataScanner: Storage Blob Data Reader | SqlVmAndArcSqlServersProtection: Managed Identity Operator | SqlVmAndArcSqlServersProtection: Log Analytics Contributor | storageDataScanner: Storage File Data Privileged Reader | Schmidlin, David: Storage Blob Data Reader | 4527a568133a4b77862b3a53: SQL Security Manager | Azure_Admin: Owner | Cloud Brokers: Owner | d307c6e034f54628a802b5d2: Contributor | SIRT_IaaS_Security_Audit: Contributor | InfoSecAutomation_grBxdcGCKejpB2kI71OHzCPbPPhrWCK/TfeKLQbsNig=: Contributor | IT Billing Read Only for Azure: Billing Reader | Wiz for Azure: wiz-Intel-Production-IC | Wiz for Azure: Azure Kubernetes Service Cluster User Role | Wiz for Azure: Azure Kubernetes Service RBAC Reader | Wiz for Azure: Reader | Cloud Brokers Reader: Reader | AAD Role - Security Reader: Security Reader | Microsoft Azure Log Integration Service (azlog) - 9709e9ec-2cb5-4580-8ea8-157e522740ff: Reader | Azure Security Manager: Security Admin | Azure Security Manager: Reader | cbroker_testsp: Owner | Eco cost specialist in azure: Cost Management Reader | InfoSecAutomation: Contributor | Azure SEER automatic enforcement: SEER enforcement | Azure DNS Engineering: Reader | Unknown Principal: Reader | Unknown Principal: Virtual Machine Contributor | Unknown Principal: Reader | Unknown Principal: Contributor | a67142ffad0947368a42a326: Contributor | InfoSecAutomation: Azure Kubernetes Service Cluster Admin Role | InfoSecAutomation: Azure Kubernetes Service RBAC Admin | c150aa3239ec43989d0454b8: Contributor | InfoSecAutomation: Azure Kubernetes Service RBAC Cluster Admin | WizKeyVaultAccess: Key Vault Contributor | WizKeyVaultFirewall: Key Vault Contributor | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Key Vault Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Key Vault Crypto Service Encryption User | 7c5f510665f54dbca88201e3: Security Admin | Unknown Principal: Security Admin | Unknown Principal: Security Admin | 0ad5d699722142b6bcabc1ce: Security Admin | Azure_Admin: Owner | IT Billing Read Only for Azure: Billing Reader | CBIC_Tenable_Reader: Reader | ECO_SPOT_IAP_16553: Cost Management Reader | Unknown Principal: Reader | CloudHealth_PR_IAP_34144: Reader | Unknown Principal: Reader | Men_and_Mice_PR_IAP_8445: Men and Mice Operator | Azure Security Read Only: Reader | Azure Security Admin: Owner | SDI Cloud Operations Azure: Owner | Densify-POC: Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: WizCustomRole1 | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Azure Kubernetes Service RBAC Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Azure Kubernetes Service Cluster User Role | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Storage Blob Data Reader | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: Cognitive Services OpenAI User | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: WizDataScanningRole | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9: WizServerlessScanningRole | Cyber Defense Perimeter Pentesting: Reader | CrowdStrike TEST CID - Cloud Security Integration: Reader | CrowdStrike TEST CID - Cloud Security Integration: Security Reader | CrowdStrike TEST CID - Cloud Security Integration: Key Vault Reader | CrowdStrike TEST CID - Cloud Security Integration: Azure Kubernetes Service RBAC Reader | WizKeyVaultAccess: Key Vault Contributor | WizKeyVaultFirewall: Key Vault Contributor | Unknown Principal: WizRemediationCustomRole | rubrik_scan: Reader and Data Access | rubrik_scan: Reader | wizazurerr-fa: WizRemediationCustomRole | Azure-Infosecurity-Keyvault-Auditor: Key Vault Reader | Azure-Infosecurity-Keyvault-Auditor: Monitoring Reader | Praetorian Chariot: Security Reader | Praetorian Chariot: Reader | CloudHelper_IAP13321: Subscription Rename | Unknown Principal: WizRemediationCustomRole | RockSteady Cloud Azure: RockSteadyRole | RockSteady Cloud Azure: Azure Kubernetes Service RBAC Reader | RockSteady Cloud Azure: Reader | wiz-jfjcexu4-func: wiz-jfJceXu4-function-role | Unknown Principal: Reader'>104</td><td title='cbroker_testsp (115bc50e-f248-4244-a146-ade2a6348f07) - Owner [RBAC] | SKR Cloud GitHub (93d5f001-feae-4d0a-b3c7-8e8d8bf45bcc) - SKR GitHub Automation [RBAC] | prod-vm-update-policy (497086a7-726d-44b2-b636-441320cf6872) - Contributor [RBAC] | prod-dnszonetovnetlinkscript-uami (46d41cab-e6d3-4026-8517-db1203c5a182) - Private DNS Zone Contributor [RBAC] | Microsoft Defender for Cloud Servers Scanner Resource Provider (f094a5f3-4396-4ed6-86c5-181c709d2c02) - VM Scanner Operator [RBAC] | Cloud Infrastructure Entitlement Management (a2334596-f24d-4d12-be6e-2fee7b045547) - Reader [RBAC] | CloudPosture/securityOperators/DefenderCSPMSecurityOperator (8fabcccd-d17a-45fd-b1ce-53438a1e0197) - Defender CSPM Storage Scanner Operator [RBAC] | CloudPosture/securityOperators/DefenderCSPMSecurityOperator (8fabcccd-d17a-45fd-b1ce-53438a1e0197) - Kubernetes Agentless Operator [RBAC] | SqlVmAndArcSqlServersProtection (de4e296d-1291-49fb-b2f3-867a0e991aba) - Virtual Machine Contributor [RBAC] | storageDataScanner (1fb18215-8407-4abe-886e-50a395e510c6) - Storage Blob Data Reader [RBAC] | SqlVmAndArcSqlServersProtection (de4e296d-1291-49fb-b2f3-867a0e991aba) - Managed Identity Operator [RBAC] | SqlVmAndArcSqlServersProtection (de4e296d-1291-49fb-b2f3-867a0e991aba) - Log Analytics Contributor [RBAC] | storageDataScanner (1fb18215-8407-4abe-886e-50a395e510c6) - Storage File Data Privileged Reader [RBAC] | 4527a568133a4b77862b3a53 (b13bdba6-a9a3-41fc-9b77-8dd1c8cae165) - SQL Security Manager [RBAC] | d307c6e034f54628a802b5d2 (5d340684-06f4-45b6-ab1b-44d350dbc0ff) - Contributor [RBAC] | InfoSecAutomation_grBxdcGCKejpB2kI71OHzCPbPPhrWCK/TfeKLQbsNig= (7c51ef53-655e-40aa-b15a-3a21cc304b53) - Contributor [RBAC] | Wiz for Azure (65e77292-7652-4fc3-97b3-eaa0bad308ff) - wiz-Intel-Production-IC [RBAC] | Wiz for Azure (65e77292-7652-4fc3-97b3-eaa0bad308ff) - Azure Kubernetes Service Cluster User Role [RBAC] | Wiz for Azure (65e77292-7652-4fc3-97b3-eaa0bad308ff) - Azure Kubernetes Service RBAC Reader [RBAC] | Wiz for Azure (65e77292-7652-4fc3-97b3-eaa0bad308ff) - Reader [RBAC] | Microsoft Azure Log Integration Service (azlog) - 9709e9ec-2cb5-4580-8ea8-157e522740ff (33476dc5-2e32-404a-8718-b5b2d5da0a01) - Reader [RBAC] | cbroker_testsp (115bc50e-f248-4244-a146-ade2a6348f07) - Owner [RBAC] | InfoSecAutomation (ff1fc891-cbf9-4b4e-9840-176fcf617fdd) - Contributor [RBAC] | Azure SEER automatic enforcement (cad9f67b-2be1-4059-949b-12fad0f0a151) - SEER enforcement [RBAC] | a67142ffad0947368a42a326 (5eaf447d-aea5-4896-95ae-6ec78277dd9a) - Contributor [RBAC] | InfoSecAutomation (ff1fc891-cbf9-4b4e-9840-176fcf617fdd) - Azure Kubernetes Service Cluster Admin Role [RBAC] | InfoSecAutomation (ff1fc891-cbf9-4b4e-9840-176fcf617fdd) - Azure Kubernetes Service RBAC Admin [RBAC] | c150aa3239ec43989d0454b8 (7c434dde-35a3-4ce5-b977-cb6d43d73d25) - Contributor [RBAC] | InfoSecAutomation (ff1fc891-cbf9-4b4e-9840-176fcf617fdd) - Azure Kubernetes Service RBAC Cluster Admin [RBAC] | WizKeyVaultAccess (deabf9fa-0769-4f54-a35d-071fcc5953fc) - Key Vault Contributor [RBAC] | WizKeyVaultFirewall (59320dc4-548d-4266-898a-7a87cb5d1611) - Key Vault Contributor [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Key Vault Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Key Vault Crypto Service Encryption User [RBAC] | 7c5f510665f54dbca88201e3 (124983c4-d541-449a-a9a6-d956ed2d9728) - Security Admin [RBAC] | 0ad5d699722142b6bcabc1ce (fa984e6f-cc58-4aab-9448-9e88603b4110) - Security Admin [RBAC] | CBIC_Tenable_Reader (29b8b746-dc08-4c19-a0a1-3f653c40ecd3) - Reader [RBAC] | ECO_SPOT_IAP_16553 (bd123435-87ec-4fd1-b9d7-14dc67113604) - Cost Management Reader [RBAC] | CloudHealth_PR_IAP_34144 (5b8fb4af-0ad7-47e9-a6d6-27d3dba5aa2d) - Reader [RBAC] | Men_and_Mice_PR_IAP_8445 (1675703c-b517-4f03-a796-9668a390dcf7) - Men and Mice Operator [RBAC] | Densify-POC (e6a9b18f-b1bd-44c0-be64-ed3dc0aeb1df) - Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - WizCustomRole1 [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Azure Kubernetes Service RBAC Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Azure Kubernetes Service Cluster User Role [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Storage Blob Data Reader [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - Cognitive Services OpenAI User [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - WizDataScanningRole [RBAC] | wiz-536a61ca-78c5-439a-9537-13b3ebbaa0e9 (5f4c4416-0080-4c13-bd99-5ee412ca49da) - WizServerlessScanningRole [RBAC] | Cyber Defense Perimeter Pentesting (1bf7fd2d-3100-438a-8341-e679afd5f9ae) - Reader [RBAC] | CrowdStrike TEST CID - Cloud Security Integration (508e7ffa-3c4b-4213-ada2-939d4ca91083) - Reader [RBAC] | CrowdStrike TEST CID - Cloud Security Integration (508e7ffa-3c4b-4213-ada2-939d4ca91083) - Security Reader [RBAC] | CrowdStrike TEST CID - Cloud Security Integration (508e7ffa-3c4b-4213-ada2-939d4ca91083) - Key Vault Reader [RBAC] | CrowdStrike TEST CID - Cloud Security Integration (508e7ffa-3c4b-4213-ada2-939d4ca91083) - Azure Kubernetes Service RBAC Reader [RBAC] | WizKeyVaultAccess (ccaf9819-a25d-4040-a403-c3f71b92bab4) - Key Vault Contributor [RBAC] | WizKeyVaultFirewall (46e69860-91e0-44d3-a2b5-1fe8777cfba1) - Key Vault Contributor [RBAC] | rubrik_scan (677a6233-f344-4f2c-960a-3df08bb36ef3) - Reader and Data Access [RBAC] | rubrik_scan (677a6233-f344-4f2c-960a-3df08bb36ef3) - Reader [RBAC] | wizazurerr-fa (c5a05c6b-3618-4b09-9664-03bef4ea7b67) - WizRemediationCustomRole [RBAC] | Praetorian Chariot (8115ad4c-1930-4f9f-8bc3-1befd822bf04) - Security Reader [RBAC] | Praetorian Chariot (8115ad4c-1930-4f9f-8bc3-1befd822bf04) - Reader [RBAC] | CloudHelper_IAP13321 (4875e471-1ab4-4656-b162-20b9c0bcc6de) - Subscription Rename [RBAC] | RockSteady Cloud Azure (005288a3-f653-4e8c-bcdf-ec797ae662f1) - RockSteadyRole [RBAC] | RockSteady Cloud Azure (005288a3-f653-4e8c-bcdf-ec797ae662f1) - Azure Kubernetes Service RBAC Reader [RBAC] | RockSteady Cloud Azure (005288a3-f653-4e8c-bcdf-ec797ae662f1) - Reader [RBAC] | wiz-jfjcexu4-func (cb7142af-92fe-43c4-a1d7-b7f9baa7d2b3) - wiz-jfJceXu4-function-role [RBAC]'>65</td><td title=''>0</td><td title='Principal ID: '>Error processing identity</td><td title='User Assigned IDs: Error processing user-assigned identities'>0</td><td>True</td><td>True</td><td title='Network ACLs: False'>Enabled</td><td>0</td><td style='text-align: center;'>0</td><td style='text-align: center;'>0</td><td style='text-align: center;'>0</td><td>Unknown</td><td title=''>Not Determined</td><td><span class='action-link' onclick='toggleActionItems("actions_1")'>View Actions</span><div id='actions_1' class='action-details'><h5>Priority Actions for prod-skr-cloud-key-vault:</h5><ul><li>Consider Private Endpoints for enhanced network security (<a href='https://learn.microsoft.com/azure/key-vault/general/private-link-service' target='_blank'>Microsoft Docs: Private Link Service</a> | <a href='https://www.cisecurity.org/benchmark/azure' target='_blank'>CIS Azure Benchmark</a>)</li><li>Reduce üî¥ HIGH: aad_bbaang (User) has 'Owner' - consider 'Key Vault Secrets Officer or Key Vault Keys Officer (based on needs)' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: aad_bbaang (User) has 'User Access Administrator' - consider 'Key Vault Reader for read-only operations' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: aad_rmcarden (User) has 'User Access Administrator' - consider 'Key Vault Reader for read-only operations' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: aad_rmcarden (User) has 'Owner' - consider 'Key Vault Secrets Officer or Key Vault Keys Officer (based on needs)' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: aad_sbiton2 (User) has 'User Access Administrator' - consider 'Key Vault Reader for read-only operations' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: CSM Azure Admin Diego Sverdloff (User) has 'User Access Administrator' - consider 'Key Vault Reader for read-only operations' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: CSM Azure Admin Shmuel Ber (User) has 'User Access Administrator' - consider 'Key Vault Reader for read-only operations' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: cbroker_testsp (ServicePrincipal) has 'Owner' - consider 'Key Vault Secrets Officer or Key Vault Keys Officer (based on needs)' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: Admin Access to d7f6f7a9-5a48-4d03-b9b8-c4848220203c AZADCORP (Group) has 'Owner' - consider 'Key Vault Secrets Officer or Key Vault Keys Officer (based on needs)' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: Custom Access to d7f6f7a9-5a48-4d03-b9b8-c4848220203c AZADCORP (Group) has 'Contributor' - consider 'Key Vault Secrets Officer or Key Vault Keys Officer (based on needs)' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: prod-vm-update-policy (ServicePrincipal) has 'Contributor' - consider 'Key Vault Secrets Officer or Key Vault Keys Officer (based on needs)' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: Azure_Admin (User) has 'Owner' - consider 'Key Vault Secrets Officer or Key Vault Keys Officer (based on needs)' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: Cloud Brokers (Group) has 'Owner' - consider 'Key Vault Secrets Officer or Key Vault Keys Officer (based on needs)' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: d307c6e034f54628a802b5d2 (ServicePrincipal) has 'Contributor' - consider 'Key Vault Secrets Officer or Key Vault Keys Officer (based on needs)' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: SIRT_IaaS_Security_Audit (Group) has 'Contributor' - consider 'Key Vault Secrets Officer or Key Vault Keys Officer (based on needs)' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: InfoSecAutomation_grBxdcGCKejpB2kI71OHzCPbPPhrWCK/TfeKLQbsNig= (ServicePrincipal) has 'Contributor' - consider 'Key Vault Secrets Officer or Key Vault Keys Officer (based on needs)' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: cbroker_testsp (ServicePrincipal) has 'Owner' - consider 'Key Vault Secrets Officer or Key Vault Keys Officer (based on needs)' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: InfoSecAutomation (ServicePrincipal) has 'Contributor' - consider 'Key Vault Secrets Officer or Key Vault Keys Officer (based on needs)' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: Unknown Principal (Unknown) has 'Contributor' - consider 'Key Vault Secrets Officer or Key Vault Keys Officer (based on needs)' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: a67142ffad0947368a42a326 (ServicePrincipal) has 'Contributor' - consider 'Key Vault Secrets Officer or Key Vault Keys Officer (based on needs)' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: c150aa3239ec43989d0454b8 (ServicePrincipal) has 'Contributor' - consider 'Key Vault Secrets Officer or Key Vault Keys Officer (based on needs)' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: WizKeyVaultAccess (ServicePrincipal) has 'Key Vault Contributor' - consider 'Key Vault Reader for monitoring, or specific Officer roles for management' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: WizKeyVaultFirewall (ServicePrincipal) has 'Key Vault Contributor' - consider 'Key Vault Reader for monitoring, or specific Officer roles for management' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: Azure_Admin (User) has 'Owner' - consider 'Key Vault Secrets Officer or Key Vault Keys Officer (based on needs)' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: Azure Security Admin (Group) has 'Owner' - consider 'Key Vault Secrets Officer or Key Vault Keys Officer (based on needs)' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: SDI Cloud Operations Azure (Group) has 'Owner' - consider 'Key Vault Secrets Officer or Key Vault Keys Officer (based on needs)' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: WizKeyVaultAccess (ServicePrincipal) has 'Key Vault Contributor' - consider 'Key Vault Reader for monitoring, or specific Officer roles for management' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce üî¥ HIGH: WizKeyVaultFirewall (ServicePrincipal) has 'Key Vault Contributor' - consider 'Key Vault Reader for monitoring, or specific Officer roles for management' to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce ‚ö†Ô∏è AUDIT: 10 user accounts have direct access - consider using groups or managed identities to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Reduce ‚ÑπÔ∏è RECOMMENDATION: Consider migrating service principals to managed identities where possible to specific Key Vault role (Key Vault Secrets User, etc.) (<a href='https://learn.microsoft.com/azure/key-vault/general/rbac-guide#azure-built-in-roles-for-key-vault-data-plane-operations' target='_blank'>Built-in Roles Reference</a>)</li><li>Implement secret rotation policies and expiration monitoring (<a href='https://learn.microsoft.com/azure/key-vault/secrets/tutorial-rotation-dual' target='_blank'>Microsoft Docs: Secret Rotation</a> | <a href='https://owasp.org/www-project-application-security-verification-standard/' target='_blank'>OWASP ASVS</a>)</li><li>Use Key Vault references in applications instead of storing secrets in configuration (<a href='https://learn.microsoft.com/azure/app-service/app-service-key-vault-references' target='_blank'>App Service Key Vault References</a>)</li><li>Enable Key Vault notifications for secret access and changes (<a href='https://learn.microsoft.com/azure/key-vault/general/event-grid-overview' target='_blank'>Key Vault Event Grid Integration</a>)</li></ul><p><strong>Impact:</strong> Implementing these recommendations will improve security posture and compliance score.</p></div></td></tr>
            </tbody>
        </table>
    </div>
    
    <footer style="margin-top: 40px; padding: 20px; background: #f8f9fa; border-radius: 8px; text-align: center; color: #6c757d; border-top: 3px solid #667eea;">
        <p><strong>Azure Key Vault Enhanced Security & Compliance Audit Report</strong></p>
        <p>Generated by Script v2.2 with Comprehensive Inline HTML Generator (Restored) on 2025-09-15 12:38:06 UTC by curtus.regnier@intel.com</p>
        <p><strong>Execution ID:</strong> 20250915-123729</p>
        <p>For questions or support, contact your Azure security team.</p>
        <p style='font-size: 0.9em; margin-top: 15px;'><strong>Note:</strong> This report was generated using the restored comprehensive inline HTML generator that was originally producing correct diagnostic columns and features.</p>
    </footer>
</body>
</html>
